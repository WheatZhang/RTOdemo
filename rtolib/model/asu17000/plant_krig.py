from rtolib.core.pyomo_model import PyomoModel
from pyomo.environ import *
import os
import numpy as np
import pickle

class PlantKriging(PyomoModel):
    def __init__(self):
        self.output_variables = {
            "cost":(lambda m: m.OBJ),
            "OxygenPrdtPurityCon":(lambda m: m.PurityCon1),
            "OxygenPrdtImpurityCon":(lambda m: m.PurityCon2),
            "NitrogenPrdtPurityCon":(lambda m: m.PurityCon3),
            "NitrogenPrdtImpurityCon":(lambda m: m.PurityCon4),
            "ArgonPrdtImpurityCon":(lambda m: m.PurityCon5),
            "CrudeArgonImpurityCon":(lambda m: m.PurityCon6),
            "LOX_Con":(lambda m: m.ProductCon1),
            "GAN_Con":(lambda m: m.ProductCon2),
            "GAR_Con":(lambda m: m.ProductCon3),
            "MainCoolerTempDiffCon":(lambda m: m.TempDiffCon1),
            "HeatLPCTempDiffCon":(lambda m: m.TempDiffCon2),
            "HPA_GOX_LB_Con":(lambda m: m.TurbineCon1),
            "HPA_GOX_UB_Con":(lambda m: m.TurbineCon2),
            "Feed_LB_Con":(lambda m: m.TurbineCon3),
            "Feed_UB_Con":(lambda m: m.TurbineCon4),
            "HPA_LB_Con":(lambda m: m.TurbineCon7),
            "HPA_UB_Con":(lambda m: m.TurbineCon8),
            "TA_LB_Con":(lambda m: m.TurbineCon9),
            "TA_UB_Con":(lambda m: m.TurbineCon10),
            "OverallHeatCon":(lambda m: m.OverallHeatBlnc),
        }
        self.noised_outputs = {
        }
        self.input_variables = {
            'FeedMFlow':(lambda m: m.FeedMFlow),
            'TAFeedFrac':(lambda m: m.FeedSplitterOut1Ratio), #TA Frac
            'MAFeedFrac':(lambda m: m.FeedSplitterOut2Ratio), #MA_Frac
            '40_LIN':(lambda m: m.HPCCondPrdtMFlow), #40-LIN
            '52_WN':(lambda m: m.LPCExt46MFlow), #52-WN
            '47_ARC':(lambda m: m.LPCExt15MFlow), #47-ARC
            'ASC_RefluxRatio':(lambda m: m.ASCCondRefRatio), #ASC_Reflux
            'LOX_Frac':(lambda m: m.OxSplitterOutARatio), #LOX_Frac
        }
        self.parameters = {
        }
        self.default_value={}
        self.parameter_scaling_factors={}
        self.output_noise = {
        }
        self.initial_value_file = os.path.dirname(__file__) + r"\GOX17000SimInitValue_model.txt"

    def build_body(self, test_model):
        test_model.FeedMFlow=Var(initialize=4100, bounds=(3800,4200))
        test_model.FeedSplitterOut1Ratio=Var(initialize=0.19, bounds=(0.15,0.25))
        test_model.FeedSplitterOut2Ratio=Var(initialize=0.5, bounds=(0.45,0.6))
        test_model.HPCCondPrdtMFlow=Var(initialize=1450, bounds=(1200,1500))
        test_model.LPCExt46MFlow=Var(initialize=1800, bounds=(1600,1900))
        test_model.LPCExt15MFlow=Var(initialize=600, bounds=(600,700))
        test_model.ASCCondRefRatio=Var(initialize=28, bounds=(25,30))
        test_model.OxSplitterOutARatio=Var(initialize=0.09, bounds=(0.07,0.1))
        test_model.FeedMFlow.fixed = True
        test_model.FeedSplitterOut1Ratio.fixed = True
        test_model.FeedSplitterOut2Ratio.fixed = True
        test_model.HPCCondPrdtMFlow.fixed = True
        test_model.LPCExt46MFlow.fixed = True
        test_model.LPCExt15MFlow.fixed = True
        test_model.ASCCondRefRatio.fixed = True
        test_model.OxSplitterOutARatio.fixed = True

        test_model.obj = Var(initialize=0)
        test_model.e = Var(initialize=0)

        def eq1(m):
            return m.e == 0.0*( \
            m.FeedMFlow+\
            m.FeedSplitterOut1Ratio+\
            m.FeedSplitterOut2Ratio+\
            m.HPCCondPrdtMFlow+\
            m.LPCExt46MFlow+\
            m.LPCExt15MFlow+\
            m.ASCCondRefRatio+\
            m.OxSplitterOutARatio
                    )
        test_model.eq1 = Constraint(rule=eq1)

        def _obj(m):
            return 0  #10*(m.Fb**2+m.Tr**2)
        test_model._obj = Expression(rule=_obj)

    def build_rto(self, test_model, cv_func):
        def OxygenPrdtPurityCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                     vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 1.1232792821189288012817542e+00 + \
                x7 * -2.6401669832104568413910783e-03 + \
                x7_2 * 5.3416099383626969299143639e-01 + \
                x7_3 * -3.7764222320063867144313008e-01 + \
                x6 * -6.1212262367381475858252315e-01 + \
                x6 * x7 * 4.0029302215948842080806003e-01 + \
                x6 * x7_2 * -3.0219813947145102162039620e-01 + \
                x6_2 * 6.1168570967891655598691614e-01 + \
                x6_2 * x7 * -1.6567765236659193206492091e-01 + \
                x6_3 * -2.1855810537085390565792409e-01 + \
                x5 * -3.6990124795770917831561064e-01 + \
                x5 * x7 * -3.5810216835823893699597420e-01 + \
                x5 * x7_2 * -2.5214941907923954511616671e-01 + \
                x5 * x6 * 4.0896160884173582417133730e-01 + \
                x5 * x6 * x7 * 2.2485588697737807217791328e-01 + \
                x5 * x6_2 * 7.0378355997859173842634561e-02 + \
                x5_2 * 8.5696011073684474901313024e-01 + \
                x5_2 * x7 * 1.5070804691232808636414120e-01 + \
                x5_2 * x6 * -5.2193431071996987391514722e-01 + \
                x5_3 * -3.3028485553621395043322195e-01 + \
                x4 * -1.9334822601813292375361186e-01 + \
                x4 * x7 * -1.4078474137984831049408285e-01 + \
                x4 * x7_2 * -2.5285197455104935215786099e-04 + \
                x4 * x6 * 4.4103599972958773545173017e-01 + \
                x4 * x6 * x7 * 9.1751134425283598083922243e-02 + \
                x4 * x6_2 * -2.6942622801117177555596527e-01 + \
                x4 * x5 * -4.1332953447817133429964542e-01 + \
                x4 * x5 * x7 * 2.4352350475709239052690691e-01 + \
                x4 * x5 * x6 * 1.2166813415471322556982159e-01 + \
                x4 * x5_2 * -3.9478535153284477488000448e-03 + \
                x4_2 * -3.6851246764944212142012248e-01 + \
                x4_2 * x7 * 7.8887437147044409124774234e-02 + \
                x4_2 * x6 * -2.4954131091844883316710479e-01 + \
                x4_2 * x5 * 3.8085867761371544615300877e-02 + \
                x4_3 * 4.7044537048426110503740460e-01 + \
                x3 * -2.0057311447539341586754347e-01 + \
                x3 * x7 * -6.6814482799436553106531278e-02 + \
                x3 * x7_2 * -7.7836017719976030582174076e-02 + \
                x3 * x6 * 4.6778676167064975333076404e-01 + \
                x3 * x6 * x7 * -1.3932688699857545544524839e-01 + \
                x3 * x6_2 * 4.6045746011737831437926616e-02 + \
                x3 * x5 * -2.6024528863217194496471052e-01 + \
                x3 * x5 * x7 * 2.3502159580003006977833024e-01 + \
                x3 * x5 * x6 * -1.7429187841001511638516774e-01 + \
                x3 * x5_2 * 2.7380517209279536805510702e-01 + \
                x3 * x4 * 4.9397590965862975265210366e-01 + \
                x3 * x4 * x7 * -2.2786231357114750117887070e-01 + \
                x3 * x4 * x6 * -2.5523869804122673032864554e-01 + \
                x3 * x4 * x5 * 1.9279639957310112929889101e-01 + \
                x3 * x4_2 * -1.0893987734350019103146678e-02 + \
                x3_2 * 4.4785412313179379095728905e-01 + \
                x3_2 * x7 * 9.3152181074870873955795503e-02 + \
                x3_2 * x6 * -1.7792287436289680457868201e-01 + \
                x3_2 * x5 * -9.4369620098072648506359883e-02 + \
                x3_2 * x4 * -2.0463792710546474529209604e-01 + \
                x3_3 * 1.3641697931863461246138058e-01 + \
                x2 * 1.9959482055191379856751155e-01 + \
                x2 * x7 * -2.2098281196713384644247924e-01 + \
                x2 * x7_2 * 1.7239910753736975568273238e-01 + \
                x2 * x6 * -1.4661330708733544270216953e-01 + \
                x2 * x6 * x7 * -4.4761520149621418507290826e-02 + \
                x2 * x6_2 * 4.4395893075495962420973228e-02 + \
                x2 * x5 * 5.4433874029710138664484020e-01 + \
                x2 * x5 * x7 * 9.1517698421831522592739816e-02 + \
                x2 * x5 * x6 * -4.6857618993892305447879210e-02 + \
                x2 * x5_2 * -2.8571088435605551669738134e-01 + \
                x2 * x4 * 3.9405401247120319663252985e-01 + \
                x2 * x4 * x7 * 6.9058273189555360871416667e-02 + \
                x2 * x4 * x6 * 7.1009032286405329714717993e-02 + \
                x2 * x4 * x5 * 1.7127774389519881403920465e-01 + \
                x2 * x4_2 * -2.1015410339068471556878137e-01 + \
                x2 * x3 * -8.8402709608664387097576309e-01 + \
                x2 * x3 * x7 * 2.4376423349863521328195759e-02 + \
                x2 * x3 * x6 * -1.2154679822956154788826666e-01 + \
                x2 * x3 * x5 * 2.1184141822063409787979538e-01 + \
                x2 * x3 * x4 * -2.4985215557673742803324046e-01 + \
                x2 * x3_2 * -2.5941461660403675182351435e-01 + \
                x2_2 * -2.8177449701912786750312989e+00 + \
                x2_2 * x7 * -2.0574657060490837701127731e-02 + \
                x2_2 * x6 * 1.4036526828050213677734348e-01 + \
                x2_2 * x5 * -4.0440434170286077009137671e-01 + \
                x2_2 * x4 * -8.3528503355838903954300179e-02 + \
                x2_2 * x3 * 6.4651211096778005149587898e-01 + \
                x2_3 * 1.6526831675732709392434572e+00 + \
                x1 * 6.0498364010652150302149721e-01 + \
                x1 * x7 * 2.5059093318811065387308190e-03 + \
                x1 * x7_2 * 3.4021539506951831155490140e-02 + \
                x1 * x6 * -2.3086430261021717580405266e-01 + \
                x1 * x6 * x7 * 1.2190220032151199980319234e-02 + \
                x1 * x6_2 * 1.7893603675643666994776737e-02 + \
                x1 * x5 * 1.9092630044188219073930668e-01 + \
                x1 * x5 * x7 * 4.9238556912571229684516538e-02 + \
                x1 * x5 * x6 * 1.2136384609906816778313043e-01 + \
                x1 * x5_2 * 1.8609936990613257234983280e-01 + \
                x1 * x4 * -5.2911385979758085440494142e-02 + \
                x1 * x4 * x7 * -9.9086972898584924074327773e-02 + \
                x1 * x4 * x6 * 1.4447119921233703143670368e-01 + \
                x1 * x4 * x5 * -4.3604392252927060003031556e-02 + \
                x1 * x4_2 * -2.5354835816912280055390738e-02 + \
                x1 * x3 * 2.0127364567021424623938231e-01 + \
                x1 * x3 * x7 * -4.7693297191738259765969588e-02 + \
                x1 * x3 * x6 * -8.2041244758546877369198569e-02 + \
                x1 * x3 * x5 * -3.6061702072460416479415812e-01 + \
                x1 * x3 * x4 * 7.6530556869628840743757792e-02 + \
                x1 * x3_2 * -3.3937992153548229845583251e-01 + \
                x1 * x2 * -4.2354915720948254076461126e+00 + \
                x1 * x2 * x7 * 1.2282841559506901818465963e-02 + \
                x1 * x2 * x6 * -2.4915465384495460998692806e-02 + \
                x1 * x2 * x5 * -1.8908230045591448154063130e-01 + \
                x1 * x2 * x4 * -1.5182915908719574193952440e-01 + \
                x1 * x2 * x3 * 7.9134519507802436599774865e-01 + \
                x1 * x2_2 * 3.1758001721584103727025195e+00 + \
                x1_2 * -1.3393445250316815542390714e+00 + \
                x1_2 * x7 * 2.1177924383624591175845353e-02 + \
                x1_2 * x6 * 1.3749183495048636349800120e-01 + \
                x1_2 * x5 * -2.1668558565604698062934119e-01 + \
                x1_2 * x4 * 1.0344254966462690381590050e-01 + \
                x1_2 * x3 * -1.4372791453298283670392266e-01 + \
                x1_2 * x2 * 1.9777865635561531210129260e+00 + \
                x1_3 * 3.1788655816997490877184873e-01 + \
                x0 * -4.7174939976462493262943099e-01 + \
                x0 * x7 * -3.4933933283896240196142458e-01 + \
                x0 * x7_2 * 4.0949264619019831723534253e-01 + \
                x0 * x6 * 3.0547889016329760059065279e-01 + \
                x0 * x6 * x7 * 1.7501512305915057493566067e-02 + \
                x0 * x6_2 * -2.3682902059676910755392498e-01 + \
                x0 * x5 * 2.9936599927785800812074513e-01 + \
                x0 * x5 * x7 * 9.6886908671339949661316382e-02 + \
                x0 * x5 * x6 * -1.9787732212034370160580465e-01 + \
                x0 * x5_2 * -4.5126930964131706236486252e-01 + \
                x0 * x4 * 7.4087389117426361018203806e-01 + \
                x0 * x4 * x7 * 2.0659396435421154003542199e-02 + \
                x0 * x4 * x6 * -6.3243187621905283535284070e-02 + \
                x0 * x4 * x5 * -1.3321203945784582112210614e-01 + \
                x0 * x4_2 * -2.4136436641439315553547829e-01 + \
                x0 * x3 * -3.7969627979394515726596637e-01 + \
                x0 * x3 * x7 * 8.2746302765817736357689682e-02 + \
                x0 * x3 * x6 * 1.4397755466834166737655210e-02 + \
                x0 * x3 * x5 * 4.1356208117820925096452811e-02 + \
                x0 * x3 * x4 * -4.3049103910181740761942137e-02 + \
                x0 * x3_2 * -5.0770930834915795060169330e-03 + \
                x0 * x2 * 8.1862020367248689023398356e-01 + \
                x0 * x2 * x7 * -5.2175443034659887975301729e-02 + \
                x0 * x2 * x6 * 9.0756102172688424278845787e-02 + \
                x0 * x2 * x5 * -1.2275853451335211330430752e-01 + \
                x0 * x2 * x4 * -8.7863457593848420801307952e-02 + \
                x0 * x2 * x3 * 3.1705941203402399075628182e-01 + \
                x0 * x2_2 * -4.8419528743779849389028413e-01 + \
                x0 * x1 * 3.0222577539947947933285377e-01 + \
                x0 * x1 * x7 * -1.0398658005239813650888436e-01 + \
                x0 * x1 * x6 * 3.8827287418610162417209608e-02 + \
                x0 * x1 * x5 * 7.2808692311372283367809644e-02 + \
                x0 * x1 * x4 * -2.3576457432383374213102911e-02 + \
                x0 * x1 * x3 * -3.6987841197531651227237148e-02 + \
                x0 * x1 * x2 * -7.6739912188840464501993210e-02 + \
                x0 * x1_2 * -2.3476309984985849199645713e-01 + \
                x0_2 * 2.6921822384723193000155561e-01 + \
                x0_2 * x7 * -6.3617138758381153174070732e-03 + \
                x0_2 * x6 * -4.8036349778171741342625012e-02 + \
                x0_2 * x5 * 2.1109601724859991533911341e-01 + \
                x0_2 * x4 * -2.2390845209667578630252649e-01 + \
                x0_2 * x3 * 6.1298132904418767274989932e-03 + \
                x0_2 * x2 * -3.3433798262944758317161131e-01 + \
                x0_2 * x1 * -3.2664611912767968493476189e-02 + \
                x0_3 * 6.8102308832419314321704462e-03
            output = output * 3.7081548632966421230605647e-02 + -9.9971561329625924230413148e-04
            OxygenPrdtPurityCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\OxygenPrdtPurityCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            OxygenPrdtPurityCon += output
            return OxygenPrdtPurityCon

        def PurityCon1(m):
            return OxygenPrdtPurityCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                            m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                            m.OxSplitterOutARatio)

        test_model.PurityCon1 = Expression(rule=PurityCon1)

        def OxygenPrdtImpurityCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                       vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 1.1163767684229437548992792e+00 + \
                x7 * 8.0734620859179789809090266e-02 + \
                x7_2 * 3.5443320911064912781540670e-01 + \
                x7_3 * -3.0300822838640334433435441e-01 + \
                x6 * -8.7553335638489060421818522e-01 + \
                x6 * x7 * 3.2771988920623457142156099e-01 + \
                x6 * x7_2 * -2.5016539678952109948539828e-01 + \
                x6_2 * 6.9992197795188160203139205e-01 + \
                x6_2 * x7 * -1.7757927474358842223622901e-01 + \
                x6_3 * -2.2832884044032952797209646e-01 + \
                x5 * -2.5639920078337757880504455e-01 + \
                x5 * x7 * -3.2728518477009654885634404e-01 + \
                x5 * x7_2 * -2.2439550644615763319578150e-01 + \
                x5 * x6 * 3.0853589155053118275873203e-01 + \
                x5 * x6 * x7 * 2.8424917187354276082444926e-01 + \
                x5 * x6_2 * 1.7342212543452806272625821e-02 + \
                x5_2 * 7.0893128657123971603226664e-01 + \
                x5_2 * x7 * 7.0859335767302383812804578e-02 + \
                x5_2 * x6 * -4.7599212778135008283797447e-01 + \
                x5_3 * -2.4357118696369400856482912e-01 + \
                x4 * -1.3811277876979211054475627e-01 + \
                x4 * x7 * -1.5038026506183144181960643e-01 + \
                x4 * x7_2 * 4.2690708056211307264149468e-02 + \
                x4 * x6 * 4.4783330288185174694604029e-01 + \
                x4 * x6 * x7 * 7.5029637671960858202879763e-02 + \
                x4 * x6_2 * -1.9940298542085779787136346e-01 + \
                x4 * x5 * -5.8363839794064475974266770e-01 + \
                x4 * x5 * x7 * 2.2460045051538474192298622e-01 + \
                x4 * x5 * x6 * 1.1194455813286574574760834e-01 + \
                x4 * x5_2 * 5.6812601608470569836129016e-02 + \
                x4_2 * -4.6349267085572876112564700e-01 + \
                x4_2 * x7 * 2.8510646168160722058182444e-02 + \
                x4_2 * x6 * -2.5431101054770521852077536e-01 + \
                x4_2 * x5 * 1.3738274419736956621918011e-01 + \
                x4_3 * 5.0806250513185502448720854e-01 + \
                x3 * 1.4774282673001448706884275e-01 + \
                x3 * x7 * -1.2841132908184678396157352e-02 + \
                x3 * x7_2 * 1.1203758627687743221201799e-02 + \
                x3 * x6 * 3.1238805521967494271962096e-01 + \
                x3 * x6 * x7 * -8.3851326591624364414911952e-02 + \
                x3 * x6_2 * 7.3211122520657312406910933e-02 + \
                x3 * x5 * -1.8137155015802414181891322e-01 + \
                x3 * x5 * x7 * 1.8619199552394538610400332e-01 + \
                x3 * x5 * x6 * -1.4456593860768729431498514e-01 + \
                x3 * x5_2 * 2.8571611265619550890093592e-01 + \
                x3 * x4 * 3.7747675997080987198017965e-01 + \
                x3 * x4 * x7 * -1.9373029381496553735786392e-01 + \
                x3 * x4 * x6 * -2.6467907000567308939409372e-01 + \
                x3 * x4 * x5 * 1.5792629253193130045573866e-01 + \
                x3 * x4_2 * 6.5062550539810484750979924e-02 + \
                x3_2 * 3.3326115134023026609355611e-01 + \
                x3_2 * x7 * -1.1563296472321626939816497e-02 + \
                x3_2 * x6 * -1.7308769906047594133724488e-01 + \
                x3_2 * x5 * -1.0897463948435437419703931e-01 + \
                x3_2 * x4 * -1.5056600025152488964153008e-01 + \
                x3_3 * 1.4642961814986272389704780e-02 + \
                x2 * -4.9783673133654432474415330e-01 + \
                x2 * x7 * -2.2394093698525713298508322e-01 + \
                x2 * x7_2 * 2.0840346179936414250377652e-01 + \
                x2 * x6 * 3.9800779610556152876554847e-01 + \
                x2 * x6 * x7 * -5.3927684153265237343433114e-02 + \
                x2 * x6_2 * -1.2183533627736997662083240e-02 + \
                x2 * x5 * 5.4339805804657992371886621e-01 + \
                x2 * x5 * x7 * 1.0647066710574748515938381e-01 + \
                x2 * x5 * x6 * -3.0681826488026711641232680e-02 + \
                x2 * x5_2 * -2.5990987575268276188467098e-01 + \
                x2 * x4 * 4.0952242489321427632020800e-01 + \
                x2 * x4 * x7 * 7.2306220815206628804716615e-02 + \
                x2 * x4 * x6 * 4.6414550414599492489386989e-02 + \
                x2 * x4 * x5 * 1.7783734729726405343619433e-01 + \
                x2 * x4_2 * -1.7167842803008351304505652e-01 + \
                x2 * x3 * -1.3716386171504237889706701e+00 + \
                x2 * x3 * x7 * -4.1172615717997324003007975e-02 + \
                x2 * x3 * x6 * -5.2682813554751545259691170e-02 + \
                x2 * x3 * x5 * 1.3295865963824285427286043e-01 + \
                x2 * x3 * x4 * -1.8635440404844971773457019e-01 + \
                x2 * x3_2 * 4.9096849866549052698871947e-02 + \
                x2_2 * -1.7272046078380347555736307e+00 + \
                x2_2 * x7 * -6.4652130695756565570420094e-02 + \
                x2_2 * x6 * -8.4024982766565114999934849e-02 + \
                x2_2 * x5 * -3.9731992087317341555419148e-01 + \
                x2_2 * x4 * -1.2993792348863650309986895e-01 + \
                x2_2 * x3 * 7.2126865473220669322529375e-01 + \
                x2_3 * 1.2764494783973276970101551e+00 + \
                x1 * 2.6937403176668595072840162e-01 + \
                x1 * x7 * -5.7398567353746376973333554e-03 + \
                x1 * x7_2 * -1.7325005780479477146549527e-02 + \
                x1 * x6 * 9.3820011657476554134404978e-02 + \
                x1 * x6 * x7 * 1.2868144145293802793617033e-02 + \
                x1 * x6_2 * -5.9955281207645150232110609e-02 + \
                x1 * x5 * 8.6375339347928070665716405e-02 + \
                x1 * x5 * x7 * 8.3592866866084858390451018e-02 + \
                x1 * x5 * x6 * 1.4433557618285811074976266e-01 + \
                x1 * x5_2 * 1.4331589391951096712496394e-01 + \
                x1 * x4 * 8.5775571268775246958071534e-02 + \
                x1 * x4 * x7 * -8.6809445998358991669618945e-02 + \
                x1 * x4 * x6 * 1.0434922380352668058733911e-01 + \
                x1 * x4 * x5 * 2.8078898450143024989600349e-02 + \
                x1 * x4_2 * -1.2408370599243093157504347e-01 + \
                x1 * x3 * -6.3152712769748139964853806e-02 + \
                x1 * x3 * x7 * -3.1150446714186319496775468e-02 + \
                x1 * x3 * x6 * -1.9514441939372656475981671e-02 + \
                x1 * x3 * x5 * -3.6092926859386859073097753e-01 + \
                x1 * x3 * x4 * -2.3007121375134689106323194e-02 + \
                x1 * x3_2 * -1.3942065547754373122657512e-01 + \
                x1 * x2 * -3.1115725762731569759012018e+00 + \
                x1 * x2 * x7 * 8.8160907633121926574304439e-02 + \
                x1 * x2 * x6 * -2.6333743657559743889251536e-01 + \
                x1 * x2 * x5 * -1.9304059034587478516087344e-01 + \
                x1 * x2 * x4 * -1.4099946078514255520808263e-01 + \
                x1 * x2 * x3 * 9.0933905375124957082277888e-01 + \
                x1 * x2_2 * 2.2837190315675965912589618e+00 + \
                x1_2 * -9.3079363763728217850967894e-01 + \
                x1_2 * x7 * -2.1644913337527799113146898e-03 + \
                x1_2 * x6 * 8.5795169252952246941035241e-02 + \
                x1_2 * x5 * -1.4748344863772810953150838e-01 + \
                x1_2 * x4 * 8.8165022149173433163582558e-02 + \
                x1_2 * x3 * -1.4664574157817869548559031e-01 + \
                x1_2 * x2 * 1.7304010413895982711807164e+00 + \
                x1_3 * 1.3854812194976207084806674e-01 + \
                x0 * -5.4756281300450426741122101e-01 + \
                x0 * x7 * -2.6430772793772167039705323e-01 + \
                x0 * x7_2 * 3.3238458582883695369147858e-01 + \
                x0 * x6 * 2.1780799052339433474756447e-01 + \
                x0 * x6 * x7 * 8.7143265993550045322990627e-04 + \
                x0 * x6_2 * -2.4545344266187402171297549e-01 + \
                x0 * x5 * 2.9067570941087328417751223e-01 + \
                x0 * x5 * x7 * 7.9210390811843833791527913e-02 + \
                x0 * x5 * x6 * -1.2745466041368286314039437e-01 + \
                x0 * x5_2 * -4.0571918031819892425104968e-01 + \
                x0 * x4 * 7.1713086204490372743691751e-01 + \
                x0 * x4 * x7 * 5.1206270971048621631904751e-02 + \
                x0 * x4 * x6 * -1.0961297525621077619817356e-01 + \
                x0 * x4 * x5 * -1.1844868536475086640002985e-01 + \
                x0 * x4_2 * -1.8708918406569458037225218e-01 + \
                x0 * x3 * -1.8572685639833053095060222e-01 + \
                x0 * x3 * x7 * 7.3707553322325591871333472e-02 + \
                x0 * x3 * x6 * 3.9994335764472602190444661e-02 + \
                x0 * x3 * x5 * 5.1176559300017444853470039e-02 + \
                x0 * x3 * x4 * -2.8571810469701475199144625e-02 + \
                x0 * x3_2 * -6.0500418471039429935132148e-02 + \
                x0 * x2 * 1.0086024566659861356754391e+00 + \
                x0 * x2 * x7 * -4.5091576680699185786238559e-02 + \
                x0 * x2 * x6 * 7.2679343805779866860561356e-02 + \
                x0 * x2 * x5 * -9.5973440517774760705194126e-02 + \
                x0 * x2 * x4 * -1.5492719197313231660473321e-01 + \
                x0 * x2 * x3 * 1.1156713069489872236506045e-01 + \
                x0 * x2_2 * -5.1617831330173236104030821e-01 + \
                x0 * x1 * 2.9527627955504387458063320e-01 + \
                x0 * x1 * x7 * -1.0999297187253215257740635e-01 + \
                x0 * x1 * x6 * 1.8522965695613652359341472e-02 + \
                x0 * x1 * x5 * 9.7775755937915320714637346e-02 + \
                x0 * x1 * x4 * -2.2612282341555683951028755e-02 + \
                x0 * x1 * x3 * -1.3597680788058530421125170e-01 + \
                x0 * x1 * x2 * -8.4685565483777841544466014e-02 + \
                x0 * x1_2 * -2.3529786726084167547412562e-01 + \
                x0_2 * 1.4212619710405283157683698e-01 + \
                x0_2 * x7 * -6.1286655011007912241538520e-03 + \
                x0_2 * x6 * 5.7850113758500520955152524e-02 + \
                x0_2 * x5 * 1.1563974999853360303703198e-01 + \
                x0_2 * x4 * -2.2427486842348420825743460e-01 + \
                x0_2 * x3 * 8.4043437878822152553581759e-02 + \
                x0_2 * x2 * -2.9835037226993132986052615e-01 + \
                x0_2 * x1 * 4.3557421965935469443387262e-02 + \
                x0_3 * 1.5805481889426677838406121e-02
            output = output * 6.7451181794480092744799304e-08 + -7.9999999963187334628455030e-06
            OxygenPrdtImpurityCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\OxygenPrdtImpurityCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            OxygenPrdtImpurityCon += output
            return OxygenPrdtImpurityCon

        def PurityCon2(m):
            return OxygenPrdtImpurityCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                              m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                              m.OxSplitterOutARatio)

        test_model.PurityCon2 = Expression(rule=PurityCon2)

        def NitrogenPrdtPurityCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                       vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * -2.8479355602332872415827225e-02 + \
                x7 * 9.5211370554480201366942538e-03 + \
                x7_2 * -3.8508486398553670726485620e-04 + \
                x7_3 * 2.1221871814976738662705813e-02 + \
                x6 * 2.5840808697803210880472591e-02 + \
                x6 * x7 * 1.7594824806382490522960182e-02 + \
                x6 * x7_2 * -3.5551485859872042349927312e-02 + \
                x6_2 * -3.0235760145395071396556830e-02 + \
                x6_2 * x7 * 9.2903499437082329159842686e-03 + \
                x6_3 * 1.1272151991973539120195369e-02 + \
                x5 * 4.1275695243917845389525212e-02 + \
                x5 * x7 * -6.1830101983418803146541620e-03 + \
                x5 * x7_2 * -2.5428262284697810552414055e-03 + \
                x5 * x6 * -4.8055174663115367283960921e-02 + \
                x5 * x6 * x7 * 1.2129988169266481441710415e-03 + \
                x5 * x6_2 * 2.2440713647694694038436936e-02 + \
                x5_2 * -3.3157908135780733704933709e-02 + \
                x5_2 * x7 * -1.4085906371333535569423390e-02 + \
                x5_2 * x6 * 1.6448402268879919185806671e-02 + \
                x5_3 * 2.3692874109964727480370783e-02 + \
                x4 * -5.1184195972136525831786003e-03 + \
                x4 * x7 * 1.8726677059974782685314310e-02 + \
                x4 * x7_2 * 1.1354872395418699748681490e-03 + \
                x4 * x6 * 2.1297974934542149294536273e-02 + \
                x4 * x6 * x7 * 2.9814681461370277915090554e-02 + \
                x4 * x6_2 * -4.1853451878365283134186825e-02 + \
                x4 * x5 * -1.3985692138290192754190855e-02 + \
                x4 * x5 * x7 * 1.1251061727376374110853874e-03 + \
                x4 * x5 * x6 * 4.3416733167392987380317493e-03 + \
                x4 * x5_2 * 1.4548984119352251220824712e-03 + \
                x4_2 * 1.1814900836962516361694497e-03 + \
                x4_2 * x7 * -3.2424282725610764632762084e-02 + \
                x4_2 * x6 * 2.3403077375918623914685668e-03 + \
                x4_2 * x5 * -1.3376030743562899311127623e-02 + \
                x4_3 * -5.7363878570683146662645413e-03 + \
                x3 * -4.2768039692546153118790642e-02 + \
                x3 * x7 * 1.6126086027008299655927104e-02 + \
                x3 * x7_2 * -7.4327268708619716880425798e-03 + \
                x3 * x6 * 4.3128985894927591993042171e-02 + \
                x3 * x6 * x7 * 2.1237831872088924062280668e-02 + \
                x3 * x6_2 * -6.5914518594659382566547379e-02 + \
                x3 * x5 * 2.1451867925025153160945024e-02 + \
                x3 * x5 * x7 * -7.5438723935428424888227639e-03 + \
                x3 * x5 * x6 * -3.5060292420533094304158084e-02 + \
                x3 * x5_2 * -2.1090604231449481750781949e-03 + \
                x3 * x4 * -7.6991679140390553715000976e-02 + \
                x3 * x4 * x7 * 6.3157177944366330035741441e-03 + \
                x3 * x4 * x6 * 2.9467586961013470664427771e-02 + \
                x3 * x4 * x5 * -8.2505502098388638909653992e-04 + \
                x3 * x4_2 * -1.6602023537269611219713283e-02 + \
                x3_2 * 1.9067608728218207736482270e-01 + \
                x3_2 * x7 * 2.2825850679992230884973736e-02 + \
                x3_2 * x6 * 6.1241723534013747798354643e-02 + \
                x3_2 * x5 * 2.1475675023885799214129477e-02 + \
                x3_2 * x4 * -8.1369601750710757182005750e-02 + \
                x3_3 * 1.2853353370011239009684800e-01 + \
                x2 * 1.1229939492519713795104508e-01 + \
                x2 * x7 * -3.2846039003997754002206477e-02 + \
                x2 * x7_2 * -5.9476647496766350819985547e-03 + \
                x2 * x6 * -5.1010138130355237029434079e-02 + \
                x2 * x6 * x7 * -3.7581914527557186422868085e-02 + \
                x2 * x6_2 * 4.9677283424245058385260165e-02 + \
                x2 * x5 * -1.4099346806126851483487172e-02 + \
                x2 * x5 * x7 * 3.0715516320610737610596885e-02 + \
                x2 * x5 * x6 * 1.2741486239901247956574082e-02 + \
                x2 * x5_2 * 1.8011431617667786331260515e-03 + \
                x2 * x4 * 9.9640568129345311043643107e-02 + \
                x2 * x4 * x7 * -3.6559945450744431305611926e-03 + \
                x2 * x4 * x6 * -1.9926076024181588186579006e-02 + \
                x2 * x4 * x5 * 1.9490327521689419093542384e-02 + \
                x2 * x4_2 * 7.8314338457831506046247227e-02 + \
                x2 * x3 * 1.7677571530037153313408282e-01 + \
                x2 * x3 * x7 * -3.0546451369069103909392737e-02 + \
                x2 * x3 * x6 * -5.6243801461110264072740250e-02 + \
                x2 * x3 * x5 * -1.2474818614702311986297545e-02 + \
                x2 * x3 * x4 * 2.1920716227839029399682147e-01 + \
                x2 * x3_2 * -1.4276923457219459212552692e-01 + \
                x2_2 * -2.5061174364716898299576542e-01 + \
                x2_2 * x7 * 3.1103563681730912043876813e-02 + \
                x2_2 * x6 * 3.8981627221144649064754617e-02 + \
                x2_2 * x5 * -1.7517168235378709206795378e-02 + \
                x2_2 * x4 * -2.0865552010777238534089406e-01 + \
                x2_2 * x3 * -2.7229338601740060710199032e-01 + \
                x2_3 * 2.2194115764407554292070301e-01 + \
                x1 * 7.6929396998847057731474308e-02 + \
                x1 * x7 * -3.9220786063878174121377640e-02 + \
                x1 * x7_2 * 4.9239417293143114551234873e-03 + \
                x1 * x6 * -4.5645976417614489428764557e-02 + \
                x1 * x6 * x7 * -8.6031851801797315504316543e-03 + \
                x1 * x6_2 * 3.9366472437606957190947554e-02 + \
                x1 * x5 * -2.9983137843331605920660365e-02 + \
                x1 * x5 * x7 * 1.0537007656342203820720727e-03 + \
                x1 * x5 * x6 * -2.5352899992219478375599095e-04 + \
                x1 * x5_2 * 5.8268194268285798675943710e-03 + \
                x1 * x4 * 8.2142112760326860265713833e-02 + \
                x1 * x4 * x7 * -2.3546162507355160309341358e-02 + \
                x1 * x4 * x6 * -5.3959878668715013233514455e-03 + \
                x1 * x4 * x5 * 2.3435784232960218259611551e-02 + \
                x1 * x4_2 * 3.4068912457114686187509278e-02 + \
                x1 * x3 * 1.5120670797770280335825532e-01 + \
                x1 * x3 * x7 * -1.6460502596318656032270411e-02 + \
                x1 * x3 * x6 * -1.1827440289936295286787882e-02 + \
                x1 * x3 * x5 * -3.5092438874834583351081108e-02 + \
                x1 * x3 * x4 * 1.4537499482732257893857764e-01 + \
                x1 * x3_2 * -7.5701477950791296045451872e-02 + \
                x1 * x2 * -2.9557738081579204569848685e-01 + \
                x1 * x2 * x7 * 4.4066872298034832911017844e-02 + \
                x1 * x2 * x6 * 1.4541517435298313351554889e-02 + \
                x1 * x2 * x5 * 1.4196609054874735622586712e-02 + \
                x1 * x2 * x4 * -2.6713729619804293946572216e-01 + \
                x1 * x2 * x3 * -3.3654074177842235870983245e-01 + \
                x1 * x2_2 * 3.9370669493176529973865740e-01 + \
                x1_2 * -1.1970611083844202859882699e-01 + \
                x1_2 * x7 * 2.3897729094193347065822053e-02 + \
                x1_2 * x6 * 2.0115305768976580319540304e-02 + \
                x1_2 * x5 * 1.4720154922712322398403728e-02 + \
                x1_2 * x4 * -8.3885909796893518008964463e-02 + \
                x1_2 * x3 * -1.2861009402522188826978322e-01 + \
                x1_2 * x2 * 2.2586995041609775336510779e-01 + \
                x1_3 * 6.5081458598008706806226087e-02 + \
                x0 * 8.4337931832220297545532617e-02 + \
                x0 * x7 * -6.7060547395325478814420705e-02 + \
                x0 * x7_2 * -8.8348044915661019804709042e-04 + \
                x0 * x6 * -3.3684182056550555917073808e-02 + \
                x0 * x6 * x7 * -9.3735460600181032958522209e-03 + \
                x0 * x6_2 * 3.3933462634789413048252982e-02 + \
                x0 * x5 * -5.0614825182644873624582260e-02 + \
                x0 * x5 * x7 * 2.0957299961199229998420890e-02 + \
                x0 * x5 * x6 * 3.7790488201817420965689109e-02 + \
                x0 * x5_2 * 4.0022289110138386213078032e-04 + \
                x0 * x4 * 2.0142262314537244527468118e-02 + \
                x0 * x4 * x7 * -2.5331675059930419680043201e-03 + \
                x0 * x4 * x6 * -1.6747637995453132364609417e-02 + \
                x0 * x4 * x5 * 1.7221891748387480047810527e-02 + \
                x0 * x4_2 * 2.9913849458342352954920429e-02 + \
                x0 * x3 * -1.4980654919368238675581040e-01 + \
                x0 * x3 * x7 * -4.7631557086499187736450267e-02 + \
                x0 * x3 * x6 * -4.3017927367107487712782898e-02 + \
                x0 * x3 * x5 * -7.7838881076408815429257260e-03 + \
                x0 * x3 * x4 * 1.0294864269465651973600728e-01 + \
                x0 * x3_2 * -1.8754229166104424697536501e-01 + \
                x0 * x2 * -1.5814506089505084296398252e-01 + \
                x0 * x2 * x7 * 2.9347253058910838241502006e-02 + \
                x0 * x2 * x6 * 2.2408942386999978341188822e-02 + \
                x0 * x2 * x5 * -3.6778682222568456761102595e-03 + \
                x0 * x2 * x4 * -1.6946594532285358392087460e-01 + \
                x0 * x2 * x3 * 5.8229223983542639786481487e-02 + \
                x0 * x2_2 * 2.5690736128570140772708896e-01 + \
                x0 * x1 * -1.4539425629809216156118623e-01 + \
                x0 * x1 * x7 * 4.6940061363049352671783510e-02 + \
                x0 * x1 * x6 * 2.6374179889100402007784396e-03 + \
                x0 * x1 * x5 * 1.4380160346333943632846086e-02 + \
                x0 * x1 * x4 * -1.2203230486921190500737566e-01 + \
                x0 * x1 * x3 * -9.2344663564703811931000388e-03 + \
                x0 * x1 * x2 * 3.4383618458853204558067773e-01 + \
                x0 * x1_2 * 1.1269638640944869278914808e-01 + \
                x0_2 * -2.2979423784165578514837591e-02 + \
                x0_2 * x7 * 5.3879656287083063648246650e-02 + \
                x0_2 * x6 * 1.0811925880732552868179752e-02 + \
                x0_2 * x5 * 9.2306480286458748862887802e-03 + \
                x0_2 * x4 * -2.5797806646899925503424456e-02 + \
                x0_2 * x3 * 8.0357706798688116611728560e-02 + \
                x0_2 * x2 * 5.4924557438001744835709417e-03 + \
                x0_2 * x1 * 5.2015411640577463581180950e-02 + \
                x0_3 * 5.7516787298746846479602368e-03
            output = output * 6.3777774438779077925687488e-03 + -7.1842162162938372205189808e-05
            NitrogenPrdtPurityCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\NitrogenPrdtPurityCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            NitrogenPrdtPurityCon += output
            return NitrogenPrdtPurityCon

        def PurityCon3(m):
            return NitrogenPrdtPurityCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                              m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                              m.OxSplitterOutARatio)

        test_model.PurityCon3 = Expression(rule=PurityCon3)

        def NitrogenPrdtImpurityCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC,
                                         vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * -2.9426489050538108538379589e-02 + \
                x7 * 1.5743171970884303756399447e-02 + \
                x7_2 * -4.6270150630567559446593151e-03 + \
                x7_3 * 2.9827074996782717425380937e-02 + \
                x6 * 7.8679702089586023294742745e-02 + \
                x6 * x7 * 6.4199813945909692258773305e-03 + \
                x6 * x7_2 * -5.1737643764846276417390669e-02 + \
                x6_2 * -8.8878448232171489151731691e-02 + \
                x6_2 * x7 * 2.6332344294370764459234380e-02 + \
                x6_3 * 3.0239102275972221112176896e-02 + \
                x5 * 9.6547491808242374977666600e-02 + \
                x5 * x7 * -2.8381096700582399139367595e-02 + \
                x5 * x7_2 * 8.7565519157262600158375676e-03 + \
                x5 * x6 * -1.0240200207210523042355987e-01 + \
                x5 * x6 * x7 * 4.6302048459102799343733992e-03 + \
                x5 * x6_2 * 4.5160819347260169887015024e-02 + \
                x5_2 * -7.8468681500201614698042363e-02 + \
                x5_2 * x7 * -7.7010290051018615020694824e-03 + \
                x5_2 * x6 * 2.5283965470874837644377209e-02 + \
                x5_3 * 3.4591930764096522066264328e-02 + \
                x4 * -2.1952846086817735110630068e-02 + \
                x4 * x7 * 3.3987217497230028107058075e-02 + \
                x4 * x7_2 * -7.1744093214376955525146684e-03 + \
                x4 * x6 * 1.3176898884256955241101039e-02 + \
                x4 * x6 * x7 * 3.4108474772397076590912945e-02 + \
                x4 * x6_2 * -4.3046775044220692008067886e-02 + \
                x4 * x5 * -1.1626301293894567012721097e-02 + \
                x4 * x5 * x7 * -2.2789594207509259599087059e-03 + \
                x4 * x5 * x6 * 2.0286643148252743451553926e-02 + \
                x4 * x5_2 * -9.0767719090948627280734939e-03 + \
                x4_2 * 2.8922387331746943206489675e-02 + \
                x4_2 * x7 * -3.3470734361592958949760401e-02 + \
                x4_2 * x6 * 5.9093953864499670913801310e-03 + \
                x4_2 * x5 * -2.5702204301324443891374472e-02 + \
                x4_3 * -1.6925171624324400476702124e-02 + \
                x3 * -3.7619175226159762281952226e-02 + \
                x3 * x7 * 1.5501446393188608730007161e-02 + \
                x3 * x7_2 * -2.4149514165420674083328834e-02 + \
                x3 * x6 * 5.8928636697971270574925029e-02 + \
                x3 * x6 * x7 * 2.5191851947439600212241828e-02 + \
                x3 * x6_2 * -8.7946754629471837749754570e-02 + \
                x3 * x5 * 2.2100542352068184431823639e-02 + \
                x3 * x5 * x7 * 6.1123859266815298157959901e-03 + \
                x3 * x5 * x6 * -4.3240373543993938787455278e-02 + \
                x3 * x5_2 * -4.6890422742662555763426546e-03 + \
                x3 * x4 * -1.0240348202279896117072866e-01 + \
                x3 * x4 * x7 * 3.0702542830957683939185898e-02 + \
                x3 * x4 * x6 * 4.1239168852121151076506322e-02 + \
                x3 * x4 * x5 * -1.1116516545123219031343531e-02 + \
                x3 * x4_2 * -1.5664703921579039517381071e-03 + \
                x3_2 * -1.6904251466348961530083983e-02 + \
                x3_2 * x7 * 1.6348494390341014592671343e-02 + \
                x3_2 * x6 * 5.3507391946489901712880055e-02 + \
                x3_2 * x5 * 2.3489569927036157981348197e-02 + \
                x3_2 * x4 * -7.6920440430030517786619271e-02 + \
                x3_3 * 3.4358050087508577863371073e-02 + \
                x2 * 7.0831507186746203719174275e-02 + \
                x2 * x7 * -3.6206517542288103872483163e-02 + \
                x2 * x7_2 * 2.3497533384435852210625484e-03 + \
                x2 * x6 * -9.5148478850297230069443799e-02 + \
                x2 * x6 * x7 * -3.2220210079250986845433857e-02 + \
                x2 * x6_2 * 6.3054507581995031251231865e-02 + \
                x2 * x5 * -5.3293938990915147579929823e-02 + \
                x2 * x5 * x7 * 2.4097705763269645917734607e-02 + \
                x2 * x5 * x6 * 3.8761113181399263483140061e-02 + \
                x2 * x5_2 * 2.5495193561680264127122797e-02 + \
                x2 * x4 * 1.3796952934244588462320280e-01 + \
                x2 * x4 * x7 * -5.5098739749650620101117937e-03 + \
                x2 * x4 * x6 * -1.7451085200434538619029823e-02 + \
                x2 * x4 * x5 * 2.9132335450718895020205679e-02 + \
                x2 * x4_2 * 5.7461137701531890542572256e-02 + \
                x2 * x3 * 2.1114508156993480603169644e-01 + \
                x2 * x3 * x7 * -2.8319873071485895943411037e-02 + \
                x2 * x3 * x6 * -6.2259882836474093881218295e-02 + \
                x2 * x3 * x5 * -7.8647913662187839134443124e-03 + \
                x2 * x3 * x4 * 1.9715496198285897833102354e-01 + \
                x2 * x3_2 * 5.7002554878033712126850219e-02 + \
                x2_2 * -2.1133912214528510764566249e-01 + \
                x2_2 * x7 * 2.3972070158451090626794411e-02 + \
                x2_2 * x6 * 5.2559893121688690265091992e-02 + \
                x2_2 * x5 * -1.1507493196996593232128703e-02 + \
                x2_2 * x4 * -2.1215764083719554355944581e-01 + \
                x2_2 * x3 * -2.6918610642209384042899956e-01 + \
                x2_3 * 2.0239450344990783658971623e-01 + \
                x1 * 2.7690738371975252146706126e-02 + \
                x1 * x7 * -5.1745444890012023964054322e-02 + \
                x1 * x7_2 * 8.7114713646968024163275146e-03 + \
                x1 * x6 * -2.0180667001504132979095019e-02 + \
                x1 * x6 * x7 * -1.2657504452024423077793891e-02 + \
                x1 * x6_2 * 4.7377873375555823454163829e-02 + \
                x1 * x5 * -4.9413275913634743807811844e-02 + \
                x1 * x5 * x7 * 6.8300029548658859612775274e-03 + \
                x1 * x5 * x6 * -1.6632554794410066290044625e-03 + \
                x1 * x5_2 * 2.3794052575230057594568578e-02 + \
                x1 * x4 * 1.0523209018246869328461202e-01 + \
                x1 * x4 * x7 * -3.3098074182710199298007581e-02 + \
                x1 * x4 * x6 * -1.5960066429628251560846053e-02 + \
                x1 * x4 * x5 * 3.9113360149259264464394192e-02 + \
                x1 * x4_2 * 2.7065815381648601622988082e-02 + \
                x1 * x3 * 1.5429238945102446978197008e-01 + \
                x1 * x3 * x7 * -2.5850804110099618454698955e-02 + \
                x1 * x3 * x6 * 7.1931303947738237103415315e-04 + \
                x1 * x3 * x5 * -3.6687611529460172066219315e-02 + \
                x1 * x3 * x4 * 1.3497541631758996905077197e-01 + \
                x1 * x3_2 * 3.3842425491206355736562017e-02 + \
                x1 * x2 * -2.2068847333441207747561918e-01 + \
                x1 * x2 * x7 * 4.8669192945627805235719876e-02 + \
                x1 * x2 * x6 * 8.3529049407617753097987645e-03 + \
                x1 * x2 * x5 * 1.6574798680472770107119374e-02 + \
                x1 * x2 * x4 * -2.6037762687464721667041090e-01 + \
                x1 * x2 * x3 * -3.2305182224526074463710756e-01 + \
                x1 * x2_2 * 3.3901450988766002048180326e-01 + \
                x1_2 * -8.2631058486266645290996280e-02 + \
                x1_2 * x7 * 3.3824766884927678911587634e-02 + \
                x1_2 * x6 * 5.4847341385203668417958056e-04 + \
                x1_2 * x5 * 4.0554206842252152331873560e-03 + \
                x1_2 * x4 * -9.1316063504051067645228557e-02 + \
                x1_2 * x3 * -1.1864564998579031629422076e-01 + \
                x1_2 * x2 * 1.9612817943390195574160373e-01 + \
                x1_3 * 5.6999728723630474491734788e-02 + \
                x0 * 7.6292980202941951262118891e-02 + \
                x0 * x7 * -5.3686537801222518340171774e-02 + \
                x0 * x7_2 * 4.1554214624464798355507611e-04 + \
                x0 * x6 * -4.5351549414504470358888710e-02 + \
                x0 * x6 * x7 * -7.2084909764484252775451623e-03 + \
                x0 * x6_2 * 4.8045193671301548998808784e-02 + \
                x0 * x5 * -6.0032658972839589295311669e-02 + \
                x0 * x5 * x7 * 1.4586102978483500916540017e-02 + \
                x0 * x5 * x6 * 4.3062177018401030792471573e-02 + \
                x0 * x5_2 * 1.2336779088846817897806574e-02 + \
                x0 * x4 * 3.1927381434809512517070118e-02 + \
                x0 * x4 * x7 * -2.4940339893021794270833169e-02 + \
                x0 * x4 * x6 * -2.4389872845695544784083708e-02 + \
                x0 * x4 * x5 * 2.5309875493965044990218871e-02 + \
                x0 * x4_2 * 2.8188225477213994796255037e-02 + \
                x0 * x3 * 1.5681542313017125811480668e-02 + \
                x0 * x3 * x7 * -3.8383096322004088551960166e-02 + \
                x0 * x3 * x6 * -3.6259838938535834951260028e-02 + \
                x0 * x3 * x5 * -1.1164164588021798646400029e-02 + \
                x0 * x3 * x4 * 1.0368277328201977449673166e-01 + \
                x0 * x3_2 * -2.9885603068938771526008580e-02 + \
                x0 * x2 * -1.8159951375339997148294913e-01 + \
                x0 * x2 * x7 * 2.8454371747900726596913756e-02 + \
                x0 * x2 * x6 * 3.1872134950761556171361377e-02 + \
                x0 * x2 * x5 * -1.3290263340119398000060968e-02 + \
                x0 * x2 * x4 * -1.6088897685282474436796463e-01 + \
                x0 * x2 * x3 * -1.1798840747929140171379458e-01 + \
                x0 * x2_2 * 2.5859460326237809768556986e-01 + \
                x0 * x1 * -1.4999345820278386920421099e-01 + \
                x0 * x1 * x7 * 5.5897748192544546852467136e-02 + \
                x0 * x1 * x6 * -1.0583363043002882650234220e-02 + \
                x0 * x1 * x5 * 2.2488556152085371897531019e-02 + \
                x0 * x1 * x4 * -1.2072182216331436843681502e-01 + \
                x0 * x1 * x3 * -1.0699634624466577981216631e-01 + \
                x0 * x1 * x2 * 3.2317368772900623152821709e-01 + \
                x0 * x1_2 * 1.1321031079659737983433843e-01 + \
                x0_2 * -3.9572247198924229150129861e-02 + \
                x0_2 * x7 * 4.5023060566076973654237037e-02 + \
                x0_2 * x6 * 8.0050058781436540800147128e-03 + \
                x0_2 * x5 * 9.7732291566672291338591094e-03 + \
                x0_2 * x4 * -2.5708375946326925132190411e-02 + \
                x0_2 * x3 * 8.0577193450501304744504338e-03 + \
                x0_2 * x2 * 3.6813938604846503654943746e-02 + \
                x0_2 * x1 * 7.2302003589292576646307964e-02 + \
                x0_3 * 8.1634123100780692228184421e-03
            output = output * 4.4377588820142871081642078e-03 + -6.4719968980569201987126590e-06
            NitrogenPrdtImpurityCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\NitrogenPrdtImpurityCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            NitrogenPrdtImpurityCon += output
            return NitrogenPrdtImpurityCon

        def PurityCon4(m):
            return NitrogenPrdtImpurityCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                                m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                                m.OxSplitterOutARatio)

        test_model.PurityCon4 = Expression(rule=PurityCon4)

        def ArgonPrdtImpurityCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                      vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 3.3708201239975044138930116e-01 + \
                x7 * -3.8959236820600047501717000e-02 + \
                x7_2 * 6.0253912008904481067972370e-02 + \
                x7_3 * 4.3819941971963538573930919e-02 + \
                x6 * 1.0370150476671780026549641e-03 + \
                x6 * x7 * 2.5906926278054326351352188e-02 + \
                x6 * x7_2 * 5.6909042901067685704674659e-03 + \
                x6_2 * 8.4233201367797105874046792e-02 + \
                x6_2 * x7 * -6.7968099855271357778718766e-02 + \
                x6_3 * -6.4545149346527219691438404e-02 + \
                x5 * 2.0905359801764727967210433e-01 + \
                x5 * x7 * -8.5114064576353357094440355e-02 + \
                x5 * x7_2 * 2.2484132473285477205049432e-03 + \
                x5 * x6 * -1.4243117837064095398957875e-01 + \
                x5 * x6 * x7 * 1.0428915757152662502349472e-01 + \
                x5 * x6_2 * 2.5052567453090146543104311e-02 + \
                x5_2 * -9.6247360587839114742791935e-02 + \
                x5_2 * x7 * -3.2574834374549443971602614e-02 + \
                x5_2 * x6 * 1.7369376632225019818633882e-01 + \
                x5_3 * -5.9949899900953076969933875e-02 + \
                x4 * 2.3547390064879197835168156e-01 + \
                x4 * x7 * 3.6558339711104309577294202e-02 + \
                x4 * x7_2 * -4.5291469082396479395313804e-03 + \
                x4 * x6 * 7.6732873028424020134252714e-02 + \
                x4 * x6 * x7 * -2.3726696666093588516943669e-02 + \
                x4 * x6_2 * 1.1786647397223223854290097e-01 + \
                x4 * x5 * -2.4635049424903987524970717e-01 + \
                x4 * x5 * x7 * -1.3868380827547324707360588e-01 + \
                x4 * x5 * x6 * -1.4184387550503263497603257e-01 + \
                x4 * x5_2 * 3.6723091688229292373080170e-02 + \
                x4_2 * -2.0160733744007916512508416e-01 + \
                x4_2 * x7 * 8.9573698650004307530991809e-02 + \
                x4_2 * x6 * 4.7931842024329374130076076e-02 + \
                x4_2 * x5 * 1.3337639406981433021215366e-01 + \
                x4_3 * -9.2010569818793963570158212e-02 + \
                x3 * -1.9318141573188568616004090e-01 + \
                x3 * x7 * 1.5185334702530778328011252e-01 + \
                x3 * x7_2 * -6.5322406743578281806961172e-02 + \
                x3 * x6 * 1.8291541853238324488728495e-01 + \
                x3 * x6 * x7 * -2.9019200063480521389891464e-02 + \
                x3 * x6_2 * -3.5973454043462541052100789e-02 + \
                x3 * x5 * 3.1975686847650097721640350e-01 + \
                x3 * x5 * x7 * 1.0750409410938566168169928e-01 + \
                x3 * x5 * x6 * -9.4034847092668294443740251e-02 + \
                x3 * x5_2 * -1.3677058645663142666393242e-01 + \
                x3 * x4 * -3.4819728607301103640025985e-01 + \
                x3 * x4 * x7 * 1.2827334658058403560332295e-01 + \
                x3 * x4 * x6 * -5.5286200947404551264696693e-02 + \
                x3 * x4 * x5 * -8.1303325796981462669776874e-02 + \
                x3 * x4_2 * 1.8766564468952492972242396e-01 + \
                x3_2 * 6.9201557268651209264831436e-02 + \
                x3_2 * x7 * -1.0421574482672765760149503e-01 + \
                x3_2 * x6 * -1.1847140680231910137010232e-01 + \
                x3_2 * x5 * -2.2283937623669869410036881e-02 + \
                x3_2 * x4 * 1.3151214103594152660114958e-01 + \
                x3_3 * -9.7128158771019795780787831e-02 + \
                x2 * -3.5899441036575359120774920e+00 + \
                x2 * x7 * -4.2099238465062732705845860e-01 + \
                x2 * x7_2 * 1.2433745736806765813664555e-01 + \
                x2 * x6 * -2.9050542238834509145561924e-01 + \
                x2 * x6 * x7 * -2.7995479601447673112524228e-02 + \
                x2 * x6_2 * 3.8195141518239772437937063e-02 + \
                x2 * x5 * -2.8155333706450436093149392e-01 + \
                x2 * x5 * x7 * 9.0208209169040140529283178e-02 + \
                x2 * x5 * x6 * -1.0299734305535236666973020e-01 + \
                x2 * x5_2 * 1.7971306582546459074123391e-01 + \
                x2 * x4 * -1.2190084406821394269471170e-01 + \
                x2 * x4 * x7 * 2.4807718696174631267670208e-02 + \
                x2 * x4 * x6 * -9.8178141225983395212750793e-02 + \
                x2 * x4 * x5 * 2.4735597488564664558907680e-01 + \
                x2 * x4_2 * 3.1556794670180382533786201e-02 + \
                x2 * x3 * 9.3362661529859813924758782e-01 + \
                x2 * x3 * x7 * -3.5016875916270527591134254e-02 + \
                x2 * x3 * x6 * 1.6153004629116846091463344e-01 + \
                x2 * x3 * x5 * -2.3439527994503114860513904e-01 + \
                x2 * x3 * x4 * 6.8095143069047736616994371e-02 + \
                x2 * x3_2 * 4.5732385360177547906079809e-02 + \
                x2_2 * 7.1347627920770486653623266e+00 + \
                x2_2 * x7 * 1.3559839821024097239465789e-01 + \
                x2_2 * x6 * 2.5887497568858541807657048e-01 + \
                x2_2 * x5 * 1.1068868869358809703395963e-01 + \
                x2_2 * x4 * -4.8086522435518419538169610e-04 + \
                x2_2 * x3 * -7.5382267586777818024756925e-01 + \
                x2_3 * -2.8444553348629919575785152e+00 + \
                x1 * -1.5859354893588804014115112e+00 + \
                x1 * x7 * 4.7947413279317285805802840e-03 + \
                x1 * x7_2 * -2.0916706175694713132351410e-01 + \
                x1 * x6 * -7.8846790940505284694950205e-02 + \
                x1 * x6 * x7 * -6.6003318923152365371720407e-04 + \
                x1 * x6_2 * -3.3932194532930129438064171e-02 + \
                x1 * x5 * -3.7309702212182849212496194e-01 + \
                x1 * x5 * x7 * 7.8392263045256038722641279e-02 + \
                x1 * x5 * x6 * 5.5839588337733767064996471e-02 + \
                x1 * x5_2 * 5.7398368273167341135909680e-02 + \
                x1 * x4 * -5.8463206743348039573504593e-02 + \
                x1 * x4 * x7 * -9.9872330639667369900358551e-02 + \
                x1 * x4 * x6 * 2.3631837518740234083125529e-02 + \
                x1 * x4 * x5 * 1.4555493022959492543932924e-01 + \
                x1 * x4_2 * 3.2778898984748436329361709e-02 + \
                x1 * x3 * 2.6535028336687799255244613e-01 + \
                x1 * x3 * x7 * -6.1124196212847134446199959e-02 + \
                x1 * x3 * x6 * -6.7360641306828950014562452e-02 + \
                x1 * x3 * x5 * -7.9455101038121339618314209e-02 + \
                x1 * x3 * x4 * 7.2226169315429133988004651e-02 + \
                x1 * x3_2 * 6.7731617168671931494827732e-02 + \
                x1 * x2 * 8.1275460637227165960894126e+00 + \
                x1 * x2 * x7 * 2.1391130037739961022857926e-01 + \
                x1 * x2 * x6 * 8.4042172948563670376032064e-02 + \
                x1 * x2 * x5 * 1.0831268931683996070702847e-01 + \
                x1 * x2 * x4 * 4.5122122364433026042718211e-02 + \
                x1 * x2 * x3 * -6.9768439734632470283770544e-01 + \
                x1 * x2_2 * -5.8770783448877788046615933e+00 + \
                x1_2 * 1.3986935254371615222623859e+00 + \
                x1_2 * x7 * 1.1251221612509647307387439e-01 + \
                x1_2 * x6 * 5.9624745065513171105031631e-02 + \
                x1_2 * x5 * 2.0726328484057687795427682e-01 + \
                x1_2 * x4 * -2.7600747697844978112424741e-02 + \
                x1_2 * x3 * 1.1908665545604431301729420e-01 + \
                x1_2 * x2 * -2.3122081110953049964962247e+00 + \
                x1_3 * -2.3137895402873964734169476e-01 + \
                x0 * -1.1625951680559493128797044e-02 + \
                x0 * x7 * 3.3753225858689794858236155e-01 + \
                x0 * x7_2 * -1.8196895023837320048976096e-01 + \
                x0 * x6 * -1.6288678064607858830825649e-01 + \
                x0 * x6 * x7 * 8.8878680254120892567648582e-03 + \
                x0 * x6_2 * -3.0505514366684065991064401e-02 + \
                x0 * x5 * 2.6494273994982275866050259e-02 + \
                x0 * x5 * x7 * 5.4151050981890075375346782e-02 + \
                x0 * x5 * x6 * 7.7736817890324327873230459e-02 + \
                x0 * x5_2 * 6.5531767631251930383839976e-02 + \
                x0 * x4 * 2.8525681359294663419490234e-01 + \
                x0 * x4 * x7 * -8.3810182256725720972845295e-02 + \
                x0 * x4 * x6 * -1.8661758202701522746380647e-01 + \
                x0 * x4 * x5 * 1.4172416810448021373680660e-01 + \
                x0 * x4_2 * 1.1228649817145752720648488e-01 + \
                x0 * x3 * -2.2733852397796489031023270e-01 + \
                x0 * x3 * x7 * -4.9802899751670931527414155e-02 + \
                x0 * x3 * x6 * 5.0935926963400462996744977e-02 + \
                x0 * x3 * x5 * 9.6372701877131761172279312e-02 + \
                x0 * x3 * x4 * -1.3110816884316039976354773e-01 + \
                x0 * x3_2 * 1.5151519681223274416126401e-01 + \
                x0 * x2 * -5.8494224355676283089167100e-01 + \
                x0 * x2 * x7 * 6.0479461422693059358124401e-02 + \
                x0 * x2 * x6 * -3.3500833796457074598151848e-02 + \
                x0 * x2 * x5 * -6.8921886977965460263639841e-02 + \
                x0 * x2 * x4 * -1.2253729100055812950564871e-01 + \
                x0 * x2 * x3 * 2.1822078891781804266258860e-01 + \
                x0 * x2_2 * 2.4114840933105113895962290e-01 + \
                x0 * x1 * 2.4780174711998675940449743e-01 + \
                x0 * x1 * x7 * -1.8711265089178277104542403e-02 + \
                x0 * x1 * x6 * 4.2025201536018713666109647e-02 + \
                x0 * x1 * x5 * -7.0149364911210251860573806e-02 + \
                x0 * x1 * x4 * -1.1530293942458791356386882e-01 + \
                x0 * x1 * x3 * -3.9920048186717307925341913e-02 + \
                x0 * x1 * x2 * 4.0631134471363139493149674e-01 + \
                x0 * x1_2 * -2.5279947990865198059751151e-01 + \
                x0_2 * -5.0256752338276949876316735e-02 + \
                x0_2 * x7 * -1.3090367408690767314638492e-01 + \
                x0_2 * x6 * 1.8976680280925664612290404e-01 + \
                x0_2 * x5 * -1.9231699101929644601938207e-01 + \
                x0_2 * x4 * -1.8131526759359972711393993e-01 + \
                x0_2 * x3 * 1.3686907820643939848181958e-02 + \
                x0_2 * x2 * 1.2899889043498341534288443e-01 + \
                x0_2 * x1 * -1.2717763607232776545963304e-01 + \
                x0_3 * 1.3956647914283679123848003e-01
            output = output * 9.9631207425127321641866729e-01 + -7.9999999999999047702948021e-06
            ArgonPrdtImpurityCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\ArgonPrdtImpurityCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            ArgonPrdtImpurityCon += output
            return ArgonPrdtImpurityCon

        def PurityCon5(m):
            return ArgonPrdtImpurityCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                             m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                             m.OxSplitterOutARatio)

        test_model.PurityCon5 = Expression(rule=PurityCon5)

        def CrudeArgonImpurityCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                       vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 1.4268310236219445830130326e+00 + \
                x7 * -4.8679560667295729281534022e-03 + \
                x7_2 * 5.3943993413481594600966673e-01 + \
                x7_3 * -3.8426377531474492643681629e-01 + \
                x6 * -9.2639398449898058274243340e-01 + \
                x6 * x7 * 4.2855352265013296753082273e-01 + \
                x6 * x7_2 * -3.2748971917474384296653511e-01 + \
                x6_2 * 6.5226745201407598795384501e-01 + \
                x6_2 * x7 * -1.9973720236776301706349557e-01 + \
                x6_3 * -2.1269261617326629121293990e-01 + \
                x5 * -2.0918217769941438444192272e-01 + \
                x5 * x7 * -4.0232776551302629197692795e-01 + \
                x5 * x7_2 * -2.4619956186158953315157305e-01 + \
                x5 * x6 * 3.0003512297889811666351534e-01 + \
                x5 * x6 * x7 * 2.8641789605156703357735637e-01 + \
                x5 * x6_2 * 8.9073221379910888506614697e-02 + \
                x5_2 * 8.2566867281654177102012682e-01 + \
                x5_2 * x7 * 1.1007878725965292154853614e-01 + \
                x5_2 * x6 * -5.3864258733518011190710695e-01 + \
                x5_3 * -3.3212865026522186973068074e-01 + \
                x4 * -1.9116055080559449241839332e-01 + \
                x4 * x7 * -1.5085939176642515491266749e-01 + \
                x4 * x7_2 * 1.9050725361524356582521023e-02 + \
                x4 * x6 * 5.6730597987393938108624525e-01 + \
                x4 * x6 * x7 * 7.4108965217609235054396777e-02 + \
                x4 * x6_2 * -2.7172892039247892315145805e-01 + \
                x4 * x5 * -6.1660643295932593410668687e-01 + \
                x4 * x5 * x7 * 2.7355475187856764796023867e-01 + \
                x4 * x5 * x6 * 1.5062795871534717662143521e-01 + \
                x4 * x5_2 * 2.8898115830790049862741853e-02 + \
                x4_2 * -4.5990969999486785990683302e-01 + \
                x4_2 * x7 * 5.6808339254209305746456948e-02 + \
                x4_2 * x6 * -3.0239133373238269442140336e-01 + \
                x4_2 * x5 * 1.1542259198559506883086101e-01 + \
                x4_3 * 5.5162906694660818196496166e-01 + \
                x3 * -3.9115173359070837255657693e-01 + \
                x3 * x7 * -6.3473814169902498250053213e-02 + \
                x3 * x7_2 * -5.1310045135802340166009117e-02 + \
                x3 * x6 * 5.4103523954569676668313605e-01 + \
                x3 * x6 * x7 * -1.3359453292287212788913564e-01 + \
                x3 * x6_2 * 6.2010207741866468778013655e-02 + \
                x3 * x5 * -2.0749847967452245134367672e-01 + \
                x3 * x5 * x7 * 2.3751322131378299618020833e-01 + \
                x3 * x5 * x6 * -1.9033944556494952760061778e-01 + \
                x3 * x5_2 * 2.8935981895369072836032842e-01 + \
                x3 * x4 * 5.0035281778583173828423014e-01 + \
                x3 * x4 * x7 * -2.3712866628050827122464739e-01 + \
                x3 * x4 * x6 * -2.9974749037043202370966810e-01 + \
                x3 * x4 * x5 * 2.2702943676238077075346666e-01 + \
                x3 * x4_2 * 2.0431190918656340349546241e-02 + \
                x3_2 * 1.9380968673779586097793981e-01 + \
                x3_2 * x7 * 8.1193036930751943947015548e-02 + \
                x3_2 * x6 * -2.2847464235670597587635200e-01 + \
                x3_2 * x5 * -1.4227768909893920290521407e-01 + \
                x3_2 * x4 * -1.9098507328930769411101664e-01 + \
                x3_3 * 1.7148066709627476922328526e-01 + \
                x2 * -3.8646855267944157930060101e-01 + \
                x2 * x7 * -1.9596439386304401186755797e-01 + \
                x2 * x7_2 * 2.0786297558392641260383016e-01 + \
                x2 * x6 * 3.2372201878769635285948425e-01 + \
                x2 * x6 * x7 * -2.9787349496284643013410687e-02 + \
                x2 * x6_2 * 2.9111014919036976023036800e-02 + \
                x2 * x5 * 4.6065254449452230911532524e-01 + \
                x2 * x5 * x7 * 1.2518375853242380557617253e-01 + \
                x2 * x5 * x6 * -1.2899842913218606543779288e-02 + \
                x2 * x5_2 * -2.6365025336903108454933431e-01 + \
                x2 * x4 * 4.7349817780365155428512480e-01 + \
                x2 * x4 * x7 * 6.7436901866391424364977070e-02 + \
                x2 * x4 * x6 * 5.8982494967878495994995092e-02 + \
                x2 * x4 * x5 * 1.9713001231298948878745136e-01 + \
                x2 * x4_2 * -2.2448361126234228635212276e-01 + \
                x2 * x3 * -5.7693610941672612835162681e-01 + \
                x2 * x3 * x7 * -6.3113554854163367302533061e-03 + \
                x2 * x3 * x6 * -1.3587962220865026918836804e-01 + \
                x2 * x3 * x5 * 1.8154555018855153547541192e-01 + \
                x2 * x3 * x4 * -2.5139591539899047711870139e-01 + \
                x2 * x3_2 * 1.8606288172754600895864030e-02 + \
                x2_2 * -2.5690736968038589971286001e+00 + \
                x2_2 * x7 * -9.9477209770925500986749057e-02 + \
                x2_2 * x6 * -5.0014399386613950238000825e-02 + \
                x2_2 * x5 * -3.9564551567488931427263310e-01 + \
                x2_2 * x4 * -1.4238458488801608581297842e-01 + \
                x2_2 * x3 * 4.6113639145209883718479205e-01 + \
                x2_3 * 1.7240125695372894298884603e+00 + \
                x1 * 3.5708367477579283644217867e-01 + \
                x1 * x7 * 3.6305826122328910265935065e-02 + \
                x1 * x7_2 * -3.1097430980769336095193012e-03 + \
                x1 * x6 * 2.9212797190584893769482733e-02 + \
                x1 * x6 * x7 * 7.8725338821080126372464747e-03 + \
                x1 * x6_2 * -3.3349660139556057403265044e-02 + \
                x1 * x5 * 1.6614482758648480009711079e-01 + \
                x1 * x5 * x7 * 7.8667575349933516193345895e-02 + \
                x1 * x5 * x6 * 1.6156494460533193935347640e-01 + \
                x1 * x5_2 * 2.2062846798244001300659534e-01 + \
                x1 * x4 * -2.9733538733329539782701545e-02 + \
                x1 * x4 * x7 * -6.9753141217419850628189693e-02 + \
                x1 * x4 * x6 * 1.0228009925367931298723079e-01 + \
                x1 * x4 * x5 * 8.0200576148442559443196842e-03 + \
                x1 * x4_2 * -9.7906707035908285829961528e-02 + \
                x1 * x3 * 2.8342481540302671971787163e-01 + \
                x1 * x3 * x7 * -5.2367544819958422586125835e-02 + \
                x1 * x3 * x6 * -1.0577584986122776089523256e-01 + \
                x1 * x3 * x5 * -3.7945850138789061212207798e-01 + \
                x1 * x3 * x4 * 2.7319124482353674548962275e-02 + \
                x1 * x3_2 * -1.4042910708548844711529568e-01 + \
                x1 * x2 * -4.0918875904264035980872904e+00 + \
                x1 * x2 * x7 * 3.0135030601153744989062488e-02 + \
                x1 * x2 * x6 * -2.3077728565073879485325392e-01 + \
                x1 * x2 * x5 * -2.3919135739960367681433695e-01 + \
                x1 * x2 * x4 * -1.3054733795207693058948450e-01 + \
                x1 * x2 * x3 * 6.7358506035289811286759232e-01 + \
                x1 * x2_2 * 3.1267171927554171517726900e+00 + \
                x1_2 * -1.2533614756221767017052571e+00 + \
                x1_2 * x7 * -1.2854872141085771364288348e-02 + \
                x1_2 * x6 * 1.4209546387978308490396273e-01 + \
                x1_2 * x5 * -2.6403920320429907775405809e-01 + \
                x1_2 * x4 * 1.2898237607719259534277967e-01 + \
                x1_2 * x3 * -1.4745463856211982189847731e-01 + \
                x1_2 * x2 * 2.1084826567709513689408141e+00 + \
                x1_3 * 2.4484362381989532853054925e-01 + \
                x0 * -4.7693080010168897864275550e-01 + \
                x0 * x7 * -2.8230549297465046265642741e-01 + \
                x0 * x7_2 * 4.0317374972641228936254265e-01 + \
                x0 * x6 * 2.1787618782341788836731666e-01 + \
                x0 * x6 * x7 * 1.0988575380687440330440552e-02 + \
                x0 * x6_2 * -2.3380377872905572234074612e-01 + \
                x0 * x5 * 2.8483220664807712418920005e-01 + \
                x0 * x5 * x7 * 7.4894637541878084086022227e-02 + \
                x0 * x5 * x6 * -1.6935674150757273892509147e-01 + \
                x0 * x5_2 * -4.3827979908020087140840815e-01 + \
                x0 * x4 * 8.2323487716073051601028965e-01 + \
                x0 * x4 * x7 * 2.1087701505883335584279337e-02 + \
                x0 * x4 * x6 * -1.1050981886576370649688528e-01 + \
                x0 * x4 * x5 * -1.5094281438642917492209961e-01 + \
                x0 * x4_2 * -2.1599153106835039528377251e-01 + \
                x0 * x3 * -1.3655481551728365641196206e-01 + \
                x0 * x3 * x7 * 8.0542046531387634367149531e-02 + \
                x0 * x3 * x6 * 5.9279266818466805344378656e-02 + \
                x0 * x3 * x5 * 3.4308942996097102628993980e-02 + \
                x0 * x3 * x4 * -7.3223649612561059196735869e-02 + \
                x0 * x3_2 * -1.3348901592444178954011136e-01 + \
                x0 * x2 * 7.6669505576498164778342925e-01 + \
                x0 * x2 * x7 * -6.5819977672182172767634256e-02 + \
                x0 * x2 * x6 * 1.0394883019921045963496198e-01 + \
                x0 * x2 * x5 * -1.1979909624578252702598036e-01 + \
                x0 * x2 * x4 * -1.2473939747964604696228719e-01 + \
                x0 * x2 * x3 * 1.4060124127367071289462785e-01 + \
                x0 * x2_2 * -4.3487422833792788168238985e-01 + \
                x0 * x1 * 3.5530738201018485789006718e-01 + \
                x0 * x1 * x7 * -1.2407263488606176671247283e-01 + \
                x0 * x1 * x6 * 3.2803339311890417073769299e-02 + \
                x0 * x1 * x5 * 8.0167178360248614321648120e-02 + \
                x0 * x1 * x4 * -1.7064230544131364641913251e-02 + \
                x0 * x1 * x3 * -1.6813477736103465964845327e-01 + \
                x0 * x1 * x2 * 1.3385461809040766212319795e-02 + \
                x0 * x1_2 * -2.8602196533533896793954909e-01 + \
                x0_2 * 1.9826925767245140441730200e-01 + \
                x0_2 * x7 * -2.0480021852883167898795591e-02 + \
                x0_2 * x6 * 1.2257606165540113618561691e-02 + \
                x0_2 * x5 * 2.1606053312465095528338566e-01 + \
                x0_2 * x4 * -2.5362796696786071848350730e-01 + \
                x0_2 * x3 * 8.8882225487925931028954096e-02 + \
                x0_2 * x2 * -3.4495699809136409763610231e-01 + \
                x0_2 * x1 * -5.4101108987557613994034966e-02 + \
                x0_3 * 3.7737367765319176915461696e-02
            output = output * 6.4075229081928489205388644e-02 + -7.9960616301762198546154714e-04
            CrudeArgonImpurityCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\CrudeArgonImpurityCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            CrudeArgonImpurityCon += output
            return CrudeArgonImpurityCon

        def PurityCon6(m):
            return CrudeArgonImpurityCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                              m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                              m.OxSplitterOutARatio)

        test_model.PurityCon6 = Expression(rule=PurityCon6)

        def LOX_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 3.5534612251105701652420521e-01 + \
                x7 * 2.8559597683921793265238165e-02 + \
                x7_2 * 2.7068457026498460304964055e-02 + \
                x7_3 * -9.9718423993594429433073856e-04 + \
                x6 * -3.2676481553017722170295656e-02 + \
                x6 * x7 * 3.0113347143749011336488763e-02 + \
                x6 * x7_2 * -4.4376809092291913394490166e-03 + \
                x6_2 * 2.8519587280683711405515623e-02 + \
                x6_2 * x7 * -1.4467562534399375229199336e-02 + \
                x6_3 * -1.5245065243140537569743742e-02 + \
                x5 * 6.3378879756432526804132976e-02 + \
                x5 * x7 * -1.7389648986329060698086124e-02 + \
                x5 * x7_2 * 1.1556000095255224147106077e-02 + \
                x5 * x6 * -7.3022881172840198304996306e-03 + \
                x5 * x6 * x7 * -1.8203787177314897927082882e-03 + \
                x5 * x6_2 * -1.6207763408648476199935828e-02 + \
                x5_2 * -4.6701194620295261028530831e-02 + \
                x5_2 * x7 * 1.2821219374418213465816052e-02 + \
                x5_2 * x6 * 2.8282068229417187121832455e-02 + \
                x5_3 * -9.6997707846734615433348381e-03 + \
                x4 * 1.9079921703345572442378497e-02 + \
                x4 * x7 * 4.1938485171780712223998933e-02 + \
                x4 * x7_2 * 1.1723944392938619174504566e-03 + \
                x4 * x6 * -1.6311876539695572413402047e-02 + \
                x4 * x6 * x7 * 3.4801990905305325157970131e-03 + \
                x4 * x6_2 * 2.7554781662344565024147514e-02 + \
                x4 * x5 * -3.4956812776158294187034414e-02 + \
                x4 * x5 * x7 * -2.6216308434239603275539565e-02 + \
                x4 * x5 * x6 * -1.5264355008636827648604850e-02 + \
                x4 * x5_2 * 8.8325645567012764369785316e-03 + \
                x4_2 * 1.8846992515937334433662187e-02 + \
                x4_2 * x7 * -1.7864553819498862896608671e-02 + \
                x4_2 * x6 * 2.2721873835102532335206149e-02 + \
                x4_2 * x5 * 1.1374375042892653775439271e-02 + \
                x4_3 * -2.7758573022803594010365913e-02 + \
                x3 * -2.7535416933448064735756589e-01 + \
                x3 * x7 * 3.1309902593078670074433489e-02 + \
                x3 * x7_2 * -1.4015490869711067292713302e-03 + \
                x3 * x6 * 4.4129215810651600815361917e-02 + \
                x3 * x6 * x7 * -1.1380124166459750639779358e-02 + \
                x3 * x6_2 * -1.6588535202352747144338707e-02 + \
                x3 * x5 * 3.8592301284439460562492030e-02 + \
                x3 * x5 * x7 * 6.4664011078629790585381443e-03 + \
                x3 * x5 * x6 * -3.9476001557845197265095294e-03 + \
                x3 * x5_2 * 6.0546462019493707540362948e-04 + \
                x3 * x4 * -5.2174627423710165374792780e-02 + \
                x3 * x4 * x7 * 1.9042221896703098726888470e-02 + \
                x3 * x4 * x6 * 1.2811935665233135928087194e-02 + \
                x3 * x4 * x5 * -1.5560211153502492842370941e-02 + \
                x3 * x4_2 * 1.1160756154298262510238260e-02 + \
                x3_2 * 1.2127637452397888040422913e-01 + \
                x3_2 * x7 * -1.5757774871013534301322778e-02 + \
                x3_2 * x6 * -3.2280961905425134550462474e-02 + \
                x3_2 * x5 * 3.3005478885947264755529318e-03 + \
                x3_2 * x4 * 2.3891587390805234247803668e-02 + \
                x3_3 * 1.4004412839364257722940543e-02 + \
                x2 * -9.4344530990587005536696097e-01 + \
                x2 * x7 * -4.2728419486297783413952800e-02 + \
                x2 * x7_2 * 2.9578108918182667574914291e-03 + \
                x2 * x6 * -3.8091033412993580142824612e-03 + \
                x2 * x6 * x7 * -1.1683694425158657956287378e-03 + \
                x2 * x6_2 * 8.2892046068363742228335411e-04 + \
                x2 * x5 * -6.2086507291720480217200873e-02 + \
                x2 * x5 * x7 * 7.0098341473762426634408484e-03 + \
                x2 * x5 * x6 * -8.1513296409299034611661838e-03 + \
                x2 * x5_2 * 3.8806597873249901176073706e-02 + \
                x2 * x4 * -3.3800510284469245658733882e-02 + \
                x2 * x4 * x7 * -1.3906086782485437350342927e-02 + \
                x2 * x4 * x6 * -1.8268118993196604676887418e-02 + \
                x2 * x4 * x5 * 3.4055512242828600566468822e-02 + \
                x2 * x4_2 * 5.7968528954691640048269008e-03 + \
                x2 * x3 * 2.5858707365350114271151938e-01 + \
                x2 * x3 * x7 * -3.1974805270086267827700510e-03 + \
                x2 * x3 * x6 * 1.6485051082329629790201864e-02 + \
                x2 * x3 * x5 * -3.5571516712500687862341664e-02 + \
                x2 * x3 * x4 * 1.7144801474087430215309524e-02 + \
                x2 * x3_2 * -1.1683578997879294492090452e-01 + \
                x2_2 * 1.6315611395763416346937902e+00 + \
                x2_2 * x7 * 3.0659738015480220152397806e-04 + \
                x2_2 * x6 * 1.4472247180283864809169359e-02 + \
                x2_2 * x5 * 1.0989586063350986755438043e-02 + \
                x2_2 * x4 * 5.3968151005787043383854495e-03 + \
                x2_2 * x3 * -8.1651669016050823501906564e-02 + \
                x2_3 * -4.5886848573386490590664266e-01 + \
                x1 * -4.3927198545262235995778610e-01 + \
                x1 * x7 * -3.2634296551229055594056661e-02 + \
                x1 * x7_2 * -2.8585070241548382607987833e-02 + \
                x1 * x6 * 2.1571022877756251823200273e-02 + \
                x1 * x6 * x7 * -4.8332790389463697877658888e-03 + \
                x1 * x6_2 * 1.1289066367950181118962050e-02 + \
                x1 * x5 * -8.8721711311715495407170806e-02 + \
                x1 * x5 * x7 * 1.4005430508286969074061012e-02 + \
                x1 * x5 * x6 * 3.1334112501043044629600587e-03 + \
                x1 * x5_2 * 2.0295189360378496079562183e-02 + \
                x1 * x4 * -3.4765196128586695056839062e-02 + \
                x1 * x4 * x7 * -7.6940391978128838679218404e-03 + \
                x1 * x4 * x6 * -3.9704884002131624054499071e-03 + \
                x1 * x4 * x5 * 3.8040067843336328179404404e-02 + \
                x1 * x4_2 * 5.8587774864543983727172005e-03 + \
                x1 * x3 * 1.1926650283145773245863097e-01 + \
                x1 * x3 * x7 * -2.2822034695131918763388867e-02 + \
                x1 * x3 * x6 * -1.0405190485160135949183058e-02 + \
                x1 * x3 * x5 * -1.9932825887289930266721427e-02 + \
                x1 * x3 * x4 * 6.6337274440326516461441386e-03 + \
                x1 * x3_2 * -4.9411966141217816828046239e-02 + \
                x1 * x2 * 1.9546449808262624792121187e+00 + \
                x1 * x2 * x7 * 2.7453201149665568125968207e-02 + \
                x1 * x2 * x6 * -7.9820811748857883882735109e-03 + \
                x1 * x2 * x5 * 2.6592909123096558632326492e-02 + \
                x1 * x2 * x4 * 1.5803667293177406372173266e-02 + \
                x1 * x2 * x3 * -9.2359717273411717775033480e-02 + \
                x1 * x2_2 * -9.8080990803718237636132926e-01 + \
                x1_2 * 3.6613498630444052395205290e-01 + \
                x1_2 * x7 * 3.3783642766186450234755512e-02 + \
                x1_2 * x6 * -1.4346277059808565379483980e-02 + \
                x1_2 * x5 * 3.5309783586852480641304908e-02 + \
                x1_2 * x4 * 1.0303758910131518428121566e-02 + \
                x1_2 * x3 * 1.1990465835381037412732397e-02 + \
                x1_2 * x2 * -4.1671835122424361053106168e-01 + \
                x1_3 * -2.5632926350107249069409932e-02 + \
                x0 * -1.0138054830587145405118576e-01 + \
                x0 * x7 * 5.4381860298966910871598657e-02 + \
                x0 * x7_2 * -3.4195877333000751496783209e-02 + \
                x0 * x6 * -1.8065891301896438991825278e-02 + \
                x0 * x6 * x7 * -5.9384355752077275236722187e-03 + \
                x0 * x6_2 * 1.3038936180058691149952210e-03 + \
                x0 * x5 * 5.1382866185138015291400393e-02 + \
                x0 * x5 * x7 * -1.1475493718446035107394465e-02 + \
                x0 * x5 * x6 * 2.1105270707749167191646933e-02 + \
                x0 * x5_2 * 2.2766778161258799384469853e-03 + \
                x0 * x4 * 3.9601954466947808519705632e-02 + \
                x0 * x4 * x7 * -1.4420859103949579260728342e-02 + \
                x0 * x4 * x6 * -4.2198751435623661765195180e-02 + \
                x0 * x4 * x5 * 5.8263816917679123186246670e-03 + \
                x0 * x4_2 * 1.3162890338373894882906256e-03 + \
                x0 * x3 * -7.6327569836021416649352034e-02 + \
                x0 * x3 * x7 * -4.2601974672032139057620270e-03 + \
                x0 * x3 * x6 * 6.9520694158502205350913528e-04 + \
                x0 * x3 * x5 * -1.8018549289464343143851721e-02 + \
                x0 * x3 * x4 * -2.1524374284224961906275553e-02 + \
                x0 * x3_2 * -2.4345007147530704771920540e-02 + \
                x0 * x2 * -1.3233855877108685605847427e-01 + \
                x0 * x2 * x7 * 9.5832902860959155721953806e-03 + \
                x0 * x2 * x6 * -7.8441964433427074920857081e-03 + \
                x0 * x2 * x5 * -1.3616601509179725171261310e-02 + \
                x0 * x2 * x4 * -2.5526311321816194666034505e-03 + \
                x0 * x2 * x3 * 1.2127944831233028466499491e-01 + \
                x0 * x2_2 * 9.1437917049285583059869964e-02 + \
                x0 * x1 * -1.2629057154820710895393177e-02 + \
                x0 * x1 * x7 * 5.6471461872099676035374749e-03 + \
                x0 * x1 * x6 * -2.9759823130842064098366961e-03 + \
                x0 * x1 * x5 * -1.3722440660462985329015595e-02 + \
                x0 * x1 * x4 * -2.2308554209055548450679751e-02 + \
                x0 * x1 * x3 * 5.8263349845049515474126878e-02 + \
                x0 * x1 * x2 * 9.2942840713461358226332720e-02 + \
                x0 * x1_2 * 9.7465039273345460690833875e-03 + \
                x0_2 * -3.7841875466814930972780928e-03 + \
                x0_2 * x7 * -9.2289611261871309921822615e-03 + \
                x0_2 * x6 * 3.8237936909226430404196151e-02 + \
                x0_2 * x5 * -3.3994826524863068495374563e-02 + \
                x0_2 * x4 * 7.0524779906994128353403539e-04 + \
                x0_2 * x3 * 4.1759272761191096323685201e-03 + \
                x0_2 * x2 * -1.6082710236348982113518957e-02 + \
                x0_2 * x1 * -3.2582021889351150956137815e-02 + \
                x0_3 * 2.0510623720568950389964158e-02
            output = output * 4.5871452032123403341756784e+02 + -8.1636496559205056655628141e+01
            LOX_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\LOX_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            LOX_Con += output
            return LOX_Con

        def ProductCon1(m):
            return LOX_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.ProductCon1 = Expression(rule=ProductCon1)

        def GAN_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 6.3755145090835130261552877e-01 + \
                x7 * 1.1234568019170663652483988e-02 + \
                x7_2 * -1.2379267970467663917411016e-02 + \
                x7_3 * -3.2381502987338661725402744e-04 + \
                x6 * 7.5203877307864208656695837e-03 + \
                x6 * x7 * -1.2944693312280387484380917e-02 + \
                x6 * x7_2 * 1.4651395025170599328845356e-03 + \
                x6_2 * -1.0185709828660127751476239e-02 + \
                x6_2 * x7 * 5.8238334240254385071322574e-03 + \
                x6_3 * 6.7519778219445464317871597e-03 + \
                x5 * -2.6837401834401725109202630e-02 + \
                x5 * x7 * 7.1945261284749595365184405e-03 + \
                x5 * x7_2 * -6.7978598353758551420256140e-03 + \
                x5 * x6 * 3.9105740960424656416094535e-03 + \
                x5 * x6 * x7 * 1.9974190242044373433394355e-03 + \
                x5 * x6_2 * 7.9358285889351565245419806e-03 + \
                x5_2 * 2.5641246995479829995367993e-02 + \
                x5_2 * x7 * -5.9765313647379900152678545e-03 + \
                x5_2 * x6 * -1.5660600086539862296763914e-02 + \
                x5_3 * 3.6009229954258904771169369e-03 + \
                x4 * 2.7924984284757636832097205e-01 + \
                x4 * x7 * -2.1341845045094613719793841e-02 + \
                x4 * x7_2 * -2.4265763648137830821305272e-04 + \
                x4 * x6 * 9.8190401018826700685337983e-03 + \
                x4 * x6 * x7 * -1.4031847402533326185647411e-03 + \
                x4 * x6_2 * -1.4297262499782180736329629e-02 + \
                x4 * x5 * 1.4834944466109896421546210e-02 + \
                x4 * x5 * x7 * 1.3509125053764935511790846e-02 + \
                x4 * x5 * x6 * 7.7306880999018223743490807e-03 + \
                x4 * x5_2 * -4.2234238854273742358458321e-03 + \
                x4_2 * -1.1474209403857224542910842e-02 + \
                x4_2 * x7 * 8.9635236275223267865541743e-03 + \
                x4_2 * x6 * -1.1835911806540106577800842e-02 + \
                x4_2 * x5 * -4.6955803670630825996656910e-03 + \
                x4_3 * 1.5702062572212537039373359e-02 + \
                x3 * 1.2926342945889490732014337e-01 + \
                x3 * x7 * -1.2849749015237652005616553e-02 + \
                x3 * x7_2 * 1.0838086074330790034569993e-03 + \
                x3 * x6 * -1.9916866858315993016326217e-02 + \
                x3 * x6 * x7 * 5.5208095027026518608614936e-03 + \
                x3 * x6_2 * 8.0790241167166924884934787e-03 + \
                x3 * x5 * -2.0138602120513424131864610e-02 + \
                x3 * x5 * x7 * -2.4054077979063018255523332e-03 + \
                x3 * x5 * x6 * 1.5298046693308781085463011e-03 + \
                x3 * x5_2 * 1.1424609584278315466132625e-03 + \
                x3 * x4 * 2.6202223532037653697113200e-02 + \
                x3 * x4 * x7 * -9.8750676442088958228993079e-03 + \
                x3 * x4 * x6 * -7.2405611801098918034469420e-03 + \
                x3 * x4 * x5 * 8.8497479305146842243345873e-03 + \
                x3 * x4_2 * -5.1877670144425819254152543e-03 + \
                x3_2 * -5.7997152877203618503987315e-02 + \
                x3_2 * x7 * 6.9627798805167225720813562e-03 + \
                x3_2 * x6 * 1.4984410800496759247346645e-02 + \
                x3_2 * x5 * -2.1044152129572474274610272e-03 + \
                x3_2 * x4 * -1.2287935975898410523310389e-02 + \
                x3_3 * -6.2110452552738178166880090e-03 + \
                x2 * 4.5253882173448167769436168e-01 + \
                x2 * x7 * 2.3732193650223290526390940e-02 + \
                x2 * x7_2 * -7.6270389401708951759850663e-04 + \
                x2 * x6 * 4.1589927679668153848169254e-03 + \
                x2 * x6 * x7 * 2.0271982232021752961398375e-04 + \
                x2 * x6_2 * -5.6692634096758981465669081e-04 + \
                x2 * x5 * 3.0226192149414313203870108e-02 + \
                x2 * x5 * x7 * -2.5714122199872527230191110e-03 + \
                x2 * x5 * x6 * 3.8192888531404962926263380e-03 + \
                x2 * x5_2 * -1.9882268539467604084869379e-02 + \
                x2 * x4 * 1.8240959724832146726658522e-02 + \
                x2 * x4 * x7 * 6.7260608873661864581805503e-03 + \
                x2 * x4 * x6 * 9.0304029150732115227562247e-03 + \
                x2 * x4 * x5 * -1.6109782643218314990285478e-02 + \
                x2 * x4_2 * -3.5531851900478077233014318e-03 + \
                x2 * x3 * -1.2407021331723158685811370e-01 + \
                x2 * x3 * x7 * -2.4552903358190936167204654e-05 + \
                x2 * x3 * x6 * -8.3900549219119886779072459e-03 + \
                x2 * x3 * x5 * 1.7989640442530249742070225e-02 + \
                x2 * x3 * x4 * -8.8585810957980525709443143e-03 + \
                x2 * x3_2 * 5.7139189509027403512941845e-02 + \
                x2_2 * -7.9674270543458369786549156e-01 + \
                x2_2 * x7 * -8.3385181067808372690208785e-03 + \
                x2_2 * x6 * -7.5002316968424791177039168e-03 + \
                x2_2 * x5 * -6.0823225835179434151100963e-03 + \
                x2_2 * x4 * -3.1422545533287132846211875e-03 + \
                x2_2 * x3 * 4.0137884830685054138310619e-02 + \
                x2_3 * 2.2962207365012615722932310e-01 + \
                x1 * 2.1187909467433399535174487e-01 + \
                x1 * x7 * 1.8382342826781847278105886e-02 + \
                x1 * x7_2 * 1.3710174818233666904632173e-02 + \
                x1 * x6 * -9.5935101682745466122881339e-03 + \
                x1 * x6 * x7 * 2.2054122950831943350546993e-03 + \
                x1 * x6_2 * -5.7524116847615415493155666e-03 + \
                x1 * x5 * 4.3168343543307396981134616e-02 + \
                x1 * x5 * x7 * -6.3496940849506709747540611e-03 + \
                x1 * x5 * x6 * -8.3090975195767528133083957e-04 + \
                x1 * x5_2 * -9.2170913100100768100553239e-03 + \
                x1 * x4 * 1.7197063039672517287259623e-02 + \
                x1 * x4 * x7 * 3.5211716233678885812352632e-03 + \
                x1 * x4 * x6 * 2.1063972306316538357640056e-03 + \
                x1 * x4 * x5 * -1.8616603873775717375993466e-02 + \
                x1 * x4_2 * -3.2279834474379476109973108e-03 + \
                x1 * x3 * -5.4815406961671392371826528e-02 + \
                x1 * x3 * x7 * 1.0302099982126215749200782e-02 + \
                x1 * x3 * x6 * 4.7554039149233576222464137e-03 + \
                x1 * x3 * x5 * 8.1569761716187884348361337e-03 + \
                x1 * x3 * x4 * -3.2788931491623124481193940e-03 + \
                x1 * x3_2 * 2.4311651834442324360274768e-02 + \
                x1 * x2 * -9.5792317988920594462598501e-01 + \
                x1 * x2 * x7 * -2.2664011581038159826029244e-02 + \
                x1 * x2 * x6 * 2.5974068403220294289079906e-03 + \
                x1 * x2 * x5 * -1.3200143601319096198221104e-02 + \
                x1 * x2 * x4 * -8.3419151262217779152496888e-03 + \
                x1 * x2 * x3 * 4.5451129824341657270636574e-02 + \
                x1 * x2_2 * 4.8822562924816947926842658e-01 + \
                x1_2 * -1.8040329206591054767017113e-01 + \
                x1_2 * x7 * -1.9311992631415069582301314e-02 + \
                x1_2 * x6 * 7.3734100958897513811152180e-03 + \
                x1_2 * x5 * -1.8254046932665461688838349e-02 + \
                x1_2 * x4 * -4.5738644376628291229880396e-03 + \
                x1_2 * x3 * -7.0196391131177402616936334e-03 + \
                x1_2 * x2 * 2.1083338717993205246870048e-01 + \
                x1_3 * 1.3314101932748984014054372e-02 + \
                x0 * -3.3805091014575561203514553e-01 + \
                x0 * x7 * -2.5030922877512434832070198e-02 + \
                x0 * x7_2 * 1.7949869221539651448216190e-02 + \
                x0 * x6 * 8.9681438305120320109153909e-03 + \
                x0 * x6 * x7 * 2.6878538905641662787315838e-03 + \
                x0 * x6_2 * -1.5470779682879055860755813e-03 + \
                x0 * x5 * -2.3359091444861826425416496e-02 + \
                x0 * x5 * x7 * 5.8115591436958477511431909e-03 + \
                x0 * x5 * x6 * -1.0315568159077401211298763e-02 + \
                x0 * x5_2 * -2.7929385114508278875611325e-03 + \
                x0 * x4 * -1.6549496437516707236792257e-02 + \
                x0 * x4 * x7 * 7.4442406009053484552961955e-03 + \
                x0 * x4 * x6 * 2.0127656293393865472030058e-02 + \
                x0 * x4 * x5 * -3.7282213645583907324354556e-03 + \
                x0 * x4_2 * -1.5008356831977989580273469e-03 + \
                x0 * x3 * 3.7302563650326123201317330e-02 + \
                x0 * x3 * x7 * 2.6265649281457898941982698e-03 + \
                x0 * x3 * x6 * -1.8723817373278786591050959e-04 + \
                x0 * x3 * x5 * 8.6581074362604600047621517e-03 + \
                x0 * x3 * x4 * 1.0613780911211935509275150e-02 + \
                x0 * x3_2 * 1.0475814428193329710947701e-02 + \
                x0 * x2 * 6.6983498762389029335118096e-02 + \
                x0 * x2 * x7 * -5.9721054192106871189027473e-03 + \
                x0 * x2 * x6 * 3.9578644429225668527339010e-03 + \
                x0 * x2 * x5 * 5.9579513142787934865118871e-03 + \
                x0 * x2 * x4 * 8.5987319749454386996756483e-04 + \
                x0 * x2 * x3 * -5.8882487077147910303764888e-02 + \
                x0 * x2_2 * -4.5526935018903362528686074e-02 + \
                x0 * x1 * 6.6074192051531893676852292e-03 + \
                x0 * x1 * x7 * -3.7839105349531569968957179e-03 + \
                x0 * x1 * x6 * 1.3616461034811934427413149e-03 + \
                x0 * x1 * x5 * 7.1478366072663026414835130e-03 + \
                x0 * x1 * x4 * 1.0780669112989721414308519e-02 + \
                x0 * x1 * x3 * -2.9293941651224314481893884e-02 + \
                x0 * x1 * x2 * -4.4291905173454132471633216e-02 + \
                x0 * x1_2 * -5.4337423631246745125977782e-03 + \
                x0_2 * 1.2601554620703531162106970e-03 + \
                x0_2 * x7 * 4.6172219185130272678385666e-03 + \
                x0_2 * x6 * -1.7783356783916567239733908e-02 + \
                x0_2 * x5 * 1.6915348202133518445977600e-02 + \
                x0_2 * x4 * -1.0987729329955744916880178e-03 + \
                x0_2 * x3 * -1.2614168632315916895869634e-03 + \
                x0_2 * x2 * 6.5648597316848959770663186e-03 + \
                x0_2 * x1 * 1.6045696018357126499953580e-02 + \
                x0_3 * -9.5533455194525985360032294e-03
            output = output * 1.0382748711513315811316716e+03 + -6.7583653738522593812376726e+02
            GAN_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\GAN_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            GAN_Con += output
            return GAN_Con

        def ProductCon2(m):
            return GAN_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.ProductCon2 = Expression(rule=ProductCon2)

        def GAR_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 2.3968444158530222143355104e-01 + \
                x7 * -9.8341824059091365040075061e-03 + \
                x7_2 * -9.1121494552138096456594951e-02 + \
                x7_3 * 9.8212890340910907749361058e-02 + \
                x6 * 6.8399373203505731133589052e-01 + \
                x6 * x7 * -1.3742973446886863619909036e-01 + \
                x6 * x7_2 * 8.3019099208194974126584498e-02 + \
                x6_2 * -2.9705469924542854398552549e-01 + \
                x6_2 * x7 * 7.3765582655924255561785685e-02 + \
                x6_3 * 6.9124104986942713768627300e-02 + \
                x5 * -3.4077712698407552904811268e-01 + \
                x5 * x7 * 9.3764117603926028232663725e-02 + \
                x5 * x7_2 * 7.8086195626739685060613283e-02 + \
                x5 * x6 * -2.8909984353373163745715146e-02 + \
                x5 * x6 * x7 * -9.9628038510543803774055505e-02 + \
                x5 * x6_2 * -1.4169398878304040323428126e-02 + \
                x5_2 * -2.5596075050805733308578738e-01 + \
                x5_2 * x7 * -2.0917020321071150279479411e-02 + \
                x5_2 * x6 * 1.8310465904860395713882326e-01 + \
                x5_3 * 8.8467488450556297507887393e-02 + \
                x4 * 5.3640620746601697099720241e-02 + \
                x4 * x7 * 4.2322513772822561994857438e-02 + \
                x4 * x7_2 * -2.5828519650953285502481549e-02 + \
                x4 * x6 * -1.7626610421315114241025412e-01 + \
                x4 * x6 * x7 * -2.4895223932409296652146224e-02 + \
                x4 * x6_2 * 7.9477085570684488646797661e-02 + \
                x4 * x5 * 2.2363358579532349734719787e-01 + \
                x4 * x5 * x7 * -6.8939120709503032280451862e-02 + \
                x4 * x5 * x6 * -4.4362969387093525996945687e-02 + \
                x4 * x5_2 * 2.1025317416916156076922562e-03 + \
                x4_2 * 1.7598956913133287360828660e-01 + \
                x4_2 * x7 * 4.1988019880227767099967195e-04 + \
                x4_2 * x6 * 1.0075753452496370721203078e-01 + \
                x4_2 * x5 * -7.6886022433915179874475143e-02 + \
                x4_3 * -2.0234528437060173011730058e-01 + \
                x3 * 1.0309099999666543334697622e-01 + \
                x3 * x7 * 3.1948842820269315878611849e-02 + \
                x3 * x7_2 * -2.6318374057636109708546712e-02 + \
                x3 * x6 * -1.2528225435485235150778749e-01 + \
                x3 * x6 * x7 * 2.3431291654095201537622017e-02 + \
                x3 * x6_2 * -1.7987164067510365283997231e-02 + \
                x3 * x5 * 1.2641546806307901729127252e-01 + \
                x3 * x5 * x7 * -4.9331851255252065491241353e-02 + \
                x3 * x5 * x6 * 3.3034326525513524330790460e-02 + \
                x3 * x5_2 * -1.2035755215708651699735299e-01 + \
                x3 * x4 * -1.2077564553995209783998632e-01 + \
                x3 * x4 * x7 * 7.0431464414296623965938693e-02 + \
                x3 * x4 * x6 * 7.9857260208998581685335694e-02 + \
                x3 * x4 * x5 * -1.0237366477456485980290779e-01 + \
                x3 * x4_2 * -1.7882362815356791369003631e-02 + \
                x3_2 * -1.1662916091178469890632385e-01 + \
                x3_2 * x7 * -9.6232641573590245454017378e-03 + \
                x3_2 * x6 * 6.0507863864452088309420219e-02 + \
                x3_2 * x5 * 3.4177419450561394298482298e-02 + \
                x3_2 * x4 * 5.9419336080031984193006167e-02 + \
                x3_3 * -2.1396639790176592843540249e-02 + \
                x2 * -8.6737811816453014301941948e-02 + \
                x2 * x7 * -1.3648401040789459592872390e-03 + \
                x2 * x7_2 * -7.9882590666574576632186222e-02 + \
                x2 * x6 * -1.5741151859556060110811870e-01 + \
                x2 * x6 * x7 * 3.4620823879048662208290921e-02 + \
                x2 * x6_2 * -2.0811311988137015660527140e-03 + \
                x2 * x5 * -1.4910585336513348941878121e-03 + \
                x2 * x5 * x7 * -2.9959903969961371172914255e-02 + \
                x2 * x5 * x6 * -1.0022938533965929097657721e-02 + \
                x2 * x5_2 * 8.8241859919396384293044378e-02 + \
                x2 * x4 * -1.7938662877787958649378197e-01 + \
                x2 * x4 * x7 * 5.7929343611931973304085552e-04 + \
                x2 * x4 * x6 * -2.7628910009132923164543172e-02 + \
                x2 * x4 * x5 * -5.4585130408696211357089112e-02 + \
                x2 * x4_2 * 7.7330958007112413077344115e-02 + \
                x2 * x3 * 2.3867308397231867811427719e-01 + \
                x2 * x3 * x7 * 2.2027721895999934076382232e-02 + \
                x2 * x3 * x6 * 4.3014904632064837608496077e-02 + \
                x2 * x3 * x5 * -7.7798227058441166148483603e-02 + \
                x2 * x3 * x4 * 6.8956080440408254461637227e-02 + \
                x2 * x3_2 * -3.9432096808980909852238028e-03 + \
                x2_2 * 1.2145192729514557861136836e+00 + \
                x2_2 * x7 * 6.1045080471647833464388100e-02 + \
                x2_2 * x6 * 4.0833429490171380127350176e-02 + \
                x2_2 * x5 * 6.5653637063034342435940971e-02 + \
                x2_2 * x4 * 5.2086464712810254251706965e-02 + \
                x2_2 * x3 * -1.8007712829908675833401333e-01 + \
                x2_3 * -7.1332455088379953522803589e-01 + \
                x1 * -2.2302105508745939665971036e-01 + \
                x1 * x7 * -4.6809995529737413733073481e-03 + \
                x1 * x7_2 * 4.5622220391359734337211052e-03 + \
                x1 * x6 * -5.4120639353703731133649057e-02 + \
                x1 * x6 * x7 * -2.7019552982921329897791907e-03 + \
                x1 * x6_2 * 2.4835445110981624328161388e-02 + \
                x1 * x5 * -1.1793359230873629028835126e-02 + \
                x1 * x5 * x7 * -2.3291788583871209095121912e-02 + \
                x1 * x5 * x6 * -6.7524284914852933381368416e-02 + \
                x1 * x5_2 * -4.7776755471734023983376716e-02 + \
                x1 * x4 * -2.7788880594421402903115847e-02 + \
                x1 * x4 * x7 * 2.2830269456218382773116105e-03 + \
                x1 * x4 * x6 * -1.4376735326833027517334784e-02 + \
                x1 * x4 * x5 * 1.4558037970679310602051260e-03 + \
                x1 * x4_2 * 5.9035615639765920414916422e-02 + \
                x1 * x3 * -3.1214188965115588492160725e-02 + \
                x1 * x3 * x7 * -5.6359502645028577982877493e-03 + \
                x1 * x3 * x6 * 2.1867582014112069144218253e-02 + \
                x1 * x3 * x5 * 1.1873746221794413691075221e-01 + \
                x1 * x3 * x4 * 2.1210102590682889528439503e-02 + \
                x1 * x3_2 * 2.6779692196315367513914651e-02 + \
                x1 * x2 * 1.7691543722580009845302129e+00 + \
                x1 * x2 * x7 * -8.7004611716767210616296779e-03 + \
                x1 * x2 * x6 * 1.0293698812300393352625605e-01 + \
                x1 * x2 * x5 * 3.3834694544279980688017417e-02 + \
                x1 * x2 * x4 * 4.9092754875690897131690349e-02 + \
                x1 * x2 * x3 * -2.6264206699499215158510879e-01 + \
                x1 * x2_2 * -1.2877080952569446292699240e+00 + \
                x1_2 * 4.4243285966924866814409256e-01 + \
                x1_2 * x7 * 1.1543829616016342345941048e-02 + \
                x1_2 * x6 * -3.2511496226148711707892858e-02 + \
                x1_2 * x5 * 8.9383068896403905512215715e-02 + \
                x1_2 * x4 * -4.5668700140119977692876319e-02 + \
                x1_2 * x3 * 4.4892696815282781552802760e-02 + \
                x1_2 * x2 * -8.3043370649243997139166140e-01 + \
                x1_3 * -5.4472317222185255569666396e-02 + \
                x0 * 1.4767048396498305695700992e-01 + \
                x0 * x7 * 6.2272959330750839168633348e-02 + \
                x0 * x7_2 * -1.1664828416434054603190162e-01 + \
                x0 * x6 * -5.9549617514631267289892946e-02 + \
                x0 * x6 * x7 * 8.1204868560692741730200339e-03 + \
                x0 * x6_2 * 8.4879795685418105155584101e-02 + \
                x0 * x5 * -1.1564035921547413665599890e-01 + \
                x0 * x5 * x7 * -2.0849705857070854886359257e-02 + \
                x0 * x5 * x6 * 4.2317599845907966082947382e-02 + \
                x0 * x5_2 * 1.3198291922789870400656298e-01 + \
                x0 * x4 * -2.2818301861146353393117181e-01 + \
                x0 * x4 * x7 * -1.4525965852354404128643495e-02 + \
                x0 * x4 * x6 * 3.6783199497466362304365362e-02 + \
                x0 * x4 * x5 * 4.8441990158102798957884261e-02 + \
                x0 * x4_2 * 6.2655203711656892728854018e-02 + \
                x0 * x3 * -7.9975182563253865986041546e-03 + \
                x0 * x3 * x7 * -1.4891433625538914864439022e-02 + \
                x0 * x3 * x6 * -6.2420138604500352563775323e-03 + \
                x0 * x3 * x5 * 1.4729120906843154448218058e-02 + \
                x0 * x3 * x4 * 4.2915912212808798864571713e-03 + \
                x0 * x3_2 * 8.3539171119994815040143976e-02 + \
                x0 * x2 * -3.0713436257462706224785620e-01 + \
                x0 * x2 * x7 * 3.4320196931779158033837263e-02 + \
                x0 * x2 * x6 * -3.4899720421061763975245640e-02 + \
                x0 * x2 * x5 * 3.7888301765484411198769976e-02 + \
                x0 * x2 * x4 * 5.0628421589730340790502794e-02 + \
                x0 * x2 * x3 * -2.8620031738098614115806129e-02 + \
                x0 * x2_2 * 1.5316325785295550887532556e-01 + \
                x0 * x1 * -4.6578001275803485037307894e-02 + \
                x0 * x1 * x7 * 4.9223692149996944866785498e-02 + \
                x0 * x1 * x6 * -9.7499530282739617359499817e-03 + \
                x0 * x1 * x5 * -3.9621527931718837634011976e-02 + \
                x0 * x1 * x4 * -1.4296332857639870717036956e-02 + \
                x0 * x1 * x3 * 3.5220881510627355392983873e-02 + \
                x0 * x1 * x2 * 1.6782797776302222497735173e-02 + \
                x0 * x1_2 * 7.2217965204029038739363955e-02 + \
                x0_2 * -3.0179622376398818062170903e-02 + \
                x0_2 * x7 * -1.2993550945343892988326218e-03 + \
                x0_2 * x6 * -3.4366545007442919623663613e-02 + \
                x0_2 * x5 * -4.1159186717572918134955273e-02 + \
                x0_2 * x4 * 6.6121728696489481813536315e-02 + \
                x0_2 * x3 * -3.5319077304755974733296853e-02 + \
                x0_2 * x2 * 1.2691958688048382564161898e-01 + \
                x0_2 * x1 * -1.9144046147069007646202010e-02 + \
                x0_3 * -1.4821282007385458423520674e-02
            output = output * 1.2211779008263075496643069e+01 + -9.2293260398575895919748291e+00
            GAR_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\GAR_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            GAR_Con += output
            return GAR_Con

        def ProductCon3(m):
            return GAR_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.ProductCon3 = Expression(rule=ProductCon3)

        def MainCoolerTempDiffCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                       vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 1.8991082174024295770031756e-01 + \
                x7 * 6.2846923825426170839847373e-03 + \
                x7_2 * -4.0321991455844591323298687e-01 + \
                x7_3 * 2.8393992351914387750611013e-01 + \
                x6 * 4.5905630471416192239786369e-01 + \
                x6 * x7 * -3.0049449178497622536809786e-01 + \
                x6 * x7_2 * 2.2378966468259145483621353e-01 + \
                x6_2 * -4.5950753859183834926227519e-01 + \
                x6_2 * x7 * 1.2952852912684278963162399e-01 + \
                x6_3 * 1.6345877331246247421425721e-01 + \
                x5 * 2.9263196047866890658895045e-01 + \
                x5 * x7 * 2.5225961724767631544352753e-01 + \
                x5 * x7_2 * 1.8244380480402111466275983e-01 + \
                x5 * x6 * -2.9496486317587988779109764e-01 + \
                x5 * x6 * x7 * -1.5846324718770082862207005e-01 + \
                x5 * x6_2 * -5.2263207376834416861832722e-02 + \
                x5_2 * -6.6386875221092656040866586e-01 + \
                x5_2 * x7 * -1.0059763730211895849109283e-01 + \
                x5_2 * x6 * 3.7998168174159346888174582e-01 + \
                x5_3 * 2.4939180417065631711892593e-01 + \
                x4 * 1.4694425749713430073839504e-01 + \
                x4 * x7 * 1.0161312096234309532150064e-01 + \
                x4 * x7_2 * -2.4759779797255132560707125e-03 + \
                x4 * x6 * -3.4288024477806799961143724e-01 + \
                x4 * x6 * x7 * -6.5174114078887041001664215e-02 + \
                x4 * x6_2 * 2.0282224854696123683694964e-01 + \
                x4 * x5 * 3.0824298037974839914454606e-01 + \
                x4 * x5 * x7 * -1.7799941833994820106212842e-01 + \
                x4 * x5 * x6 * -9.2355846961360621438785756e-02 + \
                x4 * x5_2 * 3.4341784522818885605488504e-03 + \
                x4_2 * 2.6752008213783556866971480e-01 + \
                x4_2 * x7 * -5.3944339112849348794043181e-02 + \
                x4_2 * x6 * 1.9149795843381312021591611e-01 + \
                x4_2 * x5 * -3.7410350076594413304409414e-02 + \
                x4_3 * -3.4513382562613559301212263e-01 + \
                x3 * 1.5952984943983927745847495e-01 + \
                x3 * x7 * 3.2564789383880361761658406e-02 + \
                x3 * x7_2 * 5.5023351940165665663329264e-02 + \
                x3 * x6 * -3.5174763740269981981967362e-01 + \
                x3 * x6 * x7 * 1.0943094389552088241401862e-01 + \
                x3 * x6_2 * -2.8318350979338824391362550e-02 + \
                x3 * x5 * 1.8777067174860623266496873e-01 + \
                x3 * x5 * x7 * -1.6329921539054431667281619e-01 + \
                x3 * x5 * x6 * 1.4336193335165331452785153e-01 + \
                x3 * x5_2 * -2.1533450782438737225454872e-01 + \
                x3 * x4 * -3.5502813458996368423115086e-01 + \
                x3 * x4 * x7 * 1.7037125365809413501949621e-01 + \
                x3 * x4 * x6 * 1.8669156354909224870830542e-01 + \
                x3 * x4 * x5 * -1.4121328536946889387060367e-01 + \
                x3 * x4_2 * 5.6011888754927269262751111e-03 + \
                x3_2 * -4.4165619743144673980950188e-01 + \
                x3_2 * x7 * -8.8746040668225639747035416e-02 + \
                x3_2 * x6 * 1.2082943925635658555250984e-01 + \
                x3_2 * x5 * 6.9664174157404709641916440e-02 + \
                x3_2 * x4 * 1.4974995394385731684039342e-01 + \
                x3_3 * -2.2804432491953746664492542e-01 + \
                x2 * -2.3355497309283834717064110e-01 + \
                x2 * x7 * 1.6641184839721745447604917e-01 + \
                x2 * x7_2 * -1.2079777785067449813460883e-01 + \
                x2 * x6 * 1.0779239929139905473931549e-01 + \
                x2 * x6 * x7 * 3.2248904785861946808989131e-02 + \
                x2 * x6_2 * -3.7065501465351577414786277e-02 + \
                x2 * x5 * -4.2114425499876484426664547e-01 + \
                x2 * x5 * x7 * -7.5204065772063150019377531e-02 + \
                x2 * x5 * x6 * 3.1454839628650949068244813e-02 + \
                x2 * x5_2 * 2.3241857608996585593530426e-01 + \
                x2 * x4 * -2.8788649094165102981790483e-01 + \
                x2 * x4 * x7 * -4.6899328944332629998115181e-02 + \
                x2 * x4 * x6 * -4.2963790488090673747034742e-02 + \
                x2 * x4 * x5 * -1.2204128247478980562323869e-01 + \
                x2 * x4_2 * 1.5439322295944532537070870e-01 + \
                x2 * x3 * 6.4930468880853275948084047e-01 + \
                x2 * x3 * x7 * -2.1459394167860912361334158e-03 + \
                x2 * x3 * x6 * 9.5277151421834210820449584e-02 + \
                x2 * x3 * x5 * -1.5612498733467300437993686e-01 + \
                x2 * x3 * x4 * 1.8468040300534624420514263e-01 + \
                x2 * x3_2 * 3.7914945070461297804698120e-01 + \
                x2_2 * 2.1895212312973977297758665e+00 + \
                x2_2 * x7 * 7.5876530209565418161332673e-03 + \
                x2_2 * x6 * -1.0509523499878589691824970e-01 + \
                x2_2 * x5 * 3.0727643158916828625137896e-01 + \
                x2_2 * x4 * 5.2046123588294829209743853e-02 + \
                x2_2 * x3 * -4.9323926876692009146907480e-01 + \
                x2_3 * -1.2587984200642430288041851e+00 + \
                x1 * -4.8858232071795149042969797e-01 + \
                x1 * x7 * -1.4746222380755402703300661e-03 + \
                x1 * x7_2 * -2.1204198053139278190570849e-02 + \
                x1 * x6 * 1.7281388516910822783501089e-01 + \
                x1 * x6 * x7 * -1.9932666884935168472026135e-02 + \
                x1 * x6_2 * -1.1253556226284556693317818e-02 + \
                x1 * x5 * -1.2912644301899017795776103e-01 + \
                x1 * x5 * x7 * -3.4522457990711963304875098e-02 + \
                x1 * x5 * x6 * -8.5314051222526554596470305e-02 + \
                x1 * x5_2 * -1.2955798320120154309975646e-01 + \
                x1 * x4 * 2.0642087578101486755599581e-02 + \
                x1 * x4 * x7 * 6.9600263055225847219631419e-02 + \
                x1 * x4 * x6 * -9.5031734028418329840448564e-02 + \
                x1 * x4 * x5 * 3.3787686960239662892213630e-02 + \
                x1 * x4_2 * 2.6893288783754215609533844e-02 + \
                x1 * x3 * -1.5804209662964874283375138e-01 + \
                x1 * x3 * x7 * 4.1649778445184124087141697e-02 + \
                x1 * x3 * x6 * 4.7717410849136804307235593e-02 + \
                x1 * x3 * x5 * 2.7931405821208904471930623e-01 + \
                x1 * x3 * x4 * -6.8636904544162644081772839e-02 + \
                x1 * x3_2 * 3.4365973321314735589027123e-01 + \
                x1 * x2 * 3.2411810656894788351678471e+00 + \
                x1 * x2 * x7 * -8.9004490881634951149337098e-03 + \
                x1 * x2 * x6 * 1.9532824898289183335187147e-02 + \
                x1 * x2 * x5 * 1.2059813270789870864874160e-01 + \
                x1 * x2 * x4 * 1.1789906411325323798422460e-01 + \
                x1 * x2 * x3 * -5.8375192372894235681712871e-01 + \
                x1 * x2_2 * -2.4238860322601567531819455e+00 + \
                x1_2 * 1.0136478680440217381431012e+00 + \
                x1_2 * x7 * -1.2743757034447439346891429e-02 + \
                x1_2 * x6 * -1.1299956747186004624161626e-01 + \
                x1_2 * x5 * 1.5246824373110448580526111e-01 + \
                x1_2 * x4 * -7.3816355400148803145299325e-02 + \
                x1_2 * x3 * 1.1148811314062224975263149e-01 + \
                x1_2 * x2 * -1.4817060967657518233409064e+00 + \
                x1_3 * -2.3851578933530576120958244e-01 + \
                x0 * 3.2464003550682396515014716e-01 + \
                x0 * x7 * 2.9445610136429289926951469e-01 + \
                x0 * x7_2 * -3.0413693496059607257464563e-01 + \
                x0 * x6 * -2.0806639709511587366108643e-01 + \
                x0 * x6 * x7 * -1.9396484040443147389698453e-02 + \
                x0 * x6_2 * 1.6703688023907276027912872e-01 + \
                x0 * x5 * -2.1507460447041076845309249e-01 + \
                x0 * x5 * x7 * -7.7351597801763843920141994e-02 + \
                x0 * x5 * x6 * 1.2599976773583079769913695e-01 + \
                x0 * x5_2 * 3.5082893674277526585569831e-01 + \
                x0 * x4 * -5.1836428577026494313173544e-01 + \
                x0 * x4 * x7 * -1.8975911786303298334210865e-02 + \
                x0 * x4 * x6 * 3.9612207537360624720612634e-02 + \
                x0 * x4 * x5 * 9.7046480127332135356965637e-02 + \
                x0 * x4_2 * 1.7619695525151241044525818e-01 + \
                x0 * x3 * 4.0248834524168997095472378e-01 + \
                x0 * x3 * x7 * -3.2351760961407516337118295e-02 + \
                x0 * x3 * x6 * -1.6384314847113501389941348e-03 + \
                x0 * x3 * x5 * -3.2242871732458849853841798e-02 + \
                x0 * x3 * x4 * 3.6542298589857691304416676e-02 + \
                x0 * x3_2 * 1.9436686788700796579831831e-01 + \
                x0 * x2 * -6.1510513231547281343125633e-01 + \
                x0 * x2 * x7 * 2.3280097858895218432273566e-02 + \
                x0 * x2 * x6 * -6.8372261475275655784322737e-02 + \
                x0 * x2 * x5 * 9.3025044225138117659490433e-02 + \
                x0 * x2 * x4 * 4.9726477497251606041395178e-02 + \
                x0 * x2 * x3 * -4.2105856157860094279854479e-01 + \
                x0 * x2_2 * 3.6406009291764901414367728e-01 + \
                x0 * x1 * -2.0577520416965999761060857e-01 + \
                x0 * x1 * x7 * 6.5749466717347271327298586e-02 + \
                x0 * x1 * x6 * -1.5175394218463734985480329e-02 + \
                x0 * x1 * x5 * -7.2160275993006617323288765e-02 + \
                x0 * x1 * x4 * 1.8559610414105115472338525e-02 + \
                x0 * x1 * x3 * -5.8445567873015774607026174e-02 + \
                x0 * x1 * x2 * 5.1648911480383849492703519e-02 + \
                x0 * x1_2 * 1.6267825615119585469514618e-01 + \
                x0_2 * -2.3172253780166929271189247e-01 + \
                x0_2 * x7 * -2.0028563633752802936038862e-02 + \
                x0_2 * x6 * 3.1697264788216300557266436e-02 + \
                x0_2 * x5 * -1.5856799250562633729622064e-01 + \
                x0_2 * x4 * 1.4662370590975021267254874e-01 + \
                x0_2 * x3 * -1.1806655173307281647687716e-01 + \
                x0_2 * x2 * 3.1164071435931756104409374e-01 + \
                x0_2 * x1 * 4.4185505817422511543046681e-02 + \
                x0_3 * 2.6251660354613404191326254e-02
            output = output * 4.0118767613583372622088064e-01 + -7.2020773430278950399952009e-01
            MainCoolerTempDiffCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\MainCoolerTempDiffCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            MainCoolerTempDiffCon += output
            return MainCoolerTempDiffCon

        def TempDiffCon1(m):
            return MainCoolerTempDiffCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                              m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                              m.OxSplitterOutARatio)

        test_model.TempDiffCon1 = Expression(rule=TempDiffCon1)

        def HeatLPCTempDiffCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                    vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 1.2272057499692723414597140e+00 + \
                x7 * 2.0595425194691985293360403e-02 + \
                x7_2 * 2.7629815736865220854312497e-01 + \
                x7_3 * -2.6373653540030667086213612e-01 + \
                x6 * -5.4016340161305631539789829e-01 + \
                x6 * x7 * 3.6516736221985934829348253e-01 + \
                x6 * x7_2 * -2.3485091840104405092048978e-01 + \
                x6_2 * 5.3697365735356983318382618e-01 + \
                x6_2 * x7 * -1.5888559393787754503435394e-01 + \
                x6_3 * -1.6888203353691833008554113e-01 + \
                x5 * -1.9074212802487477969037855e-01 + \
                x5 * x7 * -2.7372668958132517769143988e-01 + \
                x5 * x7_2 * -2.1365316453803129270738737e-01 + \
                x5 * x6 * 3.0076540402230522719406736e-01 + \
                x5 * x6 * x7 * 2.2786291675434505732411594e-01 + \
                x5 * x6_2 * 3.3926600427102333867868111e-02 + \
                x5_2 * 6.6219102758107650785746046e-01 + \
                x5_2 * x7 * 8.4795961677379183552005770e-02 + \
                x5_2 * x6 * -4.6748579717353833107296168e-01 + \
                x5_3 * -2.4285625981531111516886767e-01 + \
                x4 * -1.5170390543878164990587720e-01 + \
                x4 * x7 * -1.0400606364509062951029250e-01 + \
                x4 * x7_2 * 5.5658316349003478240575760e-02 + \
                x4 * x6 * 4.1925148691133545808540362e-01 + \
                x4 * x6 * x7 * 6.3708069289500762755196206e-02 + \
                x4 * x6_2 * -2.2385739859402267737387149e-01 + \
                x4 * x5 * -4.8128667723080859053297331e-01 + \
                x4 * x5 * x7 * 2.0409109947029621667802246e-01 + \
                x4 * x5 * x6 * 1.1074039106071131843833655e-01 + \
                x4 * x5_2 * -1.4375837680295600051749716e-02 + \
                x4_2 * -4.3083817656126544015648960e-01 + \
                x4_2 * x7 * 1.2304883192829213500729679e-02 + \
                x4_2 * x6 * -2.2395751021149437609558674e-01 + \
                x4_2 * x5 * 1.2109141270579043547783726e-01 + \
                x4_3 * 5.1040117031480480846994396e-01 + \
                x3 * -2.4271616549750921199013476e-01 + \
                x3 * x7 * -8.5638146913322860109829548e-02 + \
                x3 * x7_2 * 3.5624624962282552820269643e-02 + \
                x3 * x6 * 3.4299195346372585158079005e-01 + \
                x3 * x6 * x7 * -8.5396740741615573266898309e-02 + \
                x3 * x6_2 * 3.9917637709651163091528758e-02 + \
                x3 * x5 * -3.0645281555177894539099270e-01 + \
                x3 * x5 * x7 * 1.6360954369802024888080894e-01 + \
                x3 * x5 * x6 * -9.9656158804133254669466169e-02 + \
                x3 * x5_2 * 3.0002781502543163227869627e-01 + \
                x3 * x4 * 3.3958071922878163562131704e-01 + \
                x3 * x4 * x7 * -2.0565421404433498198116581e-01 + \
                x3 * x4 * x6 * -2.0416762298596319302745883e-01 + \
                x3 * x4 * x5 * 2.4070178389329424661902124e-01 + \
                x3 * x4_2 * 3.7840015553204403575549009e-02 + \
                x3_2 * 2.7862773590568845616388671e-01 + \
                x3_2 * x7 * 4.6347015131955465738755606e-02 + \
                x3_2 * x6 * -1.6031465883291298735180419e-01 + \
                x3_2 * x5 * -1.0316758983537724359003107e-01 + \
                x3_2 * x4 * -1.6329536590379373217629677e-01 + \
                x3_3 * 8.8345813564898817427106792e-02 + \
                x2 * 3.0063265200535549404037283e-01 + \
                x2 * x7 * -4.8328262221273288190559470e-03 + \
                x2 * x7_2 * 1.8458792435823523359061937e-01 + \
                x2 * x6 * -7.7900044661284306712900616e-02 + \
                x2 * x6 * x7 * -8.2088049484571573577440518e-02 + \
                x2 * x6_2 * 5.3696941448772905758346496e-02 + \
                x2 * x5 * 4.2737786549164435978553911e-01 + \
                x2 * x5 * x7 * 6.4912210103756168289024231e-02 + \
                x2 * x5 * x6 * -2.8343826075261049912690225e-02 + \
                x2 * x5_2 * -2.2693174208629771082534887e-01 + \
                x2 * x4 * 4.2005556553470629888025201e-01 + \
                x2 * x4 * x7 * 5.1574695872203743518547014e-03 + \
                x2 * x4 * x6 * 7.6348913296641868209135851e-02 + \
                x2 * x4 * x5 * 1.4799613264331940021278911e-01 + \
                x2 * x4_2 * -1.9427586086937320697387577e-01 + \
                x2 * x3 * -6.3338584794860741666866488e-01 + \
                x2 * x3 * x7 * -3.1471993720073934697190055e-02 + \
                x2 * x3 * x6 * -9.2867745645086874350937478e-02 + \
                x2 * x3 * x5 * 2.0188516101121134482809794e-01 + \
                x2 * x3 * x4 * -1.8609999161003371037637066e-01 + \
                x2 * x3_2 * -6.1663266203924003983072311e-03 + \
                x2_2 * -3.2162767823613416240391416e+00 + \
                x2_2 * x7 * -1.4443165949647704393576930e-01 + \
                x2_2 * x6 * 7.0490766525955539378855974e-02 + \
                x2_2 * x5 * -3.3578675815897990331038159e-01 + \
                x2_2 * x4 * -1.1735429371964875566725084e-01 + \
                x2_2 * x3 * 4.8789754813538177558029929e-01 + \
                x2_3 * 1.8570180663970896617342987e+00 + \
                x1 * 5.7523372692674590300754289e-01 + \
                x1 * x7 * 1.0559909160439251429863816e-02 + \
                x1 * x7_2 * 1.0233949485802473766682397e-02 + \
                x1 * x6 * -7.8047938018586171526891349e-02 + \
                x1 * x6 * x7 * 3.6694147938121091101493221e-03 + \
                x1 * x6_2 * -1.1077179975527630395593093e-02 + \
                x1 * x5 * 1.8456760578534447958531928e-01 + \
                x1 * x5 * x7 * 6.4768709421972964213054524e-02 + \
                x1 * x5 * x6 * 1.4622764386462649977005412e-01 + \
                x1 * x5_2 * 1.3391423898915899570738475e-01 + \
                x1 * x4 * 7.8061173792546845184858739e-02 + \
                x1 * x4 * x7 * -3.0081407678128141425233366e-02 + \
                x1 * x4 * x6 * 4.7536617780843753999775458e-02 + \
                x1 * x4 * x5 * -1.9050330352714126003199624e-02 + \
                x1 * x4_2 * -1.3841247965339564807152328e-01 + \
                x1 * x3 * 1.5411942119197699629928877e-01 + \
                x1 * x3 * x7 * -3.4883351432341003217629805e-03 + \
                x1 * x3 * x6 * -5.3540487321067864456836105e-02 + \
                x1 * x3 * x5 * -3.1242574393567040802466295e-01 + \
                x1 * x3 * x4 * -3.1872850255639038896671167e-02 + \
                x1 * x3_2 * -8.8846002839388760197181227e-02 + \
                x1 * x2 * -4.6993515034376756034362188e+00 + \
                x1 * x2 * x7 * 9.3617691497342447881635508e-03 + \
                x1 * x2 * x6 * -7.5416417627945375734555000e-02 + \
                x1 * x2 * x5 * -2.2696428886613531639149244e-01 + \
                x1 * x2 * x4 * -1.1264468222334816926988310e-01 + \
                x1 * x2 * x3 * 6.6595405275243002574114826e-01 + \
                x1 * x2_2 * 3.4214529871794767679205052e+00 + \
                x1_2 * -1.1745304749367755370315081e+00 + \
                x1_2 * x7 * -2.4093180498069480255374231e-02 + \
                x1_2 * x6 * 7.1063367285820869256873777e-02 + \
                x1_2 * x5 * -2.2057605478068745274988771e-01 + \
                x1_2 * x4 * 9.8902407403498718285739244e-02 + \
                x1_2 * x3 * -1.4727524708558167865213306e-01 + \
                x1_2 * x2 * 2.1768799956424760289053211e+00 + \
                x1_3 * 1.7413145516058636808054416e-01 + \
                x0 * -4.0861908922116491060805288e-01 + \
                x0 * x7 * -2.0053514640735503604673795e-01 + \
                x0 * x7_2 * 3.2023496460368727767331620e-01 + \
                x0 * x6 * 1.7770722332620361716415402e-01 + \
                x0 * x6 * x7 * -1.6716241568997359384640689e-02 + \
                x0 * x6_2 * -2.2032375312632554442693333e-01 + \
                x0 * x5 * 2.8888590783168766051858256e-01 + \
                x0 * x5 * x7 * 6.1881221813246095608818109e-02 + \
                x0 * x5 * x6 * -1.3560482660014586131502767e-01 + \
                x0 * x5_2 * -3.3858272990188609252726337e-01 + \
                x0 * x4 * 5.9724723997189599344892486e-01 + \
                x0 * x4 * x7 * 3.5520433986809124560224404e-02 + \
                x0 * x4 * x6 * -7.0600310629067186685148272e-02 + \
                x0 * x4 * x5 * -1.3484946525112426196635340e-01 + \
                x0 * x4_2 * -1.7770326011428344559206494e-01 + \
                x0 * x3 * -2.5628461434960836395902106e-02 + \
                x0 * x3 * x7 * 5.2887567273803642864393737e-02 + \
                x0 * x3 * x6 * -8.4037835058750898209467550e-03 + \
                x0 * x3 * x5 * -1.8367543990003218357109915e-03 + \
                x0 * x3 * x4 * -5.0070939294460381496776336e-03 + \
                x0 * x3_2 * -2.0213457812476148811597909e-01 + \
                x0 * x2 * 7.6886522525558109730781098e-01 + \
                x0 * x2 * x7 * -7.7370314556073460643403905e-02 + \
                x0 * x2 * x6 * 9.2535126502779410651022829e-02 + \
                x0 * x2 * x5 * -1.0417041034517739162001959e-01 + \
                x0 * x2 * x4 * -1.2688245763135425070444740e-01 + \
                x0 * x2 * x3 * 9.7424362235932399078919275e-02 + \
                x0 * x2_2 * -3.9502300026928660603431354e-01 + \
                x0 * x1 * 1.7893695959476799139942216e-01 + \
                x0 * x1 * x7 * -1.1914025916952594719155911e-01 + \
                x0 * x1 * x6 * 2.3295650728027215980997511e-02 + \
                x0 * x1 * x5 * 1.0289196910675306451121713e-01 + \
                x0 * x1 * x4 * 2.5438681155977610481855322e-02 + \
                x0 * x1 * x3 * -1.0555612067318000113491649e-01 + \
                x0 * x1 * x2 * -4.1328629970962392492506154e-02 + \
                x0 * x1_2 * -2.0497949104988183455233752e-01 + \
                x0_2 * 1.1606622496553475887282048e-01 + \
                x0_2 * x7 * -1.8640616037671475790915565e-03 + \
                x0_2 * x6 * 7.6387166942255557700036661e-02 + \
                x0_2 * x5 * 1.0437531100002772621593294e-01 + \
                x0_2 * x4 * -1.6763085640030581102699614e-01 + \
                x0_2 * x3 * 8.4512971164064587537012585e-02 + \
                x0_2 * x2 * -3.2781034528433083963250283e-01 + \
                x0_2 * x1 * 1.5386854670938920897071966e-02 + \
                x0_3 * 3.6636000124191214766256053e-02
            output = output * 1.3999397989211104231799254e+01 + -5.9188525989542881688976195e+00
            HeatLPCTempDiffCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\HeatLPCTempDiffCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            HeatLPCTempDiffCon += output
            return HeatLPCTempDiffCon

        def TempDiffCon2(m):
            return HeatLPCTempDiffCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                           m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                           m.OxSplitterOutARatio)

        test_model.TempDiffCon2 = Expression(rule=TempDiffCon2)

        def HPA_GOX_LB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 3.9415699579759938542267150e-01 + \
                x7 * -1.2260367980182680647249782e-01 + \
                x7_2 * 3.9079786159118529154099519e-02 + \
                x7_3 * -9.7951978601758804554577864e-03 + \
                x6 * -4.2731808735897436335449129e-02 + \
                x6 * x7 * 3.6256207338987621324744026e-02 + \
                x6 * x7_2 * -1.0536891839231787848518707e-02 + \
                x6_2 * 3.8704804093648736973420910e-02 + \
                x6_2 * x7 * -1.5807154138600364168265600e-02 + \
                x6_3 * -2.0426098068052594980414938e-02 + \
                x5 * 5.6234317052343246734480431e-02 + \
                x5 * x7 * -2.0795489256934786281849625e-02 + \
                x5 * x7_2 * 8.9401910792246755410594972e-03 + \
                x5 * x6 * -9.0418988874264860644558439e-04 + \
                x5 * x6 * x7 * 2.2615427517348393737783852e-03 + \
                x5 * x6_2 * -1.4123063831130069217811851e-02 + \
                x5_2 * -3.0576346405458448840519736e-02 + \
                x5_2 * x7 * 1.4569851845666309531068805e-02 + \
                x5_2 * x6 * 1.8702119012211443349613660e-02 + \
                x5_3 * -1.5439450851153418975414411e-02 + \
                x4 * 1.3425859246653884873645701e-02 + \
                x4 * x7 * 4.2343615212159430027938356e-02 + \
                x4 * x7_2 * 1.5288510913350934761201216e-03 + \
                x4 * x6 * -5.6550302099318480730794079e-03 + \
                x4 * x6 * x7 * 4.9127136431121321002990499e-03 + \
                x4 * x6_2 * 2.3119786278430767834102255e-02 + \
                x4 * x5 * -4.4930738155957196389156394e-02 + \
                x4 * x5 * x7 * -2.1679979223118157893868130e-02 + \
                x4 * x5 * x6 * -1.2313454201240484064960867e-02 + \
                x4 * x5_2 * 9.4495460685417864699076063e-03 + \
                x4_2 * 1.4041358894402410084634170e-02 + \
                x4_2 * x7 * -1.8922446848824048259984920e-02 + \
                x4_2 * x6 * 1.5540097572025183408905846e-02 + \
                x4_2 * x5 * 1.3154779386911376326541046e-02 + \
                x4_3 * -1.8728563429216228686247092e-02 + \
                x3 * -8.0207550201624927543875287e-02 + \
                x3 * x7 * 1.5763803493137190647743751e-02 + \
                x3 * x7_2 * -3.3835142794583989225842835e-03 + \
                x3 * x6 * 5.2277449414147025841259619e-02 + \
                x3 * x6 * x7 * -1.5322682811204840075403055e-02 + \
                x3 * x6_2 * -1.4338161437655212726571818e-02 + \
                x3 * x5 * 3.6120899967581873712951790e-02 + \
                x3 * x5 * x7 * 8.8118400659387870199612536e-03 + \
                x3 * x5 * x6 * -7.1329273439130758127646459e-03 + \
                x3 * x5_2 * 5.8232016481389176076888248e-03 + \
                x3 * x4 * -4.0455630457339880612366301e-02 + \
                x3 * x4 * x7 * 1.4165535433038344698131183e-02 + \
                x3 * x4 * x6 * 7.4976817533995571141147707e-03 + \
                x3 * x4 * x5 * -1.3094711943432119083396969e-02 + \
                x3 * x4_2 * 1.0407435312810561778285035e-02 + \
                x3_2 * 1.2251691945576279052509960e-01 + \
                x3_2 * x7 * -9.1986691349549461194090583e-03 + \
                x3_2 * x6 * -3.5422997986595955444144579e-02 + \
                x3_2 * x5 * 1.0589854979882046270844853e-03 + \
                x3_2 * x4 * 2.0636738884235606567019161e-02 + \
                x3_3 * 2.1699850663973604958378871e-02 + \
                x2 * -1.0197404712462523335148035e+00 + \
                x2 * x7 * -6.3338775834227867278514168e-02 + \
                x2 * x7_2 * 6.6736013828643282741470699e-03 + \
                x2 * x6 * -6.0119945749089187536640111e-03 + \
                x2 * x6 * x7 * -2.0183145441663398120257789e-03 + \
                x2 * x6_2 * 2.2454898317663778140040876e-03 + \
                x2 * x5 * -5.4547814416569959106162457e-02 + \
                x2 * x5 * x7 * 5.6744195216598021513920713e-03 + \
                x2 * x5 * x6 * -7.9014375661416239027268205e-03 + \
                x2 * x5_2 * 3.3158332443612048567871398e-02 + \
                x2 * x4 * -2.9192333467466788365918262e-02 + \
                x2 * x4 * x7 * -1.2487195010925192587003529e-02 + \
                x2 * x4 * x6 * -1.7131709206770023151689131e-02 + \
                x2 * x4 * x5 * 3.6984138748070639890475064e-02 + \
                x2 * x4_2 * 1.3616614582067513086749422e-03 + \
                x2 * x3 * 2.4388050927719640004198709e-01 + \
                x2 * x3 * x7 * 3.7148042445251314158660705e-03 + \
                x2 * x3 * x6 * 1.3859804254216526175902402e-02 + \
                x2 * x3 * x5 * -3.1954143957300153167100376e-02 + \
                x2 * x3 * x4 * 1.1824428456681617544132834e-02 + \
                x2 * x3_2 * -1.2108720456475605131707596e-01 + \
                x2_2 * 1.5495719858934042800768793e+00 + \
                x2_2 * x7 * 4.4714896205099712023223191e-02 + \
                x2_2 * x6 * 1.6047458648300868405689457e-02 + \
                x2_2 * x5 * 5.2220243676021696477285161e-03 + \
                x2_2 * x4 * 8.3830929659770708761712399e-03 + \
                x2_2 * x3 * -7.0742381536123860596987356e-02 + \
                x2_3 * -4.3849311966917187133319089e-01 + \
                x1 * -3.4470908058338234347672824e-01 + \
                x1 * x7 * -4.5397485602841625151881999e-02 + \
                x1 * x7_2 * -2.8416579277943519732385624e-02 + \
                x1 * x6 * 1.7230800790657557763907448e-02 + \
                x1 * x6 * x7 * -4.0077527306515009497545066e-03 + \
                x1 * x6_2 * 1.1130720366298842149976878e-02 + \
                x1 * x5 * -8.5995383584660495257523394e-02 + \
                x1 * x5 * x7 * 1.3189438411238905285438605e-02 + \
                x1 * x5 * x6 * 5.0723012127345222521679347e-03 + \
                x1 * x5_2 * 2.2498008182153875211817251e-02 + \
                x1 * x4 * -3.6335159436521990983237629e-02 + \
                x1 * x4 * x7 * -8.3602690356357270418108385e-03 + \
                x1 * x4 * x6 * -2.5559742413048952558440874e-03 + \
                x1 * x4 * x5 * 3.7426450471851099854880829e-02 + \
                x1 * x4_2 * 3.2352473213656373490776375e-03 + \
                x1 * x3 * 1.2205508501826738132489680e-01 + \
                x1 * x3 * x7 * -1.9470043246541710035835138e-02 + \
                x1 * x3 * x6 * -1.1582294453096400599356741e-02 + \
                x1 * x3 * x5 * -2.7021527933909425533975934e-02 + \
                x1 * x3 * x4 * 7.8050944525254678865722191e-03 + \
                x1 * x3_2 * -5.5470107989612549292957056e-02 + \
                x1 * x2 * 1.8401801131791504229084921e+00 + \
                x1 * x2 * x7 * 8.3929581753104470775994628e-02 + \
                x1 * x2 * x6 * -8.7293766189425019141889805e-03 + \
                x1 * x2 * x5 * 2.5521822211949415915022144e-02 + \
                x1 * x2 * x4 * 1.9098300500126064171979579e-02 + \
                x1 * x2 * x3 * -7.6788114742119703559630750e-02 + \
                x1 * x2_2 * -9.4119859140015016407687654e-01 + \
                x1_2 * 3.3282060300894239501801053e-01 + \
                x1_2 * x7 * 5.0849604536997571047063360e-02 + \
                x1_2 * x6 * -1.0677838376914529361361161e-02 + \
                x1_2 * x5 * 3.2883831568155885705095898e-02 + \
                x1_2 * x4 * 1.3998838945864490457271501e-02 + \
                x1_2 * x3 * 1.0124470007447421149304745e-02 + \
                x1_2 * x2 * -3.9375174026748416267196262e-01 + \
                x1_3 * -2.3958829348036753126294229e-02 + \
                x0 * -1.8357985078110988785837776e-01 + \
                x0 * x7 * 3.4879164716345952002019004e-02 + \
                x0 * x7_2 * -2.7222834399854130282836451e-02 + \
                x0 * x6 * -1.0449850115819114826365421e-02 + \
                x0 * x6 * x7 * -4.5661916800181414494153032e-03 + \
                x0 * x6_2 * -2.9055738819756139063033018e-03 + \
                x0 * x5 * 5.5385400888523950158059961e-02 + \
                x0 * x5 * x7 * -1.0291581199278622416048989e-02 + \
                x0 * x5 * x6 * 1.6061656781146606276511335e-02 + \
                x0 * x5_2 * -5.5257631120673028624068479e-03 + \
                x0 * x4 * 5.2107630452657614783529283e-02 + \
                x0 * x4 * x7 * -1.5671108056943879732747504e-02 + \
                x0 * x4 * x6 * -4.3025373593001306482541679e-02 + \
                x0 * x4 * x5 * 4.6165801479269574780772700e-03 + \
                x0 * x4_2 * -1.5171713625902125133215748e-03 + \
                x0 * x3 * -7.5242233460807425582395069e-02 + \
                x0 * x3 * x7 * -6.1975139746852786482023134e-03 + \
                x0 * x3 * x6 * 6.0969980186503097696615328e-04 + \
                x0 * x3 * x5 * -1.7363402348563504451472994e-02 + \
                x0 * x3 * x4 * -2.4452677093323466062102511e-02 + \
                x0 * x3_2 * -3.0592361654941682691521976e-02 + \
                x0 * x2 * -1.2920823537726150442850326e-01 + \
                x0 * x2 * x7 * 1.4920140570596800849711983e-02 + \
                x0 * x2 * x6 * -5.5867497229340409847786475e-03 + \
                x0 * x2 * x5 * -1.4646602556982184217826415e-02 + \
                x0 * x2 * x4 * -4.6091324352452514578892817e-03 + \
                x0 * x2 * x3 * 1.2708146580236417966247586e-01 + \
                x0 * x2_2 * 7.7624751371032210678357899e-02 + \
                x0 * x1 * -2.8498918878311074731612962e-03 + \
                x0 * x1 * x7 * 6.6577002758044330141262712e-03 + \
                x0 * x1 * x6 * -2.3179882541909946347402638e-03 + \
                x0 * x1 * x5 * -1.2185987631519418911141273e-02 + \
                x0 * x1 * x4 * -2.1970096521239039499828749e-02 + \
                x0 * x1 * x3 * 5.7272840458654779294267456e-02 + \
                x0 * x1 * x2 * 8.4934293443422334557446618e-02 + \
                x0 * x1_2 * 4.8922763970247005321789757e-03 + \
                x0_2 * 5.3452513803698142869080812e-03 + \
                x0_2 * x7 * -8.7722203647966484618692107e-03 + \
                x0_2 * x6 * 3.5370863639363002428606109e-02 + \
                x0_2 * x5 * -2.9394981793574428974302748e-02 + \
                x0_2 * x4 * -2.9772752121147161297187722e-03 + \
                x0_2 * x3 * 5.4249207487783931980196428e-03 + \
                x0_2 * x2 * -2.3587024793165725644605857e-02 + \
                x0_2 * x1 * -3.2437846746018010601897430e-02 + \
                x0_3 * 1.7996654145878879238473758e-02
            output = output * 2.5573374404253655711727333e+02 + -4.4793120182348150137841003e+02
            HPA_GOX_LB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\HPA_GOX_LB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            HPA_GOX_LB_Con += output
            return HPA_GOX_LB_Con

        def TurbineCon1(m):
            return HPA_GOX_LB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                       m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                       m.OxSplitterOutARatio)

        test_model.TurbineCon1 = Expression(rule=TurbineCon1)

        def HPA_GOX_UB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 3.8288564433786570484485878e-01 + \
                x7 * 3.0852917938526680519117917e-01 + \
                x7_2 * -2.7578085883521584464883603e-02 + \
                x7_3 * 1.8234648731172253821597451e-02 + \
                x6 * 2.4132666343590378904560012e-02 + \
                x6 * x7 * -1.5802463879952884096002919e-02 + \
                x6 * x7_2 * 1.3032230423306413041872887e-02 + \
                x6_2 * -2.3966398852762714477560024e-02 + \
                x6_2 * x7 * 4.2708393856991516690513322e-03 + \
                x6_3 * 1.2268273020447556520551302e-02 + \
                x5 * 8.1070732552345585453235088e-03 + \
                x5 * x7 * 8.8339087781916722508235296e-03 + \
                x5 * x7_2 * 4.1842111910570939370401788e-03 + \
                x5 * x6 * -1.2422628528580462181629684e-02 + \
                x5 * x6 * x7 * -8.2218117042486965617698047e-03 + \
                x5 * x6_2 * -2.6041270234991031884419499e-03 + \
                x5_2 * -2.8354227354299117030977939e-02 + \
                x5_2 * x7 * -4.9419107197063300018768928e-03 + \
                x5_2 * x6 * 1.6789565208489749120746026e-02 + \
                x5_3 * 1.2840634917143829707431024e-02 + \
                x4 * 9.6598856490324215562370824e-03 + \
                x4 * x7 * -5.2128326574085309674799760e-03 + \
                x4 * x7_2 * -8.5695617809875349046855320e-04 + \
                x4 * x6 * -2.0258354981737142219699876e-02 + \
                x4 * x6 * x7 * -3.3153598801574785115420241e-03 + \
                x4 * x6_2 * 6.2629960929095063182359127e-03 + \
                x4 * x5 * 2.4202960946143756149062654e-02 + \
                x4 * x5 * x7 * -6.6115435392535351621923212e-03 + \
                x4 * x5 * x6 * -4.4876381564252151856742046e-03 + \
                x4 * x5_2 * -2.1934793679463659987760593e-03 + \
                x4_2 * 7.9357969618454021060172110e-03 + \
                x4_2 * x7 * 4.0449395192757586769971567e-03 + \
                x4_2 * x6 * 1.2427946466858914853492735e-02 + \
                x4_2 * x5 * -4.8563486815740861471391021e-03 + \
                x4_3 * -1.5710921916832334965796747e-02 + \
                x3 * -3.7340519379283876322261904e-01 + \
                x3 * x7 * 2.8768264182188054561839508e-02 + \
                x3 * x7_2 * 4.2306528743108412840556731e-03 + \
                x3 * x6 * -2.1398164279916722513297245e-02 + \
                x3 * x6 * x7 * 9.3126196352914317189153337e-03 + \
                x3 * x6_2 * -2.9057922020830767584342880e-03 + \
                x3 * x5 * 1.0643025699482860924049987e-03 + \
                x3 * x5 * x7 * -5.5084032841498809657254654e-03 + \
                x3 * x5 * x6 * 6.9762697027359425738790577e-03 + \
                x3 * x5_2 * -1.0815683372421353719561310e-02 + \
                x3 * x4 * -1.8703474617589518902427415e-02 + \
                x3 * x4 * x7 * 8.0618394818779449961798633e-03 + \
                x3 * x4 * x6 * 9.6139385228809163402852178e-03 + \
                x3 * x4 * x5 * -3.4564598463946295640869533e-03 + \
                x3 * x4_2 * 3.8733844603894979075064953e-04 + \
                x3_2 * -1.5216501178882263500824479e-02 + \
                x3_2 * x7 * -1.1871757263007320926107013e-02 + \
                x3_2 * x6 * 9.8447771880990631032659621e-03 + \
                x3_2 * x5 * 4.2747672192733430357458602e-03 + \
                x3_2 * x4 * 4.2134031121344693582297936e-03 + \
                x3_3 * -1.7320334582039631499128518e-02 + \
                x2 * 2.5571191692523720373486640e-01 + \
                x2 * x7 * 4.6933319874511117419935147e-02 + \
                x2 * x7_2 * -7.9661006240764435648582520e-03 + \
                x2 * x6 * 4.9372519789401443646159606e-03 + \
                x2 * x6 * x7 * 1.8734949165520407149410076e-03 + \
                x2 * x6_2 * -3.0057337663635195351696794e-03 + \
                x2 * x5 * -9.0541898420603769692682761e-03 + \
                x2 * x5 * x7 * 2.0202060431297411829953958e-03 + \
                x2 * x5 * x6 * 3.3595096445299468812528687e-04 + \
                x2 * x5_2 * 7.5886715111927113830425640e-03 + \
                x2 * x4 * -5.9678889773631619425353634e-03 + \
                x2 * x4 * x7 * -1.4723321407388925696757553e-03 + \
                x2 * x4 * x6 * -4.3485333241834048592644457e-04 + \
                x2 * x4 * x5 * -9.5902376104465246464680916e-03 + \
                x2 * x4_2 * 8.5347104697687768692926369e-03 + \
                x2 * x3 * 3.3127228880090939244773551e-03 + \
                x2 * x3 * x7 * -1.3910742038198541797866525e-02 + \
                x2 * x3 * x6 * 3.6891165395837068052831142e-03 + \
                x2 * x3 * x5 * -3.7412089409610055010246832e-03 + \
                x2 * x3 * x4 * 9.1742406051271395417412435e-03 + \
                x2 * x3_2 * 2.0957613936182922786954919e-02 + \
                x2_2 * -1.3591024870623497067256835e-03 + \
                x2_2 * x7 * -9.1546640159780465206829092e-02 + \
                x2_2 * x6 * -4.7568832846832873051390322e-03 + \
                x2_2 * x5 * 1.0738330003039010807075471e-02 + \
                x2_2 * x4 * -6.7173613278463314979482846e-03 + \
                x2_2 * x3 * -1.3957752942566511306088373e-02 + \
                x2_3 * 5.9126425512198571565747329e-03 + \
                x1 * -1.4901539552768899854484630e-01 + \
                x1 * x7 * 2.9708503183287722493322036e-02 + \
                x1 * x7_2 * 2.6367770763539048403667486e-03 + \
                x1 * x6 * 6.6923361526102162488705005e-03 + \
                x1 * x6 * x7 * -1.1966616269865060218080544e-03 + \
                x1 * x6_2 * -8.5215337643498520470153323e-04 + \
                x1 * x5 * 3.6433660104447616878697858e-03 + \
                x1 * x5 * x7 * 2.1953298558812926917493957e-04 + \
                x1 * x5 * x6 * -4.3226744738450850052968732e-03 + \
                x1 * x5_2 * -6.6580854079443807513882803e-03 + \
                x1 * x4 * 6.8644492151521867631669416e-03 + \
                x1 * x4 * x7 * 2.1761174423590677606821231e-03 + \
                x1 * x4 * x6 * -2.5004881475354364880892000e-03 + \
                x1 * x4 * x5 * -2.7064877749764784317654254e-03 + \
                x1 * x4_2 * 4.7948557033639233049271411e-03 + \
                x1 * x3 * -1.8196816540136696860319176e-02 + \
                x1 * x3 * x7 * -4.5252415533312238815621953e-03 + \
                x1 * x3 * x6 * 3.5119210871220867681286038e-03 + \
                x1 * x3 * x5 * 1.6688867734617373467242984e-02 + \
                x1 * x3 * x4 * -3.1063955607097022693086075e-03 + \
                x1 * x3_2 * 1.7642463095162083663858255e-02 + \
                x1 * x2 * 3.1838670418110004423084547e-02 + \
                x1 * x2 * x7 * -1.1924983709474830384511534e-01 + \
                x1 * x2 * x6 * 2.3732425194088625081123567e-03 + \
                x1 * x2 * x5 * -5.6878603362061318227116402e-04 + \
                x1 * x2 * x4 * -8.4391775974566110574137667e-03 + \
                x1 * x2 * x3 * -2.2447829866677152660381367e-02 + \
                x1 * x2_2 * 2.0757525903211719586760609e-02 + \
                x1_2 * 3.0431955745107798494419882e-02 + \
                x1_2 * x7 * -3.8695444867048262027608985e-02 + \
                x1_2 * x6 * -6.0621462569687605340118530e-03 + \
                x1_2 * x5 * 1.3133047394942084368230084e-03 + \
                x1_2 * x4 * -8.6902650174747290978682912e-03 + \
                x1_2 * x3 * 2.5936758533395519454867184e-03 + \
                x1_2 * x2 * -3.8273318158539779143545445e-03 + \
                x1_3 * -7.7408277978379888550897192e-04 + \
                x0 * 1.7997575946737445762302343e-01 + \
                x0 * x7 * 3.4513359261923635956659240e-02 + \
                x0 * x7_2 * -1.0800026846271196245830026e-02 + \
                x0 * x6 * -1.3808898236101187217972353e-02 + \
                x0 * x6 * x7 * -2.2079454587053924663475613e-03 + \
                x0 * x6_2 * 8.5385687385524343395726277e-03 + \
                x0 * x5 * -1.3612102173272399088799212e-02 + \
                x0 * x5 * x7 * -1.2418270448189029642183101e-03 + \
                x0 * x5 * x6 * 8.1904744436837161741804536e-03 + \
                x0 * x5_2 * 1.5841258603918349778805208e-02 + \
                x0 * x4 * -2.9905185649464167269018233e-02 + \
                x0 * x4 * x7 * 4.0818506776823526571718048e-03 + \
                x0 * x4 * x6 * 6.1085939430719528309143840e-03 + \
                x0 * x4 * x5 * 1.8848888379297962236691433e-03 + \
                x0 * x4_2 * 5.7016609334987772977898501e-03 + \
                x0 * x3 * 5.7312230075505232740340489e-03 + \
                x0 * x3 * x7 * 4.4370571901676189585650434e-03 + \
                x0 * x3 * x6 * 1.0363662792416301894338204e-04 + \
                x0 * x3 * x5 * 5.3085901443347032271913299e-04 + \
                x0 * x3 * x4 * 8.2814449596821711890859419e-03 + \
                x0 * x3_2 * 1.5415644022636832560779752e-02 + \
                x0 * x2 * 7.3639928805623311447448032e-03 + \
                x0 * x2 * x7 * -1.1998341933338995540792027e-02 + \
                x0 * x2 * x6 * -3.8331894259716631917500607e-03 + \
                x0 * x2 * x5 * 3.5440171964059505316235743e-03 + \
                x0 * x2 * x4 * 4.5044150186260671631099939e-03 + \
                x0 * x2 * x3 * -2.4616900523455033378272816e-02 + \
                x0 * x2_2 * 1.8920348642206541445176526e-02 + \
                x0 * x1 * -1.8834118678681701503085932e-02 + \
                x0 * x1 * x7 * -2.6720102682051653786299283e-03 + \
                x0 * x1 * x6 * -1.0453018864799469567206103e-03 + \
                x0 * x1 * x5 * -1.7337679379467486884269789e-03 + \
                x0 * x1 * x4 * 1.6313116998961547932101013e-03 + \
                x0 * x1 * x3 * -4.0409141514726049093653160e-03 + \
                x0 * x1 * x2 * 6.8013518539136522123023099e-03 + \
                x0 * x1_2 * 8.9859371908587604843576813e-03 + \
                x0_2 * -1.8418507729263514788309308e-02 + \
                x0_2 * x7 * 2.2180409274374923711548035e-05 + \
                x0_2 * x6 * 1.9166777199907860523842018e-03 + \
                x0_2 * x5 * -5.9304339141779127686504580e-03 + \
                x0_2 * x4 * 7.5151577644745719275487517e-03 + \
                x0_2 * x3 * -3.0097949241351413390832548e-03 + \
                x0_2 * x2 * 1.7143429788631085741723581e-02 + \
                x0_2 * x1 * 3.1041278450156094964595965e-03 + \
                x0_3 * 3.0395717965457577647292453e-03
            output = output * 1.2409709761146439177537104e+02 + -5.8989843458467248638044111e+01
            HPA_GOX_UB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\HPA_GOX_UB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            HPA_GOX_UB_Con += output
            return HPA_GOX_UB_Con

        def TurbineCon2(m):
            return HPA_GOX_UB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                       m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                       m.OxSplitterOutARatio)

        test_model.TurbineCon2 = Expression(rule=TurbineCon2)

        def Feed_LB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                             vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 1.0030906879522909491697646e+00 + \
                x7 * -3.3628431447321749381274003e-04 + \
                x7_2 * -1.9712171181235360606365248e-04 + \
                x7_3 * 8.0036496739141482770207858e-05 + \
                x6 * -5.3773505945012289863882415e-04 + \
                x6 * x7 * -8.5298393847216269492150786e-05 + \
                x6 * x7_2 * 4.9805155336453410530594965e-04 + \
                x6_2 * 5.0590526793091450397099607e-04 + \
                x6_2 * x7 * -2.4925963432823744492239371e-04 + \
                x6_3 * -2.1358055926319293761628249e-04 + \
                x5 * -8.4092965139874898544691817e-04 + \
                x5 * x7 * 3.9419890662861778451997452e-04 + \
                x5 * x7_2 * -4.0529817547180213566093698e-05 + \
                x5 * x6 * 4.0549912164478119080968099e-04 + \
                x5 * x6 * x7 * -8.3826860479002673898207831e-05 + \
                x5 * x6_2 * -1.2199354243207227721512709e-04 + \
                x5_2 * 5.3345879773318560790329457e-04 + \
                x5_2 * x7 * -3.7138011164075668268935715e-05 + \
                x5_2 * x6 * 9.8937187596848108483982287e-05 + \
                x5_3 * -2.6301103894540121819201062e-04 + \
                x4 * 4.5661910654429260780773348e-05 + \
                x4 * x7 * -1.8953936013274552685459184e-04 + \
                x4 * x7_2 * 2.2918683001633272100505678e-04 + \
                x4 * x6 * 1.8681330724301670187514901e-04 + \
                x4 * x6 * x7 * -1.4323407568425650104870783e-04 + \
                x4 * x6_2 * 2.3614942388534149175782773e-04 + \
                x4 * x5 * 1.9330570617664966093229850e-04 + \
                x4 * x5 * x7 * 2.9103353791817831996979749e-05 + \
                x4 * x5 * x6 * -1.6924973328738546207716809e-04 + \
                x4 * x5_2 * 2.3190059413377706043490889e-04 + \
                x4_2 * -4.1849449686485800867230544e-04 + \
                x4_2 * x7 * -8.1257250013164195046044824e-05 + \
                x4_2 * x6 * 1.5675113315877231556783045e-05 + \
                x4_2 * x5 * 2.0075316423979680524602998e-04 + \
                x4_3 * 1.5266166025976191100710366e-04 + \
                x3 * -3.5365395217213171918935188e-03 + \
                x3 * x7 * 2.8370098358202616717349542e-04 + \
                x3 * x7_2 * 1.0766495297166028821678196e-04 + \
                x3 * x6 * -1.1105596861079453097076453e-04 + \
                x3 * x6 * x7 * -2.8833764545602852402694793e-05 + \
                x3 * x6_2 * 3.4823269402370696234960690e-04 + \
                x3 * x5 * 3.5258789554137859312277214e-04 + \
                x3 * x5 * x7 * -1.9527853217829460596988156e-04 + \
                x3 * x5 * x6 * 1.9442504140219918351562001e-04 + \
                x3 * x5_2 * 9.2583364818384084049540661e-05 + \
                x3 * x4 * -9.2728048308850230529998271e-05 + \
                x3 * x4 * x7 * -1.4731202250461842336720641e-04 + \
                x3 * x4 * x6 * -3.7984858701177459661124658e-04 + \
                x3 * x4 * x5 * 1.1891042412556090956954336e-04 + \
                x3 * x4_2 * -1.6715596060365781050371936e-04 + \
                x3_2 * -3.0244651298270905370735306e-03 + \
                x3_2 * x7 * 5.2083518939365081035219873e-05 + \
                x3_2 * x6 * -1.0279676298432377512526159e-04 + \
                x3_2 * x5 * -3.2921276688226315532137534e-04 + \
                x3_2 * x4 * 1.9030012223038988983248032e-04 + \
                x3_3 * 6.5450641973070766699294154e-04 + \
                x2 * -6.5424768787541338899149679e-03 + \
                x2 * x7 * 4.8157203077315441364092408e-04 + \
                x2 * x7_2 * -2.2797883756875414462683693e-04 + \
                x2 * x6 * 4.2130352455482106277528942e-04 + \
                x2 * x6 * x7 * 3.4887932570688796538038723e-05 + \
                x2 * x6_2 * -2.0691719473034300008640329e-04 + \
                x2 * x5 * 5.6006448556409921951670938e-04 + \
                x2 * x5 * x7 * -7.0699958639907495294707473e-05 + \
                x2 * x5 * x6 * -4.4093779252061746087854033e-04 + \
                x2 * x5_2 * -2.1654457097956478217604115e-04 + \
                x2 * x4 * 4.8406942366989100245966426e-05 + \
                x2 * x4 * x7 * 1.1227529283411308291817932e-05 + \
                x2 * x4 * x6 * -2.0199591850310338880802874e-04 + \
                x2 * x4 * x5 * -3.2779471417760178142408733e-04 + \
                x2 * x4_2 * 1.7717931172872569689502598e-04 + \
                x2 * x3 * 8.4219171643174668695497331e-03 + \
                x2 * x3 * x7 * -2.8296134066917947441632819e-04 + \
                x2 * x3 * x6 * 2.1929056136660101360147390e-04 + \
                x2 * x3 * x5 * -2.4400164061621001931889907e-04 + \
                x2 * x3 * x4 * 1.7825436323631275049167444e-04 + \
                x2 * x3_2 * 2.0222605299657185617956401e-03 + \
                x2_2 * 4.1307279649878602886814427e-03 + \
                x2_2 * x7 * 1.1321868315102012747530580e-05 + \
                x2_2 * x6 * -1.1490860568903749072688925e-05 + \
                x2_2 * x5 * -2.2572144724848641761383305e-05 + \
                x2_2 * x4 * 4.6896328437302792213614566e-05 + \
                x2_2 * x3 * -4.5075857598947163124014637e-03 + \
                x2_3 * -6.5669665076946437398675016e-04 + \
                x1 * -3.2477562966878523176283977e-03 + \
                x1 * x7 * 5.4782257706688375353820675e-04 + \
                x1 * x7_2 * -2.6766767036470046070562034e-04 + \
                x1 * x6 * 6.3154564387215075815795728e-05 + \
                x1 * x6 * x7 * -8.5788302506245583956001610e-05 + \
                x1 * x6_2 * -2.1768901408140972630889109e-04 + \
                x1 * x5 * 2.9767031291788592639591116e-04 + \
                x1 * x5 * x7 * -1.6299791949060584567154919e-04 + \
                x1 * x5 * x6 * -2.5056602648368397900924265e-04 + \
                x1 * x5_2 * -2.0268951775742963250515061e-04 + \
                x1 * x4 * 1.7458023987712567581809253e-05 + \
                x1 * x4 * x7 * 1.7280152534877857295469994e-04 + \
                x1 * x4 * x6 * -8.3634707980020928097530941e-05 + \
                x1 * x4 * x5 * -4.3117315223703892024254003e-04 + \
                x1 * x4_2 * -3.6492757103668768681181689e-05 + \
                x1 * x3 * 4.5405408651043172030270512e-03 + \
                x1 * x3 * x7 * 1.4780274280871063749542849e-06 + \
                x1 * x3 * x6 * -1.4335438929796023854734699e-04 + \
                x1 * x3 * x5 * -1.6196496324514392251003869e-04 + \
                x1 * x3 * x4 * 3.3760499979362118549985894e-04 + \
                x1 * x3_2 * 1.8546094271279511822569930e-03 + \
                x1 * x2 * 4.6412014967001855025863222e-03 + \
                x1 * x2 * x7 * -1.6103865637765932272706948e-04 + \
                x1 * x2 * x6 * 1.9039485693446780989468436e-04 + \
                x1 * x2 * x5 * 2.5696243234020824108831960e-04 + \
                x1 * x2 * x4 * -8.8799596704439848204870600e-05 + \
                x1 * x2 * x3 * -5.6573761424877772041597268e-03 + \
                x1 * x2_2 * -1.5142257259426507298716302e-03 + \
                x1_2 * 3.5656390548953476038462895e-04 + \
                x1_2 * x7 * -2.8422038278380634679365357e-05 + \
                x1_2 * x6 * 3.4541686607589966451214991e-04 + \
                x1_2 * x5 * 2.2168710507869740511388557e-04 + \
                x1_2 * x4 * 1.4862924532000817978705243e-04 + \
                x1_2 * x3 * -1.3493533787995899697609303e-03 + \
                x1_2 * x2 * -3.6508964390804567179404927e-04 + \
                x1_3 * 1.2325401125933737114803712e-04 + \
                x0 * -9.9915298630216642372658953e-01 + \
                x0 * x7 * 1.5919133883152136732519466e-04 + \
                x0 * x7_2 * -1.2754157470608318281080074e-04 + \
                x0 * x6 * 1.2208087729143057842406961e-05 + \
                x0 * x6 * x7 * 1.1093209568954418009489871e-04 + \
                x0 * x6_2 * -1.5442632653894783345549513e-04 + \
                x0 * x5 * 4.4357996800786780866587833e-04 + \
                x0 * x5 * x7 * -1.2745182833943284952948893e-04 + \
                x0 * x5 * x6 * 9.6545207265749666269982754e-05 + \
                x0 * x5_2 * -2.0188927747791240996377837e-04 + \
                x0 * x4 * 1.0666470904352465254305571e-04 + \
                x0 * x4 * x7 * 1.2987689841879521135403763e-04 + \
                x0 * x4 * x6 * 1.5556855562279259252989050e-04 + \
                x0 * x4 * x5 * -3.2102678841309031931849916e-04 + \
                x0 * x4_2 * 1.2891355162195083927656469e-04 + \
                x0 * x3 * 2.9010674429857316591885308e-03 + \
                x0 * x3 * x7 * -1.2929450552671278851235570e-04 + \
                x0 * x3 * x6 * -4.1189419442606151067209908e-05 + \
                x0 * x3 * x5 * 2.2383945834073340486192194e-04 + \
                x0 * x3 * x4 * -1.6849144139513547234303370e-04 + \
                x0 * x3_2 * -6.5225431765302682718399296e-04 + \
                x0 * x2 * -2.6709765354511749713140034e-03 + \
                x0 * x2 * x7 * -2.9874032467853972594440393e-05 + \
                x0 * x2 * x6 * -3.2836778942894623983805857e-04 + \
                x0 * x2 * x5 * -8.4493452137315155914265574e-05 + \
                x0 * x2 * x4 * -3.4725766903359600590306400e-05 + \
                x0 * x2 * x3 * -1.7486161992745835255802511e-03 + \
                x0 * x2_2 * 1.5392182314915986429681993e-03 + \
                x0 * x1 * -1.4305588384125322853890339e-03 + \
                x0 * x1 * x7 * -2.8353345536608618501078771e-04 + \
                x0 * x1 * x6 * -8.6443557833527917555471731e-05 + \
                x0 * x1 * x5 * -1.1641979564507541622386810e-04 + \
                x0 * x1 * x4 * -1.1037420232713903529495059e-04 + \
                x0 * x1 * x3 * -1.5328939260184255843899592e-03 + \
                x0 * x1 * x2 * 2.1686600375978911520169490e-03 + \
                x0 * x1_2 * 4.9546252621215230993456657e-04 + \
                x0_2 * -6.4348199130173644455510384e-04 + \
                x0_2 * x7 * 1.3421514647430493605284596e-04 + \
                x0_2 * x6 * 2.0143492406468274658060125e-04 + \
                x0_2 * x5 * -1.0080445712159699644949740e-04 + \
                x0_2 * x4 * -1.3205266421376787855379575e-05 + \
                x0_2 * x3 * 1.7774997312994256226659218e-06 + \
                x0_2 * x2 * 3.2482753582708731587835871e-04 + \
                x0_2 * x1 * 2.6988116076860895614641933e-04 + \
                x0_3 * 3.0200125519477816204982901e-05
            output = output * 3.9986987106513379330863245e+02 + -1.5229315943159986090904567e+03
            Feed_LB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\Feed_LB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            Feed_LB_Con += output
            return Feed_LB_Con

        def TurbineCon3(m):
            return Feed_LB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                    m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.TurbineCon3 = Expression(rule=TurbineCon3)

        def Feed_UB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                             vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * -3.0906879522909313888490157e-03 + \
                x7 * 3.3628431447194073733442110e-04 + \
                x7_2 * 1.9712171181496263017152160e-04 + \
                x7_3 * -8.0036496741431317758497244e-05 + \
                x6 * 5.3773505945098332148290865e-04 + \
                x6 * x7 * 8.5298393846661157979838208e-05 + \
                x6 * x7_2 * -4.9805155336357653794721045e-04 + \
                x6_2 * -5.0590526793065082600264759e-04 + \
                x6_2 * x7 * 2.4925963432893133431278443e-04 + \
                x6_3 * 2.1358055926254198263192219e-04 + \
                x5 * 8.4092965139928978549055394e-04 + \
                x5 * x7 * -3.9419890663131007535469053e-04 + \
                x5 * x7_2 * 4.0529817548873303678647062e-05 + \
                x5 * x6 * -4.0549912164716817031262508e-04 + \
                x5 * x6 * x7 * 8.3826860478405929022471810e-05 + \
                x5 * x6_2 * 1.2199354243229432182005212e-04 + \
                x5_2 * -5.3345879773099291742965988e-04 + \
                x5_2 * x7 * 3.7138011164131179420166973e-05 + \
                x5_2 * x6 * -9.8937187595606046475182893e-05 + \
                x5_3 * 2.6301103894396269874955685e-04 + \
                x4 * -4.5661910654790083263776523e-05 + \
                x4 * x7 * 1.8953936013357819412306071e-04 + \
                x4 * x7_2 * -2.2918683001619220840350266e-04 + \
                x4 * x6 * -1.8681330724468203641208675e-04 + \
                x4 * x6 * x7 * 1.4323407568500590159032981e-04 + \
                x4 * x6_2 * -2.3614942388441861886860806e-04 + \
                x4 * x5 * -1.9330570617714926129337982e-04 + \
                x4 * x5 * x7 * -2.9103353790999042516318696e-05 + \
                x4 * x5 * x6 * 1.6924973328780179571140252e-04 + \
                x4 * x5_2 * -2.3190059413499830576199656e-04 + \
                x4_2 * 4.1849449686643227022675440e-04 + \
                x4_2 * x7 * 8.1257250012678472472771318e-05 + \
                x4_2 * x6 * -1.5675113316022948328765096e-05 + \
                x4_2 * x5 * -2.0075316423976904967041435e-04 + \
                x4_3 * -1.5266166026037253367064750e-04 + \
                x3 * 3.5365395217207065692299750e-03 + \
                x3 * x7 * -2.8370098358179718367466648e-04 + \
                x3 * x7_2 * -1.0766495297166028821678196e-04 + \
                x3 * x6 * 1.1105596861139127584650055e-04 + \
                x3 * x6 * x7 * 2.8833764546182250043671047e-05 + \
                x3 * x6_2 * -3.4823269402388043469720458e-04 + \
                x3 * x5 * -3.5258789554177411007529486e-04 + \
                x3 * x5 * x7 * 1.9527853217845766997662338e-04 + \
                x3 * x5 * x6 * -1.9442504140210897789486921e-04 + \
                x3 * x5_2 * -9.2583364818397961837348475e-05 + \
                x3 * x4 * 9.2728048310036781387566407e-05 + \
                x3 * x4 * x7 * 1.4731202250430411315740287e-04 + \
                x3 * x4 * x6 * 3.7984858701192378283018058e-04 + \
                x3 * x4 * x5 * -1.1891042412494334801209561e-04 + \
                x3 * x4_2 * 1.6715596060310963788531069e-04 + \
                x3_2 * 3.0244651298260705196696563e-03 + \
                x3_2 * x7 * -5.2083518940355608140002630e-05 + \
                x3_2 * x6 * 1.0279676298394907485445060e-04 + \
                x3_2 * x5 * 3.2921276688260316112266679e-04 + \
                x3_2 * x4 * -1.9030012223135786553207538e-04 + \
                x3_3 * -6.5450641972954887171098903e-04 + \
                x2 * 6.5424768787536342895538866e-03 + \
                x2 * x7 * -4.8157203077101029542461674e-04 + \
                x2 * x7_2 * 2.2797883756828229984137124e-04 + \
                x2 * x6 * -4.2130352455472565298411070e-04 + \
                x2 * x6 * x7 * -3.4887932570814997670916036e-05 + \
                x2 * x6_2 * 2.0691719473014437424840395e-04 + \
                x2 * x5 * -5.6006448556443749059452486e-04 + \
                x2 * x5 * x7 * 7.0699958639909230018183450e-05 + \
                x2 * x5 * x6 * 4.4093779252182829786477214e-04 + \
                x2 * x5_2 * 2.1654457097934967646502002e-04 + \
                x2 * x4 * -4.8406942366545011036116364e-05 + \
                x2 * x4 * x7 * -1.1227529283154569217373364e-05 + \
                x2 * x4 * x6 * 2.0199591850317798191749574e-04 + \
                x2 * x4 * x5 * 3.2779471417760698559451527e-04 + \
                x2 * x4_2 * -1.7717931172880202472796896e-04 + \
                x2 * x3 * -8.4219171643177236086241777e-03 + \
                x2 * x3 * x7 * 2.8296134066922631195017956e-04 + \
                x2 * x3 * x6 * -2.1929056136634427452702933e-04 + \
                x2 * x3 * x5 * 2.4400164061608858867558070e-04 + \
                x2 * x3 * x4 * -1.7825436323616042008644023e-04 + \
                x2 * x3_2 * -2.0222605299658122368633428e-03 + \
                x2_2 * -4.1307279649860336248612391e-03 + \
                x2_2 * x7 * -1.1321868315913863334287726e-05 + \
                x2_2 * x6 * 1.1490860568834360133649852e-05 + \
                x2_2 * x5 * 2.2572144725133136411443502e-05 + \
                x2_2 * x4 * -4.6896328437323608895326288e-05 + \
                x2_2 * x3 * 4.5075857598947397311683893e-03 + \
                x2_3 * 6.5669665076867334008170474e-04 + \
                x1 * 3.2477562966877916023067385e-03 + \
                x1 * x7 * -5.4782257706768866523105999e-04 + \
                x1 * x7_2 * 2.6766767036529720558135637e-04 + \
                x1 * x6 * -6.3154564388089376447688039e-05 + \
                x1 * x6 * x7 * 8.5788302506197011698674260e-05 + \
                x1 * x6_2 * 2.1768901408243668260666936e-04 + \
                x1 * x5 * -2.9767031291863532693753314e-04 + \
                x1 * x5 * x7 * 1.6299791949170305827010452e-04 + \
                x1 * x5 * x6 * 2.5056602648416970158251615e-04 + \
                x1 * x5_2 * 2.0268951775719371011241776e-04 + \
                x1 * x4 * -1.7458023988097676193476104e-05 + \
                x1 * x4 * x7 * -1.7280152534936490948958010e-04 + \
                x1 * x4 * x6 * 8.3634707979993172521915312e-05 + \
                x1 * x4 * x5 * 4.3117315223759056230790065e-04 + \
                x1 * x4_2 * 3.6492757104022652270280958e-05 + \
                x1 * x3 * -4.5405408651036510692122761e-03 + \
                x1 * x3 * x7 * -1.4780274277851560699170719e-06 + \
                x1 * x3 * x6 * 1.4335438929860555568041036e-04 + \
                x1 * x3 * x5 * 1.6196496324542841716009889e-04 + \
                x1 * x3 * x4 * -3.3760499979374955503708122e-04 + \
                x1 * x3_2 * -1.8546094271279095488935695e-03 + \
                x1 * x2 * -4.6412014967009479135540140e-03 + \
                x1 * x2 * x7 * 1.6103865637665231574926494e-04 + \
                x1 * x2 * x6 * -1.9039485693468291560570549e-04 + \
                x1 * x2 * x5 * -2.5696243233971557962114218e-04 + \
                x1 * x2 * x4 * 8.8799596704752098430546425e-05 + \
                x1 * x2 * x3 * 5.6573761424873227066090209e-03 + \
                x1 * x2_2 * 1.5142257259438025862596788e-03 + \
                x1_2 * -3.5656390548886862656985386e-04 + \
                x1_2 * x7 * 2.8422038278473442385330117e-05 + \
                x1_2 * x6 * -3.4541686607631599814638435e-04 + \
                x1_2 * x5 * -2.2168710507904781925603288e-04 + \
                x1_2 * x4 * -1.4862924531962654062233753e-04 + \
                x1_2 * x3 * 1.3493533787989481220748189e-03 + \
                x1_2 * x2 * 3.6508964390808470307225875e-04 + \
                x1_3 * -1.2325401125949436362261302e-04 + \
                x0 * 9.9915298630216586861507722e-01 + \
                x0 * x7 * -1.5919133883120217820561493e-04 + \
                x0 * x7_2 * 1.2754157470511173766425372e-04 + \
                x0 * x6 * -1.2208087728407535088592795e-05 + \
                x0 * x6 * x7 * -1.1093209569043582796155079e-04 + \
                x0 * x6_2 * 1.5442632653880038196003710e-04 + \
                x0 * x5 * -4.4357996800785393087807051e-04 + \
                x0 * x5 * x7 * 1.2745182834024036330755614e-04 + \
                x0 * x5 * x6 * -9.6545207265603949498000702e-05 + \
                x0 * x5_2 * 2.0188927747755158748077520e-04 + \
                x0 * x4 * -1.0666470904376057493578855e-04 + \
                x0 * x4 * x7 * -1.2987689841911093102666541e-04 + \
                x0 * x4 * x6 * -1.5556855562301810658176748e-04 + \
                x0 * x4 * x5 * 3.2102678841394727271563170e-04 + \
                x0 * x4_2 * -1.2891355162199247263998814e-04 + \
                x0 * x3 * -2.9010674429858981926422246e-03 + \
                x0 * x3 * x7 * 1.2929450552702850818498348e-04 + \
                x0 * x3 * x6 * 4.1189419442186347986023520e-05 + \
                x0 * x3 * x5 * -2.2383945834101443006503018e-04 + \
                x0 * x3 * x4 * 1.6849144139527118734997457e-04 + \
                x0 * x3_2 * 6.5225431765353336643897819e-04 + \
                x0 * x2 * 2.6709765354498010703210298e-03 + \
                x0 * x2 * x7 * 2.9874032468329286826858038e-05 + \
                x0 * x2 * x6 * 3.2836778942992288915503352e-04 + \
                x0 * x2 * x5 * 8.4493452137776592358875405e-05 + \
                x0 * x2 * x4 * 3.4725766903685728603790039e-05 + \
                x0 * x2 * x3 * 1.7486161992749261334667565e-03 + \
                x0 * x2_2 * -1.5392182314913072094242352e-03 + \
                x0 * x1 * 1.4305588384141698643503560e-03 + \
                x0 * x1 * x7 * 2.8353345536680511947136285e-04 + \
                x0 * x1 * x6 * 8.6443557833215667329795906e-05 + \
                x0 * x1 * x5 * 1.1641979564490975013191232e-04 + \
                x0 * x1 * x4 * 1.1037420232714590642621871e-04 + \
                x0 * x1 * x3 * 1.5328939260181098647173314e-03 + \
                x0 * x1 * x2 * -2.1686600375972614473951694e-03 + \
                x0 * x1_2 * -4.9546252621265191029564789e-04 + \
                x0_2 * 6.4348199130248584509672582e-04 + \
                x0_2 * x7 * -1.3421514647462759461937765e-04 + \
                x0_2 * x6 * -2.0143492406480764667087158e-04 + \
                x0_2 * x5 * 1.0080445712121882673173445e-04 + \
                x0_2 * x4 * 1.3205266421307398916340503e-05 + \
                x0_2 * x3 * -1.7774997313046297930938522e-06 + \
                x0_2 * x2 * -3.2482753582708731587835871e-04 + \
                x0_2 * x1 * -2.6988116076960468742163002e-04 + \
                x0_3 * -3.0200125519241893812250055e-05
            output = output * 3.9986987106513379330863245e+02 + -2.8923548767491342914581764e+03
            Feed_UB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\Feed_UB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            Feed_UB_Con += output
            return Feed_UB_Con

        def TurbineCon4(m):
            return Feed_UB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                    m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.TurbineCon4 = Expression(rule=TurbineCon4)

        def HPA_LB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                            vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 3.4546772258360936014298659e-01 + \
                x7 * -2.4458736958426860463866603e-02 + \
                x7_2 * 3.2362605947809625073219308e-02 + \
                x7_3 * -4.1809824673621209800700171e-03 + \
                x6 * -3.7477673705667235992677888e-02 + \
                x6 * x7 * 3.3420579058651492254661264e-02 + \
                x6 * x7_2 * -6.7829310664848652123737338e-03 + \
                x6_2 * 3.3214023669545678085768259e-02 + \
                x6_2 * x7 * -1.5479987257648465670545335e-02 + \
                x6_3 * -1.7660228497741375930374375e-02 + \
                x5 * 6.3159329710174211269801958e-02 + \
                x5 * x7 * -1.9248873380405845390228592e-02 + \
                x5 * x7_2 * 1.1046264689475664144691081e-02 + \
                x5 * x6 * -5.2828446961247776947345756e-03 + \
                x5 * x6 * x7 * -4.2737477127327561099434661e-04 + \
                x5 * x6_2 * -1.6059462847379878114306706e-02 + \
                x5_2 * -4.2654686912821232480652611e-02 + \
                x5_2 * x7 * 1.3919275874000408554920227e-02 + \
                x5_2 * x6 * 2.5897763670724535667311272e-02 + \
                x5_3 * -1.2110370127989517063937797e-02 + \
                x4 * 1.7760726147283249082287071e-02 + \
                x4 * x7 * 4.3629192670990274427467170e-02 + \
                x4 * x7_2 * 1.3431115265355540039360349e-03 + \
                x4 * x6 * -1.3101162425490267549044177e-02 + \
                x4 * x6 * x7 * 4.1208837394854161417789840e-03 + \
                x4 * x6_2 * 2.6984016815610079031984014e-02 + \
                x4 * x5 * -3.9812937316937323239951496e-02 + \
                x4 * x5 * x7 * -2.5559962332404637108673739e-02 + \
                x4 * x5 * x6 * -1.4771442173103714601278824e-02 + \
                x4 * x5_2 * 9.3788141551986031752008444e-03 + \
                x4_2 * 1.7822693934652883429592407e-02 + \
                x4_2 * x7 * -1.8901423410561724036682563e-02 + \
                x4_2 * x6 * 2.0990453260569995330708792e-02 + \
                x4_2 * x5 * 1.2430467700631282756962293e-02 + \
                x4_3 * -2.5551686203489132331867495e-02 + \
                x3 * -2.1569951954520713566232359e-01 + \
                x3 * x7 * 2.6903111970056556301322814e-02 + \
                x3 * x7_2 * -2.1621557779079505351438328e-03 + \
                x3 * x6 * 4.8670373351650003668211752e-02 + \
                x3 * x6 * x7 * -1.3209829839257388600648468e-02 + \
                x3 * x6_2 * -1.6395007803306840821200296e-02 + \
                x3 * x5 * 3.9130739923268417768120742e-02 + \
                x3 * x5 * x7 * 7.5437053387870309228979693e-03 + \
                x3 * x5 * x6 * -5.2324924191716054577838690e-03 + \
                x3 * x5_2 * 2.4941621393021057295769083e-03 + \
                x3 * x4 * -4.9905832614613634956590715e-02 + \
                x3 * x4 * x7 * 1.7999703639105607555492838e-02 + \
                x3 * x4 * x6 * 1.1383260365042557893389130e-02 + \
                x3 * x4 * x5 * -1.5251830972069183034456330e-02 + \
                x3 * x4_2 * 1.1302663363188525380564897e-02 + \
                x3_2 * 1.2619019082724297620146103e-01 + \
                x3_2 * x7 * -1.3992396359548971151998131e-02 + \
                x3_2 * x6 * -3.4594696281916727242933263e-02 + \
                x3_2 * x5 * 2.6203960475268545105009821e-03 + \
                x3_2 * x4 * 2.3607940155402809545570619e-02 + \
                x3_3 * 1.7273248359469393214959965e-02 + \
                x2 * -1.0055100856192529246158074e+00 + \
                x2 * x7 * -5.1675638431376291759278274e-02 + \
                x2 * x7_2 * 4.3959672939782971912148213e-03 + \
                x2 * x6 * -4.7374741424178468118810770e-03 + \
                x2 * x6 * x7 * -1.5154586541068384812624981e-03 + \
                x2 * x6_2 * 1.3661791794232092805971845e-03 + \
                x2 * x5 * -6.1678342147367698489190957e-02 + \
                x2 * x5 * x7 * 6.7905297426450392239694054e-03 + \
                x2 * x5 * x6 * -8.3623898043997668683147140e-03 + \
                x2 * x5_2 * 3.8216573064324452224660433e-02 + \
                x2 * x4 * -3.3398007208856009264685838e-02 + \
                x2 * x4 * x7 * -1.3911108698411379230863716e-02 + \
                x2 * x4 * x6 * -1.8534962808762024677466940e-02 + \
                x2 * x4 * x5 * 3.6358317555398034226499249e-02 + \
                x2 * x4_2 * 4.4240516917749949515892283e-03 + \
                x2 * x3 * 2.6285769646669449040032873e-01 + \
                x2 * x3 * x7 * -8.4281557749129459855552682e-04 + \
                x2 * x3 * x6 * 1.6153617568487325245607522e-02 + \
                x2 * x3 * x5 * -3.5588700341883536260034759e-02 + \
                x2 * x3 * x4 * 1.5873640629330738188729200e-02 + \
                x2 * x3_2 * -1.2266291867817620542258084e-01 + \
                x2_2 * 1.6623706926261934135879983e+00 + \
                x2_2 * x7 * 1.6202716156804422564796653e-02 + \
                x2_2 * x6 * 1.5569125636598034334578955e-02 + \
                x2_2 * x5 * 9.3315936719720118941445719e-03 + \
                x2_2 * x4 * 6.6639235541023911224556286e-03 + \
                x2_2 * x3 * -8.0758988455509994608405577e-02 + \
                x2_3 * -4.6849346933048924279674452e-01 + \
                x1 * -4.2163783823987677212841163e-01 + \
                x1 * x7 * -3.8402534158257492502563935e-02 + \
                x1 * x7_2 * -2.9578406067881986285517115e-02 + \
                x1 * x6 * 2.0813605557987335803460383e-02 + \
                x1 * x6 * x7 * -4.7161366180183406093817666e-03 + \
                x1 * x6_2 * 1.1648525000527543138417741e-02 + \
                x1 * x5 * -9.1016661520442715405110334e-02 + \
                x1 * x5 * x7 * 1.4229770892391963368894814e-02 + \
                x1 * x5 * x6 * 3.9424439306610312150347397e-03 + \
                x1 * x5_2 * 2.1831187882300821107017796e-02 + \
                x1 * x4 * -3.6608166483314441563834407e-02 + \
                x1 * x4 * x7 * -8.2159404674816971514417219e-03 + \
                x1 * x4 * x6 * -3.6108641963954295206473688e-03 + \
                x1 * x4 * x5 * 3.9222679988167807874077653e-02 + \
                x1 * x4_2 * 5.1362887294991461245574627e-03 + \
                x1 * x3 * 1.2465996999457121252596892e-01 + \
                x1 * x3 * x7 * -2.2464217308746731172064415e-02 + \
                x1 * x3 * x6 * -1.1209760251320324830892616e-02 + \
                x1 * x3 * x5 * -2.3203145287084447900838313e-02 + \
                x1 * x3 * x4 * 7.2972343539250000832296905e-03 + \
                x1 * x3_2 * -5.3400213939095886317431905e-02 + \
                x1 * x2 * 1.9857464029528173465877217e+00 + \
                x1 * x2 * x7 * 4.8666649607648868047782287e-02 + \
                x1 * x2 * x6 * -8.5435963728532557381889490e-03 + \
                x1 * x2 * x5 * 2.7189958779875296468464541e-02 + \
                x1 * x2 * x4 * 1.7564655973159731816579665e-02 + \
                x1 * x2 * x3 * -9.0194013206135556504072781e-02 + \
                x1 * x2_2 * -1.0027922218742604254515527e+00 + \
                x1_2 * 3.6771366775478309119051801e-01 + \
                x1_2 * x7 * 4.1133342486606258581183226e-02 + \
                x1_2 * x6 * -1.3562862374230114093087707e-02 + \
                x1_2 * x5 * 3.5743490486810011730334224e-02 + \
                x1_2 * x4 * 1.2005268365691719456567199e-02 + \
                x1_2 * x3 * 1.1764951880420593255394124e-02 + \
                x1_2 * x2 * -4.2386285444565841018516039e-01 + \
                x1_3 * -2.5978896114774802095226391e-02 + \
                x0 * -1.3451992487668207321149794e-01 + \
                x0 * x7 * 4.9410197289305957113469958e-02 + \
                x0 * x7_2 * -3.2962035935109150475152973e-02 + \
                x0 * x6 * -1.6007521585212194925595952e-02 + \
                x0 * x6 * x7 * -5.6664671424251772391400550e-03 + \
                x0 * x6_2 * -1.5377036039469077488561766e-04 + \
                x0 * x5 * 5.4708469282215232976085417e-02 + \
                x0 * x5 * x7 * -1.1474979357347682429324465e-02 + \
                x0 * x5 * x6 * 2.0079083648526039468373838e-02 + \
                x0 * x5_2 * -4.3033485507051189022931226e-04 + \
                x0 * x4 * 4.5534897762205144011726787e-02 + \
                x0 * x4 * x7 * -1.5399604600283087890710831e-02 + \
                x0 * x4 * x6 * -4.4049819419382817142771813e-02 + \
                x0 * x4 * x5 * 5.6083886302985830329959072e-03 + \
                x0 * x4_2 * 3.5127873006219473284161836e-04 + \
                x0 * x3 * -7.8752671144435321126664462e-02 + \
                x0 * x3 * x7 * -5.1101990571633879034685322e-03 + \
                x0 * x3 * x6 * 6.9024543289004230972594200e-04 + \
                x0 * x3 * x5 * -1.8448341711416266219814020e-02 + \
                x0 * x3 * x4 * -2.3365183934422148470666514e-02 + \
                x0 * x3_2 * -2.7477003819287353081346481e-02 + \
                x0 * x2 * -1.3609665480914887036867356e-01 + \
                x0 * x2 * x7 * 1.1845504387576314547780854e-02 + \
                x0 * x2 * x6 * -7.3258351951483238750917337e-03 + \
                x0 * x2 * x5 * -1.4486920692753119110918192e-02 + \
                x0 * x2 * x4 * -3.3823265815651967769461805e-03 + \
                x0 * x2 * x3 * 1.2782501351687153290370702e-01 + \
                x0 * x2_2 * 8.9867228396574558302312141e-02 + \
                x0 * x1 * -9.5965454838143338101019708e-03 + \
                x0 * x1 * x7 * 6.2167664476212598084758909e-03 + \
                x0 * x1 * x6 * -2.8503087539542698580774527e-03 + \
                x0 * x1 * x5 * -1.3678642061057634179976894e-02 + \
                x0 * x1 * x4 * -2.3009749623689755571032123e-02 + \
                x0 * x1 * x3 * 6.0056549311985708838879106e-02 + \
                x0 * x1 * x2 * 9.3503929424881074283781857e-02 + \
                x0 * x1_2 * 8.3693923055960413315279567e-03 + \
                x0_2 * -6.5807326039791363969655436e-04 + \
                x0_2 * x7 * -9.4057516162237564394388301e-03 + \
                x0_2 * x6 * 3.8621782596250500696477559e-02 + \
                x0_2 * x5 * -3.3602466050131833685821192e-02 + \
                x0_2 * x4 * -5.8599372831930063298955247e-04 + \
                x0_2 * x3 * 4.7766101094977170271604905e-03 + \
                x0_2 * x2 * -1.9359784173159623466009549e-02 + \
                x0_2 * x1 * -3.3731377406238605143329323e-02 + \
                x0_3 * 2.0367370871175863311641763e-02
            output = output * 7.1494054892310032300883904e+02 + -5.6928444842003386838769075e+02
            HPA_LB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\HPA_LB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            HPA_LB_Con += output
            return HPA_LB_Con

        def TurbineCon7(m):
            return HPA_LB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                   m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.TurbineCon7 = Expression(rule=TurbineCon7)

        def HPA_UB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                            vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 6.5453227741639152803543311e-01 + \
                x7 * 2.4458736958424508178833179e-02 + \
                x7_2 * -3.2362605947808265050014143e-02 + \
                x7_3 * 4.1809824673623985358261734e-03 + \
                x6 * 3.7477673705666292303106957e-02 + \
                x6 * x7 * -3.3420579058650749793013546e-02 + \
                x6 * x7_2 * 6.7829310664853648127348151e-03 + \
                x6_2 * -3.3214023669546732797641653e-02 + \
                x6_2 * x7 * 1.5479987257648337301008112e-02 + \
                x6_3 * 1.7660228497742458397823384e-02 + \
                x5 * -6.3159329710175154959372890e-02 + \
                x5 * x7 * 1.9248873380406712751966580e-02 + \
                x5 * x7_2 * -1.1046264689476585282856824e-02 + \
                x5 * x6 * 5.2828446961249164726126537e-03 + \
                x5 * x6 * x7 * 4.2737477127275519395155357e-04 + \
                x5 * x6_2 * 1.6059462847380086281123823e-02 + \
                x5_2 * 4.2654686912821593303135614e-02 + \
                x5_2 * x7 * -1.3919275874000325288193380e-02 + \
                x5_2 * x6 * -2.5897763670723765450087939e-02 + \
                x5_3 * 1.2110370127989336652696295e-02 + \
                x4 * -1.7760726147283585618641411e-02 + \
                x4 * x7 * -4.3629192670988539703991194e-02 + \
                x4 * x7_2 * -1.3431115265373789330327625e-03 + \
                x4 * x6 * 1.3101162425490902457836384e-02 + \
                x4 * x6 * x7 * -4.1208837394841948964518963e-03 + \
                x4 * x6_2 * -2.6984016815610911699252483e-02 + \
                x4 * x5 * 3.9812937316937753451373538e-02 + \
                x4 * x5 * x7 * 2.5559962332404817519915241e-02 + \
                x4 * x5 * x6 * 1.4771442173102049266741886e-02 + \
                x4 * x5_2 * -9.3788141551996787037559500e-03 + \
                x4_2 * -1.7822693934653056901940005e-02 + \
                x4_2 * x7 * 1.8901423410562001592438719e-02 + \
                x4_2 * x6 * -2.0990453260569884308406330e-02 + \
                x4_2 * x5 * -1.2430467700630956628948809e-02 + \
                x4_3 * 2.5551686203489180904124822e-02 + \
                x3 * 2.1569951954520608095045020e-01 + \
                x3 * x7 * -2.6903111970055626489539691e-02 + \
                x3 * x7_2 * 2.1621557779077510419440955e-03 + \
                x3 * x6 * -4.8670373351649295901033554e-02 + \
                x3 * x6 * x7 * 1.3209829839256691241811126e-02 + \
                x3 * x6_2 * 1.6395007803306681226640507e-02 + \
                x3 * x5 * -3.9130739923269389213267289e-02 + \
                x3 * x5 * x7 * -7.5437053387867897963348085e-03 + \
                x3 * x5 * x6 * 5.2324924191714528021179831e-03 + \
                x3 * x5_2 * -2.4941621393023832853330646e-03 + \
                x3 * x4 * 4.9905832614613843123407833e-02 + \
                x3 * x4 * x7 * -1.7999703639106183483686863e-02 + \
                x3 * x4 * x6 * -1.1383260365042217887587839e-02 + \
                x3 * x4 * x5 * 1.5251830972070064273982126e-02 + \
                x3 * x4_2 * -1.1302663363188518441670993e-02 + \
                x3_2 * -1.2619019082724311497933911e-01 + \
                x3_2 * x7 * 1.3992396359548540940576089e-02 + \
                x3_2 * x6 * 3.4594696281915957025709929e-02 + \
                x3_2 * x5 * -2.6203960475257165319007413e-03 + \
                x3_2 * x4 * -2.3607940155403607518369569e-02 + \
                x3_3 * -1.7273248359468668100547006e-02 + \
                x2 * 1.0055100856192515923481778e+00 + \
                x2 * x7 * 5.1675638431378054238329867e-02 + \
                x2 * x7_2 * -4.3959672939781514744428392e-03 + \
                x2 * x6 * 4.7374741424194566352667835e-03 + \
                x2 * x6 * x7 * 1.5154586541070249640361656e-03 + \
                x2 * x6_2 * -1.3661791794239881714378981e-03 + \
                x2 * x5 * 6.1678342147367740122554380e-02 + \
                x2 * x5 * x7 * -6.7905297426455180076487750e-03 + \
                x2 * x5 * x6 * 8.3623898043995430889863130e-03 + \
                x2 * x5_2 * -3.8216573064324362019039683e-02 + \
                x2 * x4 * 3.3398007208856897443105538e-02 + \
                x2 * x4 * x7 * 1.3911108698411393108651524e-02 + \
                x2 * x4 * x6 * 1.8534962808761851205119342e-02 + \
                x2 * x4 * x5 * -3.6358317555398304843361501e-02 + \
                x2 * x4_2 * -4.4240516917744675956525313e-03 + \
                x2 * x3 * -2.6285769646669321364385041e-01 + \
                x2 * x3 * x7 * 8.4281557749085397879262871e-04 + \
                x2 * x3 * x6 * -1.6153617568486794420223873e-02 + \
                x2 * x3 * x5 * 3.5588700341883813815790916e-02 + \
                x2 * x3 * x4 * -1.5873640629330922069417653e-02 + \
                x2 * x3_2 * 1.2266291867817583072231002e-01 + \
                x2_2 * -1.6623706926261920813203687e+00 + \
                x2_2 * x7 * -1.6202716156805352376579776e-02 + \
                x2_2 * x6 * -1.5569125636598485362682709e-02 + \
                x2_2 * x5 * -9.3315936719710959601492561e-03 + \
                x2_2 * x4 * -6.6639235541027519449386318e-03 + \
                x2_2 * x3 * 8.0758988455509411741317649e-02 + \
                x2_3 * 4.6849346933048868768523221e-01 + \
                x1 * 4.2163783823987616150574809e-01 + \
                x1 * x7 * 3.8402534158258103125227478e-02 + \
                x1 * x7_2 * 2.9578406067881420765663947e-02 + \
                x1 * x6 * -2.0813605557986059046982064e-02 + \
                x1 * x6 * x7 * 4.7161366180179242757475322e-03 + \
                x1 * x6_2 * -1.1648525000527185785381690e-02 + \
                x1 * x5 * 9.1016661520443992161588653e-02 + \
                x1 * x5 * x7 * -1.4229770892391900918849679e-02 + \
                x1 * x5 * x6 * -3.9424439306619228629013918e-03 + \
                x1 * x5_2 * -2.1831187882301438668575244e-02 + \
                x1 * x4 * 3.6608166483314552586136870e-02 + \
                x1 * x4 * x7 * 8.2159404674813016344891992e-03 + \
                x1 * x4 * x6 * 3.6108641963948223674307769e-03 + \
                x1 * x4 * x5 * -3.9222679988167571951684920e-02 + \
                x1 * x4_2 * -5.1362887294995659276386490e-03 + \
                x1 * x3 * -1.2465996999457018556967114e-01 + \
                x1 * x3 * x7 * 2.2464217308746495249671682e-02 + \
                x1 * x3 * x6 * 1.1209760251319686452653457e-02 + \
                x1 * x3 * x5 * 2.3203145287084489534201737e-02 + \
                x1 * x3 * x4 * -7.2972343539249610519514810e-03 + \
                x1 * x3_2 * 5.3400213939095136916890283e-02 + \
                x1 * x2 * -1.9857464029528180127215364e+00 + \
                x1 * x2 * x7 * -4.8666649607649020703448173e-02 + \
                x1 * x2 * x6 * 8.5435963728534847216877779e-03 + \
                x1 * x2 * x5 * -2.7189958779875754435462198e-02 + \
                x1 * x2 * x4 * -1.7564655973159870594457743e-02 + \
                x1 * x2 * x3 * 9.0194013206134765470167736e-02 + \
                x1 * x2_2 * 1.0027922218742617577191822e+00 + \
                x1_2 * -3.6771366775478342425742539e-01 + \
                x1_2 * x7 * -4.1133342486606890020528482e-02 + \
                x1_2 * x6 * 1.3562862374229378570333893e-02 + \
                x1_2 * x5 * -3.5743490486809720296790260e-02 + \
                x1_2 * x4 * -1.2005268365691434961917139e-02 + \
                x1_2 * x3 * -1.1764951880420333046872727e-02 + \
                x1_2 * x2 * 4.2386285444565763302904315e-01 + \
                x1_3 * 2.5978896114774982506467893e-02 + \
                x0 * 1.3451992487668185116689301e-01 + \
                x0 * x7 * -4.9410197289306609369496925e-02 + \
                x0 * x7_2 * 3.2962035935108935369441951e-02 + \
                x0 * x6 * 1.6007521585211834103112949e-02 + \
                x0 * x6 * x7 * 5.6664671424247053943545893e-03 + \
                x0 * x6_2 * 1.5377036039550956436627871e-04 + \
                x0 * x5 * -5.4708469282214317042090101e-02 + \
                x0 * x5 * x7 * 1.1474979357347744879369600e-02 + \
                x0 * x5 * x6 * -2.0079083648525786198746346e-02 + \
                x0 * x5_2 * 4.3033485507004698433775047e-04 + \
                x0 * x4 * -4.5534897762204880333758439e-02 + \
                x0 * x4 * x7 * 1.5399604600282539718092423e-02 + \
                x0 * x4 * x6 * 4.4049819419382511831440041e-02 + \
                x0 * x4 * x5 * -5.6083886302980417992714024e-03 + \
                x0 * x4_2 * -3.5127873006243065523435121e-04 + \
                x0 * x3 * 7.8752671144435237859937615e-02 + \
                x0 * x3 * x7 * 5.1101990571636585203307845e-03 + \
                x0 * x3 * x6 * -6.9024543288968148724293883e-04 + \
                x0 * x3 * x5 * 1.8448341711415738863877323e-02 + \
                x0 * x3 * x4 * 2.3365183934421829281546934e-02 + \
                x0 * x3_2 * 2.7477003819287748598299004e-02 + \
                x0 * x2 * 1.3609665480914867607964425e-01 + \
                x0 * x2 * x7 * -1.1845504387576234750500959e-02 + \
                x0 * x2 * x6 * 7.3258351951484418362881001e-03 + \
                x0 * x2 * x5 * 1.4486920692753327277735309e-02 + \
                x0 * x2 * x4 * 3.3823265815655020882779525e-03 + \
                x0 * x2 * x3 * -1.2782501351687144963698017e-01 + \
                x0 * x2_2 * -8.9867228396574461157797487e-02 + \
                x0 * x1 * 9.5965454838147223881605896e-03 + \
                x0 * x1 * x7 * -6.2167664476202762202650121e-03 + \
                x0 * x1 * x6 * 2.8503087539544641471067621e-03 + \
                x0 * x1 * x5 * 1.3678642061056914269734364e-02 + \
                x0 * x1 * x4 * 2.3009749623690265579734060e-02 + \
                x0 * x1 * x3 * -6.0056549311985701899985202e-02 + \
                x0 * x1 * x2 * -9.3503929424880824483601316e-02 + \
                x0 * x1_2 * -8.3693923055962460288981219e-03 + \
                x0_2 * 6.5807326039725444477568317e-04 + \
                x0_2 * x7 * 9.4057516162236870504997910e-03 + \
                x0_2 * x6 * -3.8621782596251062746883775e-02 + \
                x0_2 * x5 * 3.3602466050131632457897979e-02 + \
                x0_2 * x4 * 5.8599372831992513344090412e-04 + \
                x0_2 * x3 * -4.7766101094973770213591990e-03 + \
                x0_2 * x2 * 1.9359784173159783060569339e-02 + \
                x0_2 * x1 * 3.3731377406238716165631786e-02 + \
                x0_3 * -2.0367370871175280444553835e-02
            output = output * 7.1494054892310032300883904e+02 + -1.2587311005030665000958834e+03
            HPA_UB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\HPA_UB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            HPA_UB_Con += output
            return HPA_UB_Con

        def TurbineCon8(m):
            return HPA_UB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                   m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.TurbineCon8 = Expression(rule=TurbineCon8)

        def TA_LB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 5.4538985105681014875500523e-01 + \
                x7 * 1.7645117657174205771930531e-02 + \
                x7_2 * -2.3513321274701959318065292e-02 + \
                x7_3 * 3.0534865581537812273538179e-03 + \
                x6 * 2.7018292012753158948257237e-02 + \
                x6 * x7 * -2.4261878716879806128225994e-02 + \
                x6 * x7_2 * 5.0544597375232480640505628e-03 + \
                x6_2 * -2.3942569672791069734785196e-02 + \
                x6_2 * x7 * 1.1149214460857127806381328e-02 + \
                x6_3 * 1.2746563275862932140825023e-02 + \
                x5 * -4.6009331922282320492811891e-02 + \
                x5 * x7 * 1.4065152868892719095761379e-02 + \
                x5 * x7_2 * -8.0189254613253352355073389e-03 + \
                x5 * x6 * 3.9317971488037617433519699e-03 + \
                x5 * x6 * x7 * 2.8383102712739582962342411e-04 + \
                x5 * x6_2 * 1.1611180128010371859215155e-02 + \
                x5_2 * 3.1068832921438985228412832e-02 + \
                x5_2 * x7 * -1.0101964765914427102355688e-02 + \
                x5_2 * x6 * -1.8744051610247836059386373e-02 + \
                x5_3 * 8.7053124977785611982028513e-03 + \
                x4 * -1.2868301273187068844983116e-02 + \
                x4 * x7 * -3.1683608983023733851602799e-02 + \
                x4 * x7_2 * -9.0308861620456981622595549e-04 + \
                x4 * x6 * 9.5583417437406503758268173e-03 + \
                x4 * x6 * x7 * -3.0259407707901170292430493e-03 + \
                x4 * x6_2 * -1.9493127414380355399980971e-02 + \
                x4 * x5 * 2.8915061541037477554905166e-02 + \
                x4 * x5 * x7 * 1.8529370149980788073929006e-02 + \
                x4 * x5 * x6 * 1.0661376573707914694466581e-02 + \
                x4 * x5_2 * -6.7329940863474768697471973e-03 + \
                x4_2 * -1.3029136234015976925082470e-02 + \
                x4_2 * x7 * 1.3677777893211284787611248e-02 + \
                x4_2 * x6 * -1.5214436367641685776685989e-02 + \
                x4_2 * x5 * -8.9597508298870573439920406e-03 + \
                x4_3 * 1.8566549284786362794541503e-02 + \
                x3 * 1.5534773936392415327745198e-01 + \
                x3 * x7 * -1.9415155287643780235296020e-02 + \
                x3 * x7_2 * 1.5993214046131423722307829e-03 + \
                x3 * x6 * -3.5319295929769053965507908e-02 + \
                x3 * x6 * x7 * 9.5673312489252294865682558e-03 + \
                x3 * x6_2 * 1.1979290432292757223597945e-02 + \
                x3 * x5 * -2.8257794351943810173821703e-02 + \
                x3 * x5 * x7 * -5.5249876726253567549296264e-03 + \
                x3 * x5 * x6 * 3.8506819697485747400200751e-03 + \
                x3 * x5_2 * -1.7805624990462481926911664e-03 + \
                x3 * x4 * 3.6131670255622971854592151e-02 + \
                x3 * x4 * x7 * -1.3081364655345553704712813e-02 + \
                x3 * x4 * x6 * -8.3577936969779602349728265e-03 + \
                x3 * x4 * x5 * 1.1087152396671413889794877e-02 + \
                x3 * x4_2 * -8.2286551234366234197636913e-03 + \
                x3_2 * -9.2327732119085625939192141e-02 + \
                x3_2 * x7 * 1.0162417783538435500645392e-02 + \
                x3_2 * x6 * 2.5039475441540781641691638e-02 + \
                x3_2 * x5 * -1.9856019797056811970747958e-03 + \
                x3_2 * x4 * -1.7051056298717635895112466e-02 + \
                x3_3 * -1.2300815196497005832299010e-02 + \
                x2 * 1.3044721326877155576084988e+00 + \
                x2 * x7 * 3.7590130213863301444909837e-02 + \
                x2 * x7_2 * -3.2542640796097786065610435e-03 + \
                x2 * x6 * 3.5615933656832216014365144e-03 + \
                x2 * x6 * x7 * 1.1172785760641974067697291e-03 + \
                x2 * x6_2 * -1.0485911243347904864275932e-03 + \
                x2 * x5 * 4.4858353247357631021774438e-02 + \
                x2 * x5 * x7 * -4.9348814917709368094156375e-03 + \
                x2 * x5 * x6 * 5.9360093683035412143178533e-03 + \
                x2 * x5_2 * -2.7762987372846062439357695e-02 + \
                x2 * x4 * 2.4226651103932926589745733e-02 + \
                x2 * x4 * x7 * 1.0085331635185419349443059e-02 + \
                x2 * x4 * x6 * 1.3372812043441928420151044e-02 + \
                x2 * x4 * x5 * -2.6446400068133327221353568e-02 + \
                x2 * x4_2 * -3.1618212491154942811455442e-03 + \
                x2 * x3 * -1.8805966799545498213674932e-01 + \
                x2 * x3 * x7 * 5.2118561920796828423885216e-04 + \
                x2 * x3 * x6 * -1.1641140205804357404817395e-02 + \
                x2 * x3 * x5 * 2.5717846890728476155763005e-02 + \
                x2 * x3 * x4 * -1.1455463148096561853961362e-02 + \
                x2 * x3_2 * 8.9456612744110264312524805e-02 + \
                x2_2 * -1.2035838671813716693748120e+00 + \
                x2_2 * x7 * -1.1740679214364162230577193e-02 + \
                x2_2 * x6 * -1.1291893397575705759727782e-02 + \
                x2_2 * x5 * -6.7662896535049601998146329e-03 + \
                x2_2 * x4 * -4.8145333518793687055392638e-03 + \
                x2_2 * x3 * 5.7188754425838463080200569e-02 + \
                x2_3 * 3.3932294478293034689642127e-01 + \
                x1 * -1.1776158245875519015033461e-01 + \
                x1 * x7 * 2.7973350078165801213536668e-02 + \
                x1 * x7_2 * 2.1362855557106111281662209e-02 + \
                x1 * x6 * -1.5056320537506523438153749e-02 + \
                x1 * x6 * x7 * 3.4061958276716264304440074e-03 + \
                x1 * x6_2 * -8.5047729645921100322114583e-03 + \
                x1 * x5 * 6.6041071655887517710681323e-02 + \
                x1 * x5 * x7 * -1.0357025006415897933065295e-02 + \
                x1 * x5 * x6 * -2.9273487891906674329689508e-03 + \
                x1 * x5_2 * -1.5882808302266192973517533e-02 + \
                x1 * x4 * 2.6548616779992567638046808e-02 + \
                x1 * x4 * x7 * 6.0049432071211314432268580e-03 + \
                x1 * x4 * x6 * 2.5869032191988875456212238e-03 + \
                x1 * x4 * x5 * -2.8544509654515413249464828e-02 + \
                x1 * x4_2 * -3.7441048611873573720432162e-03 + \
                x1 * x3 * -8.9165928859263068884111192e-02 + \
                x1 * x3 * x7 * 1.6277335882571644654071008e-02 + \
                x1 * x3 * x6 * 8.0977002138673224995724098e-03 + \
                x1 * x3 * x5 * 1.6763794722929825642410151e-02 + \
                x1 * x3 * x4 * -5.1979786155781845802259511e-03 + \
                x1 * x3_2 * 3.9205505145281108192456543e-02 + \
                x1 * x2 * -1.4379909379776041333798275e+00 + \
                x1 * x2 * x7 * -3.5317869573987817344296047e-02 + \
                x1 * x2 * x6 * 6.2369713910174501975136607e-03 + \
                x1 * x2 * x5 * -1.9630987833618714771821701e-02 + \
                x1 * x2 * x4 * -1.2756153321671778733126246e-02 + \
                x1 * x2 * x3 * 6.3810632951064927276263461e-02 + \
                x1 * x2_2 * 7.2637987967494044294625155e-01 + \
                x1_2 * -2.6650191924571525747822420e-01 + \
                x1_2 * x7 * -2.9817291615455474018681059e-02 + \
                x1_2 * x6 * 9.9225596909205959761379745e-03 + \
                x1_2 * x5 * -2.5835981227514681624057857e-02 + \
                x1_2 * x4 * -8.6588249711931596086511576e-03 + \
                x1_2 * x3 * -8.8380875626811669643068115e-03 + \
                x1_2 * x2 * 3.0715460740316236076807854e-01 + \
                x1_3 * 1.8881970002665657282214795e-02 + \
                x0 * -1.9192827954108235277708161e-01 + \
                x0 * x7 * -3.5784365299297876683581876e-02 + \
                x0 * x7_2 * 2.3854028291355397484174716e-02 + \
                x0 * x6 * 1.1614787423266964561108239e-02 + \
                x0 * x6 * x7 * 4.1468056322707365704549609e-03 + \
                x0 * x6_2 * 6.8951358700964152093071391e-05 + \
                x0 * x5 * -3.9551041323247188019607279e-02 + \
                x0 * x5 * x7 * 8.2838965068713424355628661e-03 + \
                x0 * x5 * x6 * -1.4515433511334899230327267e-02 + \
                x0 * x5_2 * 2.5388194706370270647965981e-04 + \
                x0 * x4 * -3.2974381214900636005715739e-02 + \
                x0 * x4 * x7 * 1.1198128732326251624784597e-02 + \
                x0 * x4 * x6 * 3.1973324808458498946794890e-02 + \
                x0 * x4 * x5 * -4.1480692556242690360868153e-03 + \
                x0 * x4_2 * -2.2520400270234670891955631e-04 + \
                x0 * x3 * 5.7889540447317811011629374e-02 + \
                x0 * x3 * x7 * 3.6578346606997644285819149e-03 + \
                x0 * x3 * x6 * -5.0291019186533489349066883e-04 + \
                x0 * x3 * x5 * 1.3429487299915478237810618e-02 + \
                x0 * x3 * x4 * 1.6882614632603432092139428e-02 + \
                x0 * x3_2 * 1.9692974440964156057631840e-02 + \
                x0 * x2 * 1.5867145649956368447242028e-01 + \
                x0 * x2 * x7 * -8.5931755733039561634400982e-03 + \
                x0 * x2 * x6 * 5.2110061545484823164464672e-03 + \
                x0 * x2 * x5 * 1.0483988629640665635189833e-02 + \
                x0 * x2 * x4 * 2.4416086644247908532534552e-03 + \
                x0 * x2 * x3 * -9.3121836844196420601704745e-02 + \
                x0 * x2_2 * -6.4685239776707453840387529e-02 + \
                x0 * x1 * -3.7868692486340782554776752e-02 + \
                x0 * x1 * x7 * -4.5766757318875077309439092e-03 + \
                x0 * x1 * x6 * 2.0276416089378829221701039e-03 + \
                x0 * x1 * x5 * 9.8883340877697206705576605e-03 + \
                x0 * x1 * x4 * 1.6652820740408039168478638e-02 + \
                x0 * x1 * x3 * -4.3929621384954320451043941e-02 + \
                x0 * x1 * x2 * -6.7185551992494707551628608e-02 + \
                x0 * x1_2 * -5.9558151292248007191432180e-03 + \
                x0_2 * 2.9393316688797188618309519e-04 + \
                x0_2 * x7 * 6.8660585884092878439233232e-03 + \
                x0_2 * x6 * -2.7948366567478989674899736e-02 + \
                x0_2 * x5 * 2.4335197304602831924746908e-02 + \
                x0_2 * x4 * 4.2321238641353925435950600e-04 + \
                x0_2 * x3 * -3.4402569080707115500850080e-03 + \
                x0_2 * x2 * 1.4110557990759636792788001e-02 + \
                x0_2 * x1 * 2.4515849516507794148001409e-02 + \
                x0_3 * -1.4753617402332198926817597e-02
            output = output * 4.7037200139816161481576273e+02 + -3.0161873132551204435003456e+02
            TA_LB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\TA_LB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            TA_LB_Con += output
            return TA_LB_Con

        def TurbineCon9(m):
            return TA_LB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                  m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.TurbineCon9 = Expression(rule=TurbineCon9)

        def TA_UB_Con_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 4.5461014894318857448851645e-01 + \
                x7 * -1.7645117657175392322788099e-02 + \
                x7_2 * 2.3513321274704401808719467e-02 + \
                x7_3 * -3.0534865581545861390466712e-03 + \
                x6 * -2.7018292012749883790334593e-02 + \
                x6 * x7 * 2.4261878716877918749084131e-02 + \
                x6 * x7_2 * -5.0544597375229843860822143e-03 + \
                x6_2 * 2.3942569672790681156726578e-02 + \
                x6_2 * x7 * -1.1149214460856524122611688e-02 + \
                x6_3 * -1.2746563275863653785791030e-02 + \
                x5 * 4.6009331922283208671231591e-02 + \
                x5 * x7 * -1.4065152868893260329485884e-02 + \
                x5 * x7_2 * 8.0189254613253976855524741e-03 + \
                x5 * x6 * -3.9317971488092573473238645e-03 + \
                x5 * x6 * x7 * -2.8383102712729868510876940e-04 + \
                x5 * x6_2 * -1.1611180128007932838007932e-02 + \
                x5_2 * -3.1068832921439158700760430e-02 + \
                x5_2 * x7 * 1.0101964765915162625109502e-02 + \
                x5_2 * x6 * 1.8744051610249889971981929e-02 + \
                x5_3 * -8.7053124977787277316565451e-03 + \
                x4 * 1.2868301273187634364836285e-02 + \
                x4 * x7 * 3.1683608983025551841805623e-02 + \
                x4 * x7_2 * 9.0308861620359143218550457e-04 + \
                x4 * x6 * -9.5583417437417605988514424e-03 + \
                x4 * x6 * x7 * 3.0259407707917407304165636e-03 + \
                x4 * x6_2 * 1.9493127414380549689010280e-02 + \
                x4 * x5 * -2.8915061541035229353280300e-02 + \
                x4 * x5 * x7 * -1.8529370149981298082630943e-02 + \
                x4 * x5 * x6 * -1.0661376573708532256024029e-02 + \
                x4 * x5_2 * 6.7329940863455339794541032e-03 + \
                x4_2 * 1.3029136234017121842576614e-02 + \
                x4_2 * x7 * -1.3677777893211437443277134e-02 + \
                x4_2 * x6 * 1.5214436367641621591917378e-02 + \
                x4_2 * x5 * 8.9597508298866271325699984e-03 + \
                x4_3 * -1.8566549284787053214484942e-02 + \
                x3 * -1.5534773936392487492241798e-01 + \
                x3 * x7 * 1.9415155287644765558230375e-02 + \
                x3 * x7_2 * -1.5993214046140930006956182e-03 + \
                x3 * x6 * 3.5319295929767013930700159e-02 + \
                x3 * x6 * x7 * -9.5673312489249536655355755e-03 + \
                x3 * x6_2 * -1.1979290432292160478722209e-02 + \
                x3 * x5 * 2.8257794351944087729577859e-02 + \
                x3 * x5 * x7 * 5.5249876726251867520289807e-03 + \
                x3 * x5 * x6 * -3.8506819697478669728418765e-03 + \
                x3 * x5_2 * 1.7805624990460816592374726e-03 + \
                x3 * x4 * -3.6131670255623360432650770e-02 + \
                x3 * x4 * x7 * 1.3081364655345241454487137e-02 + \
                x3 * x4 * x6 * 8.3577936969789212717785176e-03 + \
                x3 * x4 * x5 * -1.1087152396670837961600853e-02 + \
                x3 * x4_2 * 8.2286551234365540308246523e-03 + \
                x3_2 * 9.2327732119085723083706796e-02 + \
                x3_2 * x7 * -1.0162417783539157145611398e-02 + \
                x3_2 * x6 * -2.5039475441540556127639761e-02 + \
                x3_2 * x5 * 1.9856019797057922193772583e-03 + \
                x3_2 * x4 * 1.7051056298717209153137375e-02 + \
                x3_3 * 1.2300815196497547066023515e-02 + \
                x2 * -1.3044721326877160016977086e+00 + \
                x2 * x7 * -3.7590130213861643049266803e-02 + \
                x2 * x7_2 * 3.2542640796095591640413325e-03 + \
                x2 * x6 * -3.5615933656826526121363941e-03 + \
                x2 * x6 * x7 * -1.1172785760639536781213543e-03 + \
                x2 * x6_2 * 1.0485911243345406862470526e-03 + \
                x2 * x5 * -4.4858353247359074311706451e-02 + \
                x2 * x5 * x7 * 4.9348814917705655785917784e-03 + \
                x2 * x5 * x6 * -5.9360093683033451905650679e-03 + \
                x2 * x5_2 * 2.7762987372846728573172470e-02 + \
                x2 * x4 * -2.4226651103932031472432129e-02 + \
                x2 * x4 * x7 * -1.0085331635185584148173277e-02 + \
                x2 * x4 * x6 * -1.3372812043442081075816930e-02 + \
                x2 * x4 * x5 * 2.6446400068132962929423613e-02 + \
                x2 * x4_2 * 3.1618212491156556104288100e-03 + \
                x2 * x3 * 1.8805966799545567602613971e-01 + \
                x2 * x3 * x7 * -5.2118561920802899956051135e-04 + \
                x2 * x3 * x6 * 1.1641140205804787616239437e-02 + \
                x2 * x3 * x5 * -2.5717846890728604525300227e-02 + \
                x2 * x3 * x4 * 1.1455463148096223582883546e-02 + \
                x2 * x3_2 * -8.9456612744110874935188349e-02 + \
                x2_2 * 1.2035838671813723355086267e+00 + \
                x2_2 * x7 * 1.1740679214363700794132583e-02 + \
                x2_2 * x6 * 1.1291893397575025748125199e-02 + \
                x2_2 * x5 * 6.7662896535056263336294080e-03 + \
                x2_2 * x4 * 4.8145333518787788995574317e-03 + \
                x2_2 * x3 * -5.7188754425838032868778527e-02 + \
                x2_3 * -3.3932294478293034689642127e-01 + \
                x1 * 1.1776158245875610608432993e-01 + \
                x1 * x7 * -2.7973350078165495902204896e-02 + \
                x1 * x7_2 * -2.1362855557106638637598905e-02 + \
                x1 * x6 * 1.5056320537505413215129124e-02 + \
                x1 * x6 * x7 * -3.4061958276717790861098933e-03 + \
                x1 * x6_2 * 8.5047729645927536146210457e-03 + \
                x1 * x5 * -6.6041071655887351177227629e-02 + \
                x1 * x5 * x7 * 1.0357025006416230999972683e-02 + \
                x1 * x5 * x6 * 2.9273487891908565178278323e-03 + \
                x1 * x5_2 * 1.5882808302266380323652939e-02 + \
                x1 * x4 * -2.6548616779993899905676358e-02 + \
                x1 * x4 * x7 * -6.0049432071224081997051769e-03 + \
                x1 * x4 * x6 * -2.5869032191989981342428173e-03 + \
                x1 * x4 * x5 * 2.8544509654515843460886870e-02 + \
                x1 * x4_2 * 3.7441048611878136043173981e-03 + \
                x1 * x3 * 8.9165928859264415029528550e-02 + \
                x1 * x3 * x7 * -1.6277335882571609959601489e-02 + \
                x1 * x3 * x6 * -8.0977002138668610631278000e-03 + \
                x1 * x3 * x5 * -1.6763794722930460551202358e-02 + \
                x1 * x3 * x4 * 5.1979786155787136708861240e-03 + \
                x1 * x3_2 * -3.9205505145281996370876243e-02 + \
                x1 * x2 * 1.4379909379776032452014078e+00 + \
                x1 * x2 * x7 * 3.5317869573987727138675297e-02 + \
                x1 * x2 * x6 * -6.2369713910167077358659427e-03 + \
                x1 * x2 * x5 * 1.9630987833618957633108337e-02 + \
                x1 * x2 * x4 * 1.2756153321672430989153213e-02 + \
                x1 * x2 * x3 * -6.3810632951066051377075894e-02 + \
                x1 * x2_2 * -7.2637987967493988783473924e-01 + \
                x1_2 * 2.6650191924571475787786312e-01 + \
                x1_2 * x7 * 2.9817291615455467079787155e-02 + \
                x1_2 * x6 * -9.9225596909208180207428995e-03 + \
                x1_2 * x5 * 2.5835981227514601826777962e-02 + \
                x1_2 * x4 * 8.6588249711935239005811127e-03 + \
                x1_2 * x3 * 8.8380875626812779866092740e-03 + \
                x1_2 * x2 * -3.0715460740316186116771746e-01 + \
                x1_3 * -1.8881970002665643404426987e-02 + \
                x0 * 1.9192827954108374055586239e-01 + \
                x0 * x7 * 3.5784365299296377882498632e-02 + \
                x0 * x7_2 * -2.3854028291354606450269671e-02 + \
                x0 * x6 * -1.1614787423268380095464636e-02 + \
                x0 * x6 * x7 * -4.1468056322707834079888123e-03 + \
                x0 * x6_2 * -6.8951358700240338722720068e-05 + \
                x0 * x5 * 3.9551041323246854952699891e-02 + \
                x0 * x5 * x7 * -8.2838965068707526295810339e-03 + \
                x0 * x5 * x6 * 1.4515433511335541078013378e-02 + \
                x0 * x5_2 * -2.5388194706410516232608643e-04 + \
                x0 * x4 * 3.2974381214899470271539883e-02 + \
                x0 * x4 * x7 * -1.1198128732326225603932457e-02 + \
                x0 * x4 * x6 * -3.1973324808458492007900986e-02 + \
                x0 * x4 * x5 * 4.1480692556249351699015904e-03 + \
                x0 * x4_2 * 2.2520400270256528407752938e-04 + \
                x0 * x3 * -5.7889540447318782456775921e-02 + \
                x0 * x3 * x7 * -3.6578346606989387002073499e-03 + \
                x0 * x3 * x6 * 5.0291019186560204090596926e-04 + \
                x0 * x3 * x5 * -1.3429487299915957021489987e-02 + \
                x0 * x3 * x4 * -1.6882614632603244742004023e-02 + \
                x0 * x3_2 * -1.9692974440963538496074392e-02 + \
                x0 * x2 * -1.5867145649956354569454220e-01 + \
                x0 * x2 * x7 * 8.5931755733036491173848503e-03 + \
                x0 * x2 * x6 * -5.2110061545482255773720226e-03 + \
                x0 * x2 * x5 * -1.0483988629639874601284788e-02 + \
                x0 * x2 * x4 * -2.4416086644247630976778396e-03 + \
                x0 * x2 * x3 * 9.3121836844196309579402282e-02 + \
                x0 * x2_2 * 6.4685239776707315062509451e-02 + \
                x0 * x1 * 3.7868692486341420933015911e-02 + \
                x0 * x1 * x7 * 4.5766757318881842730995402e-03 + \
                x0 * x1 * x6 * -2.0276416089373416884455992e-03 + \
                x0 * x1 * x5 * -9.8883340877698698567765945e-03 + \
                x0 * x1 * x4 * -1.6652820740407796307192001e-02 + \
                x0 * x1 * x3 * 4.3929621384954625762375713e-02 + \
                x0 * x1 * x2 * 6.7185551992494804696143262e-02 + \
                x0 * x1_2 * 5.9558151292239576435338932e-03 + \
                x0_2 * -2.9393316688861026442225466e-04 + \
                x0_2 * x7 * -6.8660585884094751940587287e-03 + \
                x0_2 * x6 * 2.7948366567478802324764331e-02 + \
                x0_2 * x5 * -2.4335197304602984580412794e-02 + \
                x0_2 * x4 * -4.2321238641294944837767389e-04 + \
                x0_2 * x3 * 3.4402569080708156334935666e-03 + \
                x0_2 * x2 * -1.4110557990758908208928091e-02 + \
                x0_2 * x1 * -2.4515849516507842720258736e-02 + \
                x0_3 * 1.4753617402332898020378416e-02
            output = output * 4.7037200139816150112892501e+02 + -1.2814232700726493021647912e+03
            TA_UB_Con = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\TA_UB_Con", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            TA_UB_Con += output
            return TA_UB_Con

        def TurbineCon10(m):
            return TA_UB_Con_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                                  m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.TurbineCon10 = Expression(rule=TurbineCon10)

        def OverallHeatCon_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio,
                                vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 7.0464130382578993305742188e-01 + \
                x7 * -3.8441942728504446824544516e-01 + \
                x7_2 * 2.7136049590676669662769882e-02 + \
                x7_3 * -8.4622719682848485112103276e-03 + \
                x6 * -2.6171980494162860875206889e-02 + \
                x6 * x7 * 2.2641755350404815794185254e-02 + \
                x6 * x7_2 * -6.8664747500070399954807954e-03 + \
                x6_2 * 2.5013604223241558965895592e-02 + \
                x6_2 * x7 * -7.6131736794350923780427820e-03 + \
                x6_3 * -1.6237739489724400954173689e-02 + \
                x5 * 3.7445318905700131217884064e-02 + \
                x5 * x7 * -9.3734927963187650301613019e-03 + \
                x5 * x7_2 * 1.0147917408512202586123863e-02 + \
                x5 * x6 * -5.1366335445890420885461936e-05 + \
                x5 * x6 * x7 * 5.7274314835837432033360805e-04 + \
                x5 * x6_2 * -1.0274383242541561267469064e-02 + \
                x5_2 * -2.2951907883593455905746339e-02 + \
                x5_2 * x7 * 9.8759328479696428804146535e-03 + \
                x5_2 * x6 * 1.3610188035465473066487618e-02 + \
                x5_3 * -9.7096021851128117008400409e-03 + \
                x4 * 6.7200164524319414005582018e-03 + \
                x4 * x7 * 3.5007163692322651460386851e-02 + \
                x4 * x7_2 * 1.8944163678923089597083695e-03 + \
                x4 * x6 * -4.3981602624022439473883139e-03 + \
                x4 * x6 * x7 * 2.2563403753448748809140589e-03 + \
                x4 * x6_2 * 1.8896591094420496503847318e-02 + \
                x4 * x5 * -3.3872356061269620619569309e-02 + \
                x4 * x5 * x7 * -1.6612840226616368277667846e-02 + \
                x4 * x5 * x6 * -7.6892439505657494969170784e-03 + \
                x4 * x5_2 * 6.0902374516831891959611767e-03 + \
                x4_2 * 1.1876056383409629851888312e-02 + \
                x4_2 * x7 * -1.7086537905240194168410284e-02 + \
                x4_2 * x6 * 8.4835980269737168435462138e-03 + \
                x4_2 * x5 * 1.0872608578243785071304472e-02 + \
                x4_3 * -1.2946443079258379560414483e-02 + \
                x3 * -1.6600664655395355739919694e-01 + \
                x3 * x7 * -2.0235331034549983164616549e-02 + \
                x3 * x7_2 * -2.6902275015643906108664396e-03 + \
                x3 * x6 * 3.3369865359386199910041171e-02 + \
                x3 * x6 * x7 * -1.3732800236582645703187211e-02 + \
                x3 * x6_2 * -6.3575457735827907435055550e-03 + \
                x3 * x5 * 2.6472457030084484835841252e-02 + \
                x3 * x5 * x7 * 2.4411266843209992322139001e-03 + \
                x3 * x5 * x6 * -2.7617078816986329048432935e-03 + \
                x3 * x5_2 * 2.5151867151284174051184550e-03 + \
                x3 * x4 * -2.5394315160305991341260778e-02 + \
                x3 * x4 * x7 * 7.9814169220754627165348438e-03 + \
                x3 * x4 * x6 * 6.1191891079910992745638509e-03 + \
                x3 * x4 * x5 * -1.0392639669771296107025904e-02 + \
                x3 * x4_2 * 6.3187724485969445908928321e-03 + \
                x3_2 * 7.7262857482394003971748475e-02 + \
                x3_2 * x7 * 3.0541793850989013003882633e-03 + \
                x3_2 * x6 * -2.5084778717558795652076142e-02 + \
                x3_2 * x5 * 1.3626213364498485081099943e-03 + \
                x3_2 * x4 * 1.6574118731943181942467547e-02 + \
                x3_3 * 9.5071223051808925047501120e-03 + \
                x2 * -5.9941458548324388910799598e-01 + \
                x2 * x7 * -8.3584213983281432924776766e-02 + \
                x2 * x7_2 * 6.1429311945871917580164201e-03 + \
                x2 * x6 * -8.3994666530887440725194892e-03 + \
                x2 * x6 * x7 * -1.4607460407591724756842799e-03 + \
                x2 * x6_2 * 2.6599860683310539571921893e-03 + \
                x2 * x5 * -3.7219449385677852437659396e-02 + \
                x2 * x5 * x7 * -2.3767564412137311830042208e-03 + \
                x2 * x5 * x6 * -4.9540170382895015732671595e-03 + \
                x2 * x5_2 * 2.4181571326741507776958429e-02 + \
                x2 * x4 * -1.6331096848276001332056495e-02 + \
                x2 * x4 * x7 * -8.8965769237554521292610232e-03 + \
                x2 * x4 * x6 * -1.1255915399130220211354469e-02 + \
                x2 * x4 * x5 * 2.6548895299491660076940391e-02 + \
                x2 * x4_2 * 9.0824702339489457592058841e-04 + \
                x2 * x3 * 1.5932918050731242898265805e-01 + \
                x2 * x3 * x7 * 1.7325893927566306945697860e-02 + \
                x2 * x3 * x6 * 1.0388188747142437784454216e-02 + \
                x2 * x3 * x5 * -2.2296545851910626323544307e-02 + \
                x2 * x3 * x4 * 7.2639102994580331817964236e-03 + \
                x2 * x3_2 * -7.7292194400299815693067274e-02 + \
                x2_2 * 1.0055256786255795109497058e+00 + \
                x2_2 * x7 * 1.2414068535110017732492338e-01 + \
                x2_2 * x6 * 1.1095926630839933121897012e-02 + \
                x2_2 * x5 * 4.4176420805650835205158344e-03 + \
                x2_2 * x4 * 2.0886673407236391875052561e-03 + \
                x2_2 * x3 * -5.5018731028453768394648193e-02 + \
                x2_3 * -2.9311935872085925769425785e-01 + \
                x1 * -2.6207332134123534350678142e-01 + \
                x1 * x7 * -6.1631579616945958433049668e-02 + \
                x1 * x7_2 * -1.9990240150123378404245500e-02 + \
                x1 * x6 * 1.0190586200969409258476617e-02 + \
                x1 * x6 * x7 * -7.7370995115912111206313284e-04 + \
                x1 * x6_2 * 6.4087984432248910893203941e-03 + \
                x1 * x5 * -5.8759902432822558315805850e-02 + \
                x1 * x5 * x7 * 6.2834756417488096466583691e-03 + \
                x1 * x5 * x6 * 3.0828667925461607224324467e-03 + \
                x1 * x5_2 * 1.3176543352011070228679834e-02 + \
                x1 * x4 * -2.4843046127201950934448860e-02 + \
                x1 * x4 * x7 * -2.1931069887387300010317404e-03 + \
                x1 * x4 * x6 * -2.6459939673121120502774506e-03 + \
                x1 * x4 * x5 * 2.6216113294277469669690817e-02 + \
                x1 * x4_2 * -1.0247685758171323766596572e-03 + \
                x1 * x3 * 7.0678992484384584038537014e-02 + \
                x1 * x3 * x7 * -3.3003012822973437634388461e-03 + \
                x1 * x3 * x6 * -8.2735940369800461957616733e-03 + \
                x1 * x3 * x5 * -1.5737720125538923188202034e-02 + \
                x1 * x3 * x4 * 3.9796197563660776208571690e-03 + \
                x1 * x3_2 * -3.5829431388849988793232626e-02 + \
                x1 * x2 * 1.1926823753471496036837607e+00 + \
                x1 * x2 * x7 * 1.7450593076614467902274441e-01 + \
                x1 * x2 * x6 * -3.7525935105175486222739423e-03 + \
                x1 * x2 * x5 * 1.7078937468065512328418976e-02 + \
                x1 * x2 * x4 * 1.1156268365183220903080752e-02 + \
                x1 * x2 * x3 * -5.5132802212483886239446917e-02 + \
                x1 * x2_2 * -6.3298767399450239778957439e-01 + \
                x1_2 * 2.1161448202711952149002173e-01 + \
                x1_2 * x7 * 6.8411877760668454717674081e-02 + \
                x1_2 * x6 * -7.3885320731597939336587899e-03 + \
                x1_2 * x5 * 2.5942364829911232493309114e-02 + \
                x1_2 * x4 * 1.0646918161771067035115124e-02 + \
                x1_2 * x3 * 9.7002137103804463719169959e-03 + \
                x1_2 * x2 * -2.6400700139089300355621504e-01 + \
                x1_3 * -1.8822186828550760417932963e-02 + \
                x0 * -1.6231319115025519272954568e-01 + \
                x0 * x7 * 3.0459004651785786393913824e-03 + \
                x0 * x7_2 * -2.1718092728988232231746025e-02 + \
                x0 * x6 * -2.2709262794347803704475552e-03 + \
                x0 * x6 * x7 * -1.9003243048303086748518353e-03 + \
                x0 * x6_2 * -3.2228979967074133927695812e-03 + \
                x0 * x5 * 3.8283834009022438271685473e-02 + \
                x0 * x5 * x7 * -8.1762222600452114096292178e-03 + \
                x0 * x5 * x6 * 7.1848210386477873168331598e-03 + \
                x0 * x5_2 * -8.1768132266397258733903186e-04 + \
                x0 * x4 * 3.3273053857116027809404102e-02 + \
                x0 * x4 * x7 * -1.3217186725232279304043104e-02 + \
                x0 * x4 * x6 * -3.0693888281532716311161835e-02 + \
                x0 * x4 * x5 * 6.1272216670164303398138372e-03 + \
                x0 * x4_2 * 2.3783005212287128271597680e-03 + \
                x0 * x3 * -4.1025592729560009241929208e-02 + \
                x0 * x3 * x7 * -9.7680447560652156752114550e-03 + \
                x0 * x3 * x6 * -8.8531719071816006305652991e-04 + \
                x0 * x3 * x5 * -1.2305954259896410840635639e-02 + \
                x0 * x3 * x4 * -1.9723105577256136444752599e-02 + \
                x0 * x3_2 * -1.5572866353346516421485290e-02 + \
                x0 * x2 * -9.1938279114934434721462253e-02 + \
                x0 * x2 * x7 * 2.0950806353075602378455145e-02 + \
                x0 * x2 * x6 * -2.6276558448068143558629117e-03 + \
                x0 * x2 * x5 * -7.8317933089618735342796185e-03 + \
                x0 * x2 * x4 * -6.1006858142472683570467495e-03 + \
                x0 * x2 * x3 * 8.2488380617695131191702274e-02 + \
                x0 * x2_2 * 6.0644712251053681240087201e-02 + \
                x0 * x1 * -1.4966057111713240712624895e-02 + \
                x0 * x1 * x7 * 8.8493540663964961878740212e-03 + \
                x0 * x1 * x6 * 8.6868695308475740723963554e-04 + \
                x0 * x1 * x5 * -1.0250201156936526725171888e-02 + \
                x0 * x1 * x4 * -1.3031515815617355363853491e-02 + \
                x0 * x1 * x3 * 4.0691282388146253479188630e-02 + \
                x0 * x1 * x2 * 6.2869489150597007709464492e-02 + \
                x0 * x1_2 * 5.7663057764793176906970018e-03 + \
                x0_2 * 9.5481752594753256657700291e-03 + \
                x0_2 * x7 * -7.5697766876766554855482383e-03 + \
                x0_2 * x6 * 2.1951305406900295524863509e-02 + \
                x0_2 * x5 * -2.2257971822483374468859552e-02 + \
                x0_2 * x4 * -1.2192810464085462873740084e-03 + \
                x0_2 * x3 * -2.3403582164876549076559797e-03 + \
                x0_2 * x2 * -1.5426773467312610010893081e-02 + \
                x0_2 * x1 * -2.1569440727447111716408301e-02 + \
                x0_3 * 1.1162927347531714783457346e-02
            output = output * 8.2685246047215443104505539e+05 + -2.0090080615368857979774475e+06
            OverallHeatCon = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\OverallHeatCon", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            OverallHeatCon += output
            return OverallHeatCon

        def OverallHeatBlnc(m):
            return OverallHeatCon_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio,
                                       m.HPCCondPrdtMFlow, m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio,
                                       m.OxSplitterOutARatio)

        test_model.OverallHeatBlnc = Expression(rule=OverallHeatBlnc)

        def cost_func(vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac):
            x0 = (vFeedMFlow - 3.8000061232998186824261211e+03) / 3.9986987118296110566006973e+02
            x1 = (vTAFeedFrac - 1.5002136389015502393462498e-01) / 9.9974709407746747968914747e-02
            x2 = (vMAFeedFrac - 4.5003065255397189936559244e-01) / 1.4993556436844535095787023e-01
            x3 = (v40_LIN - 1.2000059934878624972043326e+03) / 2.9986921867382420714420732e+02
            x4 = (v52_WN - 1.6001165534752301482512848e+03) / 2.9980238920159558801969979e+02
            x5 = (v47_ARC - 6.0003811232404575548571302e+02) / 9.9932696623773267674550880e+01
            x6 = (vASC_RefluxRatio - 2.5001626041831624291944536e+01) / 4.9976734821254638063692255e+00
            x7 = (vLOX_Frac - 7.0012377067897688109887611e-02) / 2.9978946475558168605068943e-02
            x0_2 = x0 * x0
            x0_3 = x0_2 * x0
            x1_2 = x1 * x1
            x1_3 = x1_2 * x1
            x2_2 = x2 * x2
            x2_3 = x2_2 * x2
            x3_2 = x3 * x3
            x3_3 = x3_2 * x3
            x4_2 = x4 * x4
            x4_3 = x4_2 * x4
            x5_2 = x5 * x5
            x5_3 = x5_2 * x5
            x6_2 = x6 * x6
            x6_3 = x6_2 * x6
            x7_2 = x7 * x7
            x7_3 = x7_2 * x7
            output = \
                1 * 4.1917826021554110971223395e-01 + \
                x7 * -2.5707531736284483514509702e-01 + \
                x7_2 * -5.9845582441351991009881317e-03 + \
                x7_3 * -1.2841334241956593037459200e-03 + \
                x6 * 1.0776105587339351865594494e-02 + \
                x6 * x7 * -8.9759886820167666954262131e-03 + \
                x6 * x7_2 * 1.1363395037639889562086637e-03 + \
                x6_2 * -8.5116907447737588654490537e-03 + \
                x6_2 * x7 * 6.2566080352598058000879178e-03 + \
                x6_3 * 1.8133308995024709220356129e-03 + \
                x5 * -1.4259553224364406726065724e-02 + \
                x5 * x7 * 7.7872835752130636910450789e-03 + \
                x5 * x7_2 * 1.1014091147816887361621241e-03 + \
                x5 * x6 * 1.3032042032812551912712706e-03 + \
                x5 * x6 * x7 * -2.8352174793375845007759040e-04 + \
                x5 * x6_2 * 3.6100017140965404149888229e-03 + \
                x5_2 * 8.6182131398631345309269136e-03 + \
                x5_2 * x7 * -3.3396902926336596850731553e-03 + \
                x5_2 * x6 * -5.8665837439185811175157426e-03 + \
                x5_3 * 3.2276240840009851051917167e-03 + \
                x4 * -6.9929674141597786274360260e-03 + \
                x4 * x7 * -4.2864924507659274421911277e-03 + \
                x4 * x7_2 * 3.0804981372765417868553328e-04 + \
                x4 * x6 * 3.5828888279390291859982653e-03 + \
                x4 * x6 * x7 * -1.5933011472345354198054679e-03 + \
                x4 * x6_2 * -4.0450370389296316786520435e-03 + \
                x4 * x5 * 5.0347233956665321530365986e-03 + \
                x4 * x5 * x7 * 4.9513083253765050040229312e-03 + \
                x4 * x5 * x6 * 4.1869029843446328720268923e-03 + \
                x4 * x5_2 * -2.1534831591752401358519364e-03 + \
                x4_2 * -1.5959967549068823644553561e-03 + \
                x4_2 * x7 * 3.7210946983384785013981855e-04 + \
                x4_2 * x6 * -7.3929073897058715167385223e-03 + \
                x4_2 * x5 * -1.1834932429205073656230951e-03 + \
                x4_3 * 6.0885887458004134265010521e-03 + \
                x3 * 3.3476339827152284955857908e-02 + \
                x3 * x7 * -3.3054119444976395869595365e-02 + \
                x3 * x7_2 * 1.3612712541952697031799602e-04 + \
                x3 * x6 * -1.2293380387977906331720135e-02 + \
                x3 * x6 * x7 * 1.8013557117831265064200608e-04 + \
                x3 * x6_2 * 6.5131404935349279314293902e-03 + \
                x3 * x5 * -7.2186560390722284696884969e-03 + \
                x3 * x5 * x7 * -4.5087239497537054400133627e-03 + \
                x3 * x5 * x6 * 2.3794772589930896292131912e-03 + \
                x3 * x5_2 * -1.2894791128918382978885138e-03 + \
                x3 * x4 * 1.4219742943918069200126553e-02 + \
                x3 * x4 * x7 * -5.7359839401791758856097303e-03 + \
                x3 * x4 * x6 * -2.0025744111616013143351012e-03 + \
                x3 * x4 * x5 * 2.1425664161359532153272589e-03 + \
                x3 * x4_2 * -3.1005172975798554052540013e-03 + \
                x3_2 * -3.2611788212242628914872000e-02 + \
                x3_2 * x7 * 1.1153000889247366433920661e-02 + \
                x3_2 * x6 * 7.0097492725289985149306204e-03 + \
                x3_2 * x5 * -3.1992142012910243509260511e-04 + \
                x3_2 * x4 * -3.6731104254683292348326873e-03 + \
                x3_3 * -6.1470650820310453188444200e-03 + \
                x2 * 9.0854528302698966957251514e-02 + \
                x2 * x7 * -1.7984030090013279623573084e-02 + \
                x2 * x7_2 * 6.0083854174480810783620655e-04 + \
                x2 * x6 * -2.2411964591569077942523336e-03 + \
                x2 * x6 * x7 * 1.0623713076422618140082221e-04 + \
                x2 * x6_2 * 8.2285678162091540829847780e-04 + \
                x2 * x5 * 1.2877258754671855323081786e-02 + \
                x2 * x5 * x7 * -6.9575513713065542664715224e-03 + \
                x2 * x5 * x6 * 2.8788920530840797495919503e-03 + \
                x2 * x5_2 * -7.7267426020071663245181171e-03 + \
                x2 * x4 * 9.4407528718518443633378467e-03 + \
                x2 * x4 * x7 * 2.8850362691676435800136602e-03 + \
                x2 * x4 * x6 * 4.7141023176060711796786507e-03 + \
                x2 * x4 * x5 * -6.8042861343772763349502242e-03 + \
                x2 * x4_2 * -1.3949155563833812512819499e-03 + \
                x2 * x3 * -6.7362854998917004456515656e-02 + \
                x2 * x3 * x7 * 1.2996598512161339211701261e-02 + \
                x2 * x3 * x6 * -3.3830664175137688948202808e-03 + \
                x2 * x3 * x5 * 7.9997389277102932958474213e-03 + \
                x2 * x3 * x4 * -4.8270474243278030379578070e-03 + \
                x2 * x3_2 * 2.9794390983674520767543470e-02 + \
                x2_2 * -4.2364600592773926646117388e-01 + \
                x2_2 * x7 * 7.4828212529446269662969371e-02 + \
                x2_2 * x6 * -3.6012369512715067254582380e-03 + \
                x2_2 * x5 * -1.3058388008751978942578731e-03 + \
                x2_2 * x4 * -2.7246547068716289036194311e-03 + \
                x2_2 * x3 * 1.5501275401369248724270378e-02 + \
                x2_3 * 1.0838920238082123959078018e-01 + \
                x1 * 2.3486184307754395805822867e-01 + \
                x1 * x7 * -1.6215743910934922455968632e-02 + \
                x1 * x7_2 * 6.3271241965450683575333812e-03 + \
                x1 * x6 * -6.0876800816982018504930352e-03 + \
                x1 * x6 * x7 * 2.4749060268414377339318833e-03 + \
                x1 * x6_2 * -3.4805070721524791754752925e-03 + \
                x1 * x5 * 1.9999469363353707118680092e-02 + \
                x1 * x5 * x7 * -5.4639206255332386369394371e-03 + \
                x1 * x5 * x6 * -9.4776664303735519423455003e-04 + \
                x1 * x5_2 * -6.5463075239975306029993618e-03 + \
                x1 * x4 * 7.9615588542411783179453266e-03 + \
                x1 * x4 * x7 * 4.6484599596048068251286089e-03 + \
                x1 * x4 * x6 * 6.4333622722491379253284549e-05 + \
                x1 * x4 * x5 * -8.1939381617644694438817865e-03 + \
                x1 * x4_2 * -4.3130324511595451164591708e-03 + \
                x1 * x3 * -3.9345855829463018127345464e-02 + \
                x1 * x3 * x7 * 1.3762440541601798915660737e-02 + \
                x1 * x3 * x6 * 2.3983820002184946112988584e-03 + \
                x1 * x3 * x5 * 6.8038109412884677229538255e-03 + \
                x1 * x3 * x4 * -2.5705750288136340608868835e-03 + \
                x1 * x3_2 * 1.2080357492248387785149788e-02 + \
                x1 * x2 * -5.0796376784250252267582937e-01 + \
                x1 * x2 * x7 * 8.7938667096092132391405016e-02 + \
                x1 * x2 * x6 * 3.4252601521724580779793001e-03 + \
                x1 * x2 * x5 * -5.6481466981650532699354983e-03 + \
                x1 * x2 * x4 * -3.4716943195710059377745438e-03 + \
                x1 * x2 * x3 * 2.1878255012100791820905954e-02 + \
                x1 * x2_2 * 2.2979989880500023557985401e-01 + \
                x1_2 * -9.8091247388557567532529902e-02 + \
                x1_2 * x7 * 2.0306269070223349759718445e-02 + \
                x1_2 * x6 * 3.2408094599242001643268907e-03 + \
                x1_2 * x5 * -5.3917174072532214612607504e-03 + \
                x1_2 * x4 * -1.2746603974704284745200766e-03 + \
                x1_2 * x3 * 1.9899791418347481664063992e-04 + \
                x1_2 * x2 * 9.6426249293202676016178998e-02 + \
                x1_3 * 2.9326505581274628364774060e-03 + \
                x0 * 5.1041043536582120232480975e-01 + \
                x0 * x7 * -3.0353551690314530681069627e-02 + \
                x0 * x7_2 * 5.3640066837552895229190852e-03 + \
                x0 * x6 * 7.8166425136871730411369796e-03 + \
                x0 * x6 * x7 * 2.5154081442356236719692930e-03 + \
                x0 * x6_2 * -8.2293442293696322104024077e-04 + \
                x0 * x5 * -1.2845202833999869174164132e-02 + \
                x0 * x5 * x7 * 1.7174246618347835391382716e-03 + \
                x0 * x5 * x6 * -7.8137810068103965427388502e-03 + \
                x0 * x5_2 * 2.1949202368174436372783020e-03 + \
                x0 * x4 * -1.1074313951899778310505873e-02 + \
                x0 * x4 * x7 * 7.9434359459493522614970118e-04 + \
                x0 * x4 * x6 * 9.0144738550899800033633369e-03 + \
                x0 * x4 * x5 * 1.5688547842772140872291686e-03 + \
                x0 * x4_2 * 2.3631685637743593542126064e-03 + \
                x0 * x3 * 2.5812690928021533864900050e-02 + \
                x0 * x3 * x7 * -3.5202094343503090301261693e-03 + \
                x0 * x3 * x6 * -1.1738940013982371909223579e-03 + \
                x0 * x3 * x5 * 3.6290583758275436754292542e-03 + \
                x0 * x3 * x4 * 2.2001022671984801423739064e-03 + \
                x0 * x3_2 * 8.3039786849435012761055930e-03 + \
                x0 * x2 * 8.1908088247299570133774793e-03 + \
                x0 * x2 * x7 * 7.0271271119053740558668686e-03 + \
                x0 * x2 * x6 * 2.8141791647905292986231451e-03 + \
                x0 * x2 * x5 * 5.2181187723359528929378826e-03 + \
                x0 * x2 * x4 * -1.5603909985825344108878454e-03 + \
                x0 * x2 * x3 * -3.0415234014951789132119586e-02 + \
                x0 * x2_2 * -1.7713861223789470478173769e-02 + \
                x0 * x1 * 9.1926910432800160860589145e-03 + \
                x0 * x1 * x7 * 2.7391437138744798018841209e-03 + \
                x0 * x1 * x6 * 2.4033235569002678322370059e-03 + \
                x0 * x1 * x5 * 1.8733908108783271090347355e-03 + \
                x0 * x1 * x4 * 6.7605733259521079425713452e-03 + \
                x0 * x1 * x3 * -1.1477431356264670286870810e-02 + \
                x0 * x1 * x2 * -2.1114051146526306712569721e-02 + \
                x0 * x1_2 * -6.0661809070921245135021849e-04 + \
                x0_2 * 6.7144301452254362416738331e-03 + \
                x0_2 * x7 * 1.0012434284629861958038077e-03 + \
                x0_2 * x6 * -1.1001722771625191063527005e-02 + \
                x0_2 * x5 * 6.5811220744244319086346806e-03 + \
                x0_2 * x4 * 4.6323670547813305953255281e-04 + \
                x0_2 * x3 * -5.2215060477289552270940831e-03 + \
                x0_2 * x2 * 3.7153659423633045646995221e-03 + \
                x0_2 * x1 * 7.9838609177365679053783865e-03 + \
                x0_3 * -6.2978766240263939213406275e-03
            output = output * 1.4753036857272818451747298e+03 + 6.5340787031462277809623629e+03
            cost = output
            full_x_list = [vFeedMFlow, vTAFeedFrac, vMAFeedFrac, v40_LIN, v52_WN, v47_ARC, vASC_RefluxRatio, vLOX_Frac]
            with open(os.path.dirname(__file__) + r"\krig_x_point", 'rb') as fp:
                data_x = pickle.load(fp)
            with open(os.path.dirname(__file__) + r"\krig_coeff\cost", 'rb') as fp:
                coeff = pickle.load(fp)
            bandwidth = np.array([4.0000000000000000000000000e+01, 1.0000000000000001942890293e-02,
                                  1.4999999999999997710165012e-02, 3.0000000000000000000000000e+01,
                                  3.0000000000000000000000000e+01, 1.0000000000000000000000000e+01,
                                  5.0000000000000000000000000e-01, 3.0000000000000000624500451e-03])

            output = 0
            for i in range(1982):
                temp = 0
                for j in range(8):
                    temp += ((full_x_list[j] - data_x[i, j]) / bandwidth[j]) ** 2
                temp *= -0.5
                output += exp(temp) * coeff[i]
            output += 0.0000000000000000000000000e+00
            cost += output
            return cost

        def OBJ(m):
            return cost_func(m.FeedMFlow, m.FeedSplitterOut1Ratio, m.FeedSplitterOut2Ratio, m.HPCCondPrdtMFlow,
                             m.LPCExt46MFlow, m.LPCExt15MFlow, m.ASCCondRefRatio, m.OxSplitterOutARatio)

        test_model.OBJ = Expression(rule=OBJ)

